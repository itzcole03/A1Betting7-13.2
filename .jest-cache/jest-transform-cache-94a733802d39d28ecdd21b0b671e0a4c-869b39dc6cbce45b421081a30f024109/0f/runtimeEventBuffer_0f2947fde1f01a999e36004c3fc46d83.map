{"version":3,"names":["EVENT_BUFFER","MAX_EVENTS","recordEvent","tag","payload","push","timestamp","Date","now","length","shift","getRecent","n","filter","event","slice","getAllRecent","clearEventBuffer"],"sources":["runtimeEventBuffer.ts"],"sourcesContent":["/**\r\n * Runtime Event Buffer - Stores diagnostic events for error correlation\r\n * \r\n * Simple ring buffer for tracking runtime events that can be retrieved\r\n * during error handling to provide context about what led to failures.\r\n * \r\n * @module debug/runtimeEventBuffer\r\n */\r\n\r\ninterface DiagnosticEvent {\r\n  tag: string;\r\n  payload: Record<string, unknown>;\r\n  timestamp: number;\r\n}\r\n\r\n// Ring buffer for events\r\nconst EVENT_BUFFER: DiagnosticEvent[] = [];\r\nconst MAX_EVENTS = 50;\r\n\r\n/**\r\n * Record a diagnostic event\r\n */\r\nexport function recordEvent(tag: string, payload: Record<string, unknown>): void {\r\n  EVENT_BUFFER.push({\r\n    tag,\r\n    payload,\r\n    timestamp: Date.now(),\r\n  });\r\n  \r\n  // Keep only the most recent events\r\n  if (EVENT_BUFFER.length > MAX_EVENTS) {\r\n    EVENT_BUFFER.shift();\r\n  }\r\n}\r\n\r\n/**\r\n * Get recent events by tag\r\n */\r\nexport function getRecent(tag: string, n = 5): DiagnosticEvent[] {\r\n  return EVENT_BUFFER\r\n    .filter(event => event.tag === tag)\r\n    .slice(-n);\r\n}\r\n\r\n/**\r\n * Get all recent events\r\n */\r\nexport function getAllRecent(n = 10): DiagnosticEvent[] {\r\n  return EVENT_BUFFER.slice(-n);\r\n}\r\n\r\n/**\r\n * Clear the event buffer (for testing)\r\n */\r\nexport function clearEventBuffer(): void {\r\n  EVENT_BUFFER.length = 0;\r\n}"],"mappings":";;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAQA;AACA,MAAMA,YAA+B,GAAG,EAAE;AAC1C,MAAMC,UAAU,GAAG,EAAE;;AAErB;AACA;AACA;AACO,SAASC,WAAWA,CAACC,GAAW,EAAEC,OAAgC,EAAQ;EAC/EJ,YAAY,CAACK,IAAI,CAAC;IAChBF,GAAG;IACHC,OAAO;IACPE,SAAS,EAAEC,IAAI,CAACC,GAAG,CAAC;EACtB,CAAC,CAAC;;EAEF;EACA,IAAIR,YAAY,CAACS,MAAM,GAAGR,UAAU,EAAE;IACpCD,YAAY,CAACU,KAAK,CAAC,CAAC;EACtB;AACF;;AAEA;AACA;AACA;AACO,SAASC,SAASA,CAACR,GAAW,EAAES,CAAC,GAAG,CAAC,EAAqB;EAC/D,OAAOZ,YAAY,CAChBa,MAAM,CAACC,KAAK,IAAIA,KAAK,CAACX,GAAG,KAAKA,GAAG,CAAC,CAClCY,KAAK,CAAC,CAACH,CAAC,CAAC;AACd;;AAEA;AACA;AACA;AACO,SAASI,YAAYA,CAACJ,CAAC,GAAG,EAAE,EAAqB;EACtD,OAAOZ,YAAY,CAACe,KAAK,CAAC,CAACH,CAAC,CAAC;AAC/B;;AAEA;AACA;AACA;AACO,SAASK,gBAAgBA,CAAA,EAAS;EACvCjB,YAAY,CAACS,MAAM,GAAG,CAAC;AACzB","ignoreList":[]}