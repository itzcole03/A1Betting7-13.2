1234d727e10a233577c3d5153691566f
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ensureModelMetricsShape = ensureModelMetricsShape;
/**
 * Model metrics normalization to prevent "Cannot read properties of undefined (reading 'optimization_level')" errors
 * Provides shape normalization and legacy field mapping for AI/ML model metrics
 * 
 * @module ensureModelMetricsShape
 */

// Guard to prevent multiple logging
let hasLoggedMissingFields = false;
/**
 * Legacy key mapping table for reference
 * 
 * optimizationLevel -> model.optimization_level
 * opt_level -> model.optimization_level  
 * optimization_mode -> model.optimization_mode
 * optimizationTier -> model.optimization_level
 * modelName -> model.name
 * model_name -> model.name
 * avg_latency -> performance.avg_latency_ms
 * latency_ms -> performance.avg_latency_ms
 * throughput -> performance.throughput_rps
 * throughput_per_second -> performance.throughput_rps
 * success_requests -> derived success_rate
 * total_inferences -> usage.total_requests
 */

/**
 * Safe stringify for logging
 */
const safeStringify = obj => {
  try {
    return JSON.stringify(obj, null, 2);
  } catch {
    return String(obj);
  }
};

/**
 * Safely coerce value to number with fallback
 */
const coerceToNumber = (value, fallback = 0) => {
  if (typeof value === 'number') {
    if (!isFinite(value)) {
      return fallback;
    }
    return value;
  }
  if (typeof value === 'boolean') {
    return value ? 1 : 0;
  }
  if (typeof value === 'string') {
    const parsed = parseFloat(value);
    if (!isNaN(parsed)) {
      return parsed;
    }
  }
  return fallback;
};

/**
 * Safely coerce value to string with fallback
 */
const coerceToString = (value, fallback = '') => {
  if (typeof value === 'string') {
    return value;
  }
  if (typeof value === 'number' || typeof value === 'boolean') {
    return String(value);
  }
  return fallback;
};

/**
 * Extract nested value using path segments
 */
const extractNestedValue = (obj, path) => {
  let current = obj;
  for (const segment of path) {
    if (current && typeof current === 'object' && segment in current) {
      current = current[segment];
    } else {
      return undefined;
    }
  }
  return current;
};

/**
 * Get value with legacy fallback mapping
 */
const getValueWithLegacyFallback = (rawObj, canonicalPath, legacyPaths, type, defaultValue) => {
  // Try canonical path first
  const canonicalValue = extractNestedValue(rawObj, canonicalPath);
  if (canonicalValue !== undefined) {
    const coerced = type === 'number' ? coerceToNumber(canonicalValue, defaultValue) : coerceToString(canonicalValue, defaultValue);
    return {
      value: coerced,
      usedLegacy: false
    };
  }

  // Try legacy paths
  for (const legacyPath of legacyPaths) {
    const legacyValue = extractNestedValue(rawObj, legacyPath);
    if (legacyValue !== undefined) {
      const coerced = type === 'number' ? coerceToNumber(legacyValue, defaultValue) : coerceToString(legacyValue, defaultValue);
      return {
        value: coerced,
        usedLegacy: true
      };
    }
  }
  return {
    value: defaultValue,
    usedLegacy: false
  };
};

/**
 * Derive total_tokens if missing
 */
const deriveTotalTokens = usage => {
  const inputTokens = coerceToNumber(usage.input_tokens || usage.inputTokens, 0);
  const outputTokens = coerceToNumber(usage.output_tokens || usage.outputTokens, 0);
  return inputTokens + outputTokens;
};

/**
 * Derive success_rate if missing but success/total available
 */
const deriveSuccessRate = rawObj => {
  const successRequests = coerceToNumber(rawObj.success_requests || rawObj.successful_requests, 0);
  const totalRequests = coerceToNumber(rawObj.total_requests || rawObj.total_inferences, 0);
  if (totalRequests > 0) {
    return successRequests / totalRequests;
  }
  return 0;
};

/**
 * Ensures model metrics data conforms to ModelMetricsShape with safe defaults
 * 
 * Features:
 * - Normalizes missing nested objects to safe defaults
 * - Maps legacy fields to canonical structure  
 * - Coerces numeric fields to numbers and strings to strings
 * - Derives computed fields (total_tokens, success_rate)
 * - Adds development metadata in originFlags
 * - One-time logging for missing fields and legacy usage
 */
function ensureModelMetricsShape(raw) {
  const originFlags = {};

  // Type guard for raw data
  const rawObj = raw && typeof raw === 'object' ? raw : {};
  let usedLegacyFields = false;

  // Build model section with legacy mapping
  const modelName = getValueWithLegacyFallback(rawObj, ['model', 'name'], [['modelName'], ['model_name'], ['name']], 'string', 'Unknown Model');
  if (modelName.usedLegacy) usedLegacyFields = true;
  const provider = getValueWithLegacyFallback(rawObj, ['model', 'provider'], [['provider'], ['model_provider'], ['modelProvider']], 'string', 'Unknown Provider');
  if (provider.usedLegacy) usedLegacyFields = true;
  const optimizationLevel = getValueWithLegacyFallback(rawObj, ['model', 'optimization_level'], [['optimizationLevel'], ['opt_level'], ['optimization_mode'], ['system_info', 'optimization_level'], ['optimizationTier'], ['optTier']], 'string', 'Basic');
  if (optimizationLevel.usedLegacy) usedLegacyFields = true;
  const version = getValueWithLegacyFallback(rawObj, ['model', 'version'], [['version'], ['model_version']], 'string', '');
  const optimizationMode = getValueWithLegacyFallback(rawObj, ['model', 'optimization_mode'], [['optimization_mode'], ['optimizationMode']], 'string', '');

  // Build performance section
  const throughputRps = getValueWithLegacyFallback(rawObj, ['performance', 'throughput_rps'], [['throughput'], ['throughput_per_second'], ['rps']], 'number', 0);
  if (throughputRps.usedLegacy) usedLegacyFields = true;
  const avgLatencyMs = getValueWithLegacyFallback(rawObj, ['performance', 'avg_latency_ms'], [['avg_latency'], ['latency_ms'], ['avg_latency_ms']], 'number', 0);
  if (avgLatencyMs.usedLegacy) usedLegacyFields = true;
  const p95LatencyMs = getValueWithLegacyFallback(rawObj, ['performance', 'p95_latency_ms'], [['p95_latency'], ['p95_latency_ms']], 'number', 0);
  if (p95LatencyMs.usedLegacy) usedLegacyFields = true;

  // Try to derive success_rate or use direct value
  let successRate;
  const directSuccessRate = extractNestedValue(rawObj, ['performance', 'success_rate']);
  if (directSuccessRate !== undefined) {
    successRate = coerceToNumber(directSuccessRate, 0);
  } else {
    successRate = deriveSuccessRate(rawObj);
    if (successRate > 0) usedLegacyFields = true;
  }

  // Build usage section
  const totalRequests = getValueWithLegacyFallback(rawObj, ['usage', 'total_requests'], [['total_requests'], ['total_inferences'], ['totalRequests']], 'number', 0);
  if (totalRequests.usedLegacy) usedLegacyFields = true;
  const inputTokens = getValueWithLegacyFallback(rawObj, ['usage', 'input_tokens'], [['input_tokens'], ['inputTokens']], 'number', 0);
  if (inputTokens.usedLegacy) usedLegacyFields = true;
  const outputTokens = getValueWithLegacyFallback(rawObj, ['usage', 'output_tokens'], [['output_tokens'], ['outputTokens']], 'number', 0);
  if (outputTokens.usedLegacy) usedLegacyFields = true;

  // Derive total_tokens
  let totalTokens = getValueWithLegacyFallback(rawObj, ['usage', 'total_tokens'], [['total_tokens'], ['totalTokens']], 'number', 0).value;
  if (totalTokens === 0 && (inputTokens.value > 0 || outputTokens.value > 0)) {
    totalTokens = deriveTotalTokens({
      input_tokens: inputTokens.value,
      output_tokens: outputTokens.value
    });
  }
  const cacheHits = getValueWithLegacyFallback(rawObj, ['usage', 'cache_hits'], [['cache_hits'], ['cacheHits']], 'number', 0);
  const cacheHitRate = getValueWithLegacyFallback(rawObj, ['usage', 'cache_hit_rate'], [['cache_hit_rate'], ['cacheHitRate']], 'number', 0);

  // Build optional tuning section
  let tuning;
  const temperature = extractNestedValue(rawObj, ['tuning', 'temperature']) || rawObj.temperature;
  if (temperature !== undefined || rawObj.top_p !== undefined || rawObj.max_tokens !== undefined) {
    tuning = {
      temperature: coerceToNumber(temperature, 0.7),
      top_p: rawObj.top_p !== undefined ? coerceToNumber(rawObj.top_p, undefined) : undefined,
      max_tokens: rawObj.max_tokens !== undefined ? coerceToNumber(rawObj.max_tokens, undefined) : undefined,
      presence_penalty: rawObj.presence_penalty !== undefined ? coerceToNumber(rawObj.presence_penalty, undefined) : undefined,
      frequency_penalty: rawObj.frequency_penalty !== undefined ? coerceToNumber(rawObj.frequency_penalty, undefined) : undefined
    };
  }

  // Set origin flags
  if (usedLegacyFields) {
    originFlags.mappedLegacy = true;
  }
  const hasModelSection = rawObj.model && typeof rawObj.model === 'object';
  const hasPerformanceSection = rawObj.performance && typeof rawObj.performance === 'object';
  const hasUsageSection = rawObj.usage && typeof rawObj.usage === 'object';
  if (!hasModelSection || !hasPerformanceSection || !hasUsageSection) {
    originFlags.partialPayload = true;
  }

  // One-time development logging
  const missingFields = [];
  if (!raw) missingFields.push('entire model metrics object');
  if (!hasModelSection) missingFields.push('model section');
  if (!hasPerformanceSection) missingFields.push('performance section');
  if (!hasUsageSection) missingFields.push('usage section');
  if ((process.env.NODE_ENV === 'development' || process.env.NODE_ENV === 'test' || typeof jest !== 'undefined') && (missingFields.length > 0 || originFlags.mappedLegacy) && !hasLoggedMissingFields) {
    hasLoggedMissingFields = true;
    if (missingFields.length > 0) {
      // eslint-disable-next-line no-console
      console.warn('[ModelMetricsGuard] Missing model metrics fields detected:', missingFields.join(', '), '\nRaw data sample:', safeStringify(rawObj)?.substring(0, 500) + '...');
    }
    if (originFlags.mappedLegacy) {
      // eslint-disable-next-line no-console
      console.warn('[ModelMetricsGuard] Using legacy model metrics fields:', 'optimizationLevel, opt_level, model_name, throughput_per_second, etc.', 'Consider migrating to canonical structure');
    }
  }

  // Build normalized model metrics object
  const normalized = {
    model: {
      name: modelName.value,
      provider: provider.value,
      optimization_level: optimizationLevel.value,
      ...(version.value && version.value !== '' ? {
        version: version.value
      } : {}),
      ...(optimizationMode.value && optimizationMode.value !== '' ? {
        optimization_mode: optimizationMode.value
      } : {})
    },
    performance: {
      throughput_rps: throughputRps.value,
      avg_latency_ms: avgLatencyMs.value,
      p95_latency_ms: p95LatencyMs.value,
      success_rate: successRate
    },
    usage: {
      total_requests: totalRequests.value,
      input_tokens: inputTokens.value,
      output_tokens: outputTokens.value,
      total_tokens: totalTokens,
      ...(cacheHits.value > 0 ? {
        cache_hits: cacheHits.value
      } : {}),
      ...(cacheHitRate.value > 0 ? {
        cache_hit_rate: cacheHitRate.value
      } : {})
    },
    ...(tuning ? {
      tuning
    } : {}),
    originFlags
  };
  return normalized;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJoYXNMb2dnZWRNaXNzaW5nRmllbGRzIiwic2FmZVN0cmluZ2lmeSIsIm9iaiIsIkpTT04iLCJzdHJpbmdpZnkiLCJTdHJpbmciLCJjb2VyY2VUb051bWJlciIsInZhbHVlIiwiZmFsbGJhY2siLCJpc0Zpbml0ZSIsInBhcnNlZCIsInBhcnNlRmxvYXQiLCJpc05hTiIsImNvZXJjZVRvU3RyaW5nIiwiZXh0cmFjdE5lc3RlZFZhbHVlIiwicGF0aCIsImN1cnJlbnQiLCJzZWdtZW50IiwidW5kZWZpbmVkIiwiZ2V0VmFsdWVXaXRoTGVnYWN5RmFsbGJhY2siLCJyYXdPYmoiLCJjYW5vbmljYWxQYXRoIiwibGVnYWN5UGF0aHMiLCJ0eXBlIiwiZGVmYXVsdFZhbHVlIiwiY2Fub25pY2FsVmFsdWUiLCJjb2VyY2VkIiwidXNlZExlZ2FjeSIsImxlZ2FjeVBhdGgiLCJsZWdhY3lWYWx1ZSIsImRlcml2ZVRvdGFsVG9rZW5zIiwidXNhZ2UiLCJpbnB1dFRva2VucyIsImlucHV0X3Rva2VucyIsIm91dHB1dFRva2VucyIsIm91dHB1dF90b2tlbnMiLCJkZXJpdmVTdWNjZXNzUmF0ZSIsInN1Y2Nlc3NSZXF1ZXN0cyIsInN1Y2Nlc3NfcmVxdWVzdHMiLCJzdWNjZXNzZnVsX3JlcXVlc3RzIiwidG90YWxSZXF1ZXN0cyIsInRvdGFsX3JlcXVlc3RzIiwidG90YWxfaW5mZXJlbmNlcyIsImVuc3VyZU1vZGVsTWV0cmljc1NoYXBlIiwicmF3Iiwib3JpZ2luRmxhZ3MiLCJ1c2VkTGVnYWN5RmllbGRzIiwibW9kZWxOYW1lIiwicHJvdmlkZXIiLCJvcHRpbWl6YXRpb25MZXZlbCIsInZlcnNpb24iLCJvcHRpbWl6YXRpb25Nb2RlIiwidGhyb3VnaHB1dFJwcyIsImF2Z0xhdGVuY3lNcyIsInA5NUxhdGVuY3lNcyIsInN1Y2Nlc3NSYXRlIiwiZGlyZWN0U3VjY2Vzc1JhdGUiLCJ0b3RhbFRva2VucyIsImNhY2hlSGl0cyIsImNhY2hlSGl0UmF0ZSIsInR1bmluZyIsInRlbXBlcmF0dXJlIiwidG9wX3AiLCJtYXhfdG9rZW5zIiwicHJlc2VuY2VfcGVuYWx0eSIsImZyZXF1ZW5jeV9wZW5hbHR5IiwibWFwcGVkTGVnYWN5IiwiaGFzTW9kZWxTZWN0aW9uIiwibW9kZWwiLCJoYXNQZXJmb3JtYW5jZVNlY3Rpb24iLCJwZXJmb3JtYW5jZSIsImhhc1VzYWdlU2VjdGlvbiIsInBhcnRpYWxQYXlsb2FkIiwibWlzc2luZ0ZpZWxkcyIsInB1c2giLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJqZXN0IiwibGVuZ3RoIiwiY29uc29sZSIsIndhcm4iLCJqb2luIiwic3Vic3RyaW5nIiwibm9ybWFsaXplZCIsIm5hbWUiLCJvcHRpbWl6YXRpb25fbGV2ZWwiLCJvcHRpbWl6YXRpb25fbW9kZSIsInRocm91Z2hwdXRfcnBzIiwiYXZnX2xhdGVuY3lfbXMiLCJwOTVfbGF0ZW5jeV9tcyIsInN1Y2Nlc3NfcmF0ZSIsInRvdGFsX3Rva2VucyIsImNhY2hlX2hpdHMiLCJjYWNoZV9oaXRfcmF0ZSJdLCJzb3VyY2VzIjpbImVuc3VyZU1vZGVsTWV0cmljc1NoYXBlLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBNb2RlbCBtZXRyaWNzIG5vcm1hbGl6YXRpb24gdG8gcHJldmVudCBcIkNhbm5vdCByZWFkIHByb3BlcnRpZXMgb2YgdW5kZWZpbmVkIChyZWFkaW5nICdvcHRpbWl6YXRpb25fbGV2ZWwnKVwiIGVycm9yc1xyXG4gKiBQcm92aWRlcyBzaGFwZSBub3JtYWxpemF0aW9uIGFuZCBsZWdhY3kgZmllbGQgbWFwcGluZyBmb3IgQUkvTUwgbW9kZWwgbWV0cmljc1xyXG4gKiBcclxuICogQG1vZHVsZSBlbnN1cmVNb2RlbE1ldHJpY3NTaGFwZVxyXG4gKi9cclxuXHJcbi8vIEd1YXJkIHRvIHByZXZlbnQgbXVsdGlwbGUgbG9nZ2luZ1xyXG5sZXQgaGFzTG9nZ2VkTWlzc2luZ0ZpZWxkcyA9IGZhbHNlO1xyXG5cclxuZXhwb3J0IGludGVyZmFjZSBNb2RlbE1ldHJpY3NTaGFwZSB7XHJcbiAgbW9kZWw6IHtcclxuICAgIG5hbWU6IHN0cmluZztcclxuICAgIHByb3ZpZGVyOiBzdHJpbmc7XHJcbiAgICB2ZXJzaW9uPzogc3RyaW5nO1xyXG4gICAgb3B0aW1pemF0aW9uX2xldmVsOiBzdHJpbmc7XHJcbiAgICBvcHRpbWl6YXRpb25fbW9kZT86IHN0cmluZztcclxuICB9O1xyXG4gIHBlcmZvcm1hbmNlOiB7XHJcbiAgICB0aHJvdWdocHV0X3JwczogbnVtYmVyO1xyXG4gICAgYXZnX2xhdGVuY3lfbXM6IG51bWJlcjtcclxuICAgIHA5NV9sYXRlbmN5X21zOiBudW1iZXI7XHJcbiAgICBzdWNjZXNzX3JhdGU6IG51bWJlcjtcclxuICB9O1xyXG4gIHVzYWdlOiB7XHJcbiAgICB0b3RhbF9yZXF1ZXN0czogbnVtYmVyO1xyXG4gICAgaW5wdXRfdG9rZW5zOiBudW1iZXI7XHJcbiAgICBvdXRwdXRfdG9rZW5zOiBudW1iZXI7XHJcbiAgICB0b3RhbF90b2tlbnM6IG51bWJlcjtcclxuICAgIGNhY2hlX2hpdHM/OiBudW1iZXI7XHJcbiAgICBjYWNoZV9oaXRfcmF0ZT86IG51bWJlcjtcclxuICB9O1xyXG4gIHR1bmluZz86IHtcclxuICAgIHRlbXBlcmF0dXJlOiBudW1iZXI7XHJcbiAgICB0b3BfcD86IG51bWJlcjtcclxuICAgIG1heF90b2tlbnM/OiBudW1iZXI7XHJcbiAgICBwcmVzZW5jZV9wZW5hbHR5PzogbnVtYmVyO1xyXG4gICAgZnJlcXVlbmN5X3BlbmFsdHk/OiBudW1iZXI7XHJcbiAgfTtcclxuICBvcmlnaW5GbGFncz86IHtcclxuICAgIG1hcHBlZExlZ2FjeT86IGJvb2xlYW47XHJcbiAgICBwYXJ0aWFsUGF5bG9hZD86IGJvb2xlYW47XHJcbiAgfTtcclxufVxyXG5cclxuLyoqXHJcbiAqIExlZ2FjeSBrZXkgbWFwcGluZyB0YWJsZSBmb3IgcmVmZXJlbmNlXHJcbiAqIFxyXG4gKiBvcHRpbWl6YXRpb25MZXZlbCAtPiBtb2RlbC5vcHRpbWl6YXRpb25fbGV2ZWxcclxuICogb3B0X2xldmVsIC0+IG1vZGVsLm9wdGltaXphdGlvbl9sZXZlbCAgXHJcbiAqIG9wdGltaXphdGlvbl9tb2RlIC0+IG1vZGVsLm9wdGltaXphdGlvbl9tb2RlXHJcbiAqIG9wdGltaXphdGlvblRpZXIgLT4gbW9kZWwub3B0aW1pemF0aW9uX2xldmVsXHJcbiAqIG1vZGVsTmFtZSAtPiBtb2RlbC5uYW1lXHJcbiAqIG1vZGVsX25hbWUgLT4gbW9kZWwubmFtZVxyXG4gKiBhdmdfbGF0ZW5jeSAtPiBwZXJmb3JtYW5jZS5hdmdfbGF0ZW5jeV9tc1xyXG4gKiBsYXRlbmN5X21zIC0+IHBlcmZvcm1hbmNlLmF2Z19sYXRlbmN5X21zXHJcbiAqIHRocm91Z2hwdXQgLT4gcGVyZm9ybWFuY2UudGhyb3VnaHB1dF9ycHNcclxuICogdGhyb3VnaHB1dF9wZXJfc2Vjb25kIC0+IHBlcmZvcm1hbmNlLnRocm91Z2hwdXRfcnBzXHJcbiAqIHN1Y2Nlc3NfcmVxdWVzdHMgLT4gZGVyaXZlZCBzdWNjZXNzX3JhdGVcclxuICogdG90YWxfaW5mZXJlbmNlcyAtPiB1c2FnZS50b3RhbF9yZXF1ZXN0c1xyXG4gKi9cclxuXHJcbi8qKlxyXG4gKiBTYWZlIHN0cmluZ2lmeSBmb3IgbG9nZ2luZ1xyXG4gKi9cclxuY29uc3Qgc2FmZVN0cmluZ2lmeSA9IChvYmo6IHVua25vd24pOiBzdHJpbmcgPT4ge1xyXG4gIHRyeSB7XHJcbiAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkob2JqLCBudWxsLCAyKTtcclxuICB9IGNhdGNoIHtcclxuICAgIHJldHVybiBTdHJpbmcob2JqKTtcclxuICB9XHJcbn07XHJcblxyXG4vKipcclxuICogU2FmZWx5IGNvZXJjZSB2YWx1ZSB0byBudW1iZXIgd2l0aCBmYWxsYmFja1xyXG4gKi9cclxuY29uc3QgY29lcmNlVG9OdW1iZXIgPSAodmFsdWU6IHVua25vd24sIGZhbGxiYWNrOiBudW1iZXIgPSAwKTogbnVtYmVyID0+IHtcclxuICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJykge1xyXG4gICAgaWYgKCFpc0Zpbml0ZSh2YWx1ZSkpIHtcclxuICAgICAgcmV0dXJuIGZhbGxiYWNrO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHZhbHVlO1xyXG4gIH1cclxuICBpZiAodHlwZW9mIHZhbHVlID09PSAnYm9vbGVhbicpIHtcclxuICAgIHJldHVybiB2YWx1ZSA/IDEgOiAwO1xyXG4gIH1cclxuICBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xyXG4gICAgY29uc3QgcGFyc2VkID0gcGFyc2VGbG9hdCh2YWx1ZSk7XHJcbiAgICBpZiAoIWlzTmFOKHBhcnNlZCkpIHtcclxuICAgICAgcmV0dXJuIHBhcnNlZDtcclxuICAgIH1cclxuICB9XHJcbiAgcmV0dXJuIGZhbGxiYWNrO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIFNhZmVseSBjb2VyY2UgdmFsdWUgdG8gc3RyaW5nIHdpdGggZmFsbGJhY2tcclxuICovXHJcbmNvbnN0IGNvZXJjZVRvU3RyaW5nID0gKHZhbHVlOiB1bmtub3duLCBmYWxsYmFjazogc3RyaW5nID0gJycpOiBzdHJpbmcgPT4ge1xyXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnKSB7XHJcbiAgICByZXR1cm4gdmFsdWU7XHJcbiAgfVxyXG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInIHx8IHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XHJcbiAgICByZXR1cm4gU3RyaW5nKHZhbHVlKTtcclxuICB9XHJcbiAgcmV0dXJuIGZhbGxiYWNrO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3QgbmVzdGVkIHZhbHVlIHVzaW5nIHBhdGggc2VnbWVudHNcclxuICovXHJcbmNvbnN0IGV4dHJhY3ROZXN0ZWRWYWx1ZSA9IChvYmo6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LCBwYXRoOiBzdHJpbmdbXSk6IHVua25vd24gPT4ge1xyXG4gIGxldCBjdXJyZW50OiB1bmtub3duID0gb2JqO1xyXG4gIGZvciAoY29uc3Qgc2VnbWVudCBvZiBwYXRoKSB7XHJcbiAgICBpZiAoY3VycmVudCAmJiB0eXBlb2YgY3VycmVudCA9PT0gJ29iamVjdCcgJiYgc2VnbWVudCBpbiBjdXJyZW50KSB7XHJcbiAgICAgIGN1cnJlbnQgPSAoY3VycmVudCBhcyBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPilbc2VnbWVudF07XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xyXG4gICAgfVxyXG4gIH1cclxuICByZXR1cm4gY3VycmVudDtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBHZXQgdmFsdWUgd2l0aCBsZWdhY3kgZmFsbGJhY2sgbWFwcGluZ1xyXG4gKi9cclxuY29uc3QgZ2V0VmFsdWVXaXRoTGVnYWN5RmFsbGJhY2sgPSAoXHJcbiAgcmF3T2JqOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiwgXHJcbiAgY2Fub25pY2FsUGF0aDogc3RyaW5nW10sIFxyXG4gIGxlZ2FjeVBhdGhzOiBzdHJpbmdbXVtdLCBcclxuICB0eXBlOiAnbnVtYmVyJyB8ICdzdHJpbmcnLFxyXG4gIGRlZmF1bHRWYWx1ZTogc3RyaW5nIHwgbnVtYmVyXHJcbik6IHsgdmFsdWU6IHN0cmluZyB8IG51bWJlcjsgdXNlZExlZ2FjeTogYm9vbGVhbiB9ID0+IHtcclxuICBcclxuICAvLyBUcnkgY2Fub25pY2FsIHBhdGggZmlyc3RcclxuICBjb25zdCBjYW5vbmljYWxWYWx1ZSA9IGV4dHJhY3ROZXN0ZWRWYWx1ZShyYXdPYmosIGNhbm9uaWNhbFBhdGgpO1xyXG4gIGlmIChjYW5vbmljYWxWYWx1ZSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICBjb25zdCBjb2VyY2VkID0gdHlwZSA9PT0gJ251bWJlcicgXHJcbiAgICAgID8gY29lcmNlVG9OdW1iZXIoY2Fub25pY2FsVmFsdWUsIGRlZmF1bHRWYWx1ZSBhcyBudW1iZXIpXHJcbiAgICAgIDogY29lcmNlVG9TdHJpbmcoY2Fub25pY2FsVmFsdWUsIGRlZmF1bHRWYWx1ZSBhcyBzdHJpbmcpO1xyXG4gICAgcmV0dXJuIHsgdmFsdWU6IGNvZXJjZWQsIHVzZWRMZWdhY3k6IGZhbHNlIH07XHJcbiAgfVxyXG4gIFxyXG4gIC8vIFRyeSBsZWdhY3kgcGF0aHNcclxuICBmb3IgKGNvbnN0IGxlZ2FjeVBhdGggb2YgbGVnYWN5UGF0aHMpIHtcclxuICAgIGNvbnN0IGxlZ2FjeVZhbHVlID0gZXh0cmFjdE5lc3RlZFZhbHVlKHJhd09iaiwgbGVnYWN5UGF0aCk7XHJcbiAgICBpZiAobGVnYWN5VmFsdWUgIT09IHVuZGVmaW5lZCkge1xyXG4gICAgICBjb25zdCBjb2VyY2VkID0gdHlwZSA9PT0gJ251bWJlcicgXHJcbiAgICAgICAgPyBjb2VyY2VUb051bWJlcihsZWdhY3lWYWx1ZSwgZGVmYXVsdFZhbHVlIGFzIG51bWJlcilcclxuICAgICAgICA6IGNvZXJjZVRvU3RyaW5nKGxlZ2FjeVZhbHVlLCBkZWZhdWx0VmFsdWUgYXMgc3RyaW5nKTtcclxuICAgICAgcmV0dXJuIHsgdmFsdWU6IGNvZXJjZWQsIHVzZWRMZWdhY3k6IHRydWUgfTtcclxuICAgIH1cclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIHsgdmFsdWU6IGRlZmF1bHRWYWx1ZSwgdXNlZExlZ2FjeTogZmFsc2UgfTtcclxufTtcclxuXHJcbi8qKlxyXG4gKiBEZXJpdmUgdG90YWxfdG9rZW5zIGlmIG1pc3NpbmdcclxuICovXHJcbmNvbnN0IGRlcml2ZVRvdGFsVG9rZW5zID0gKHVzYWdlOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IG51bWJlciA9PiB7XHJcbiAgY29uc3QgaW5wdXRUb2tlbnMgPSBjb2VyY2VUb051bWJlcih1c2FnZS5pbnB1dF90b2tlbnMgfHwgdXNhZ2UuaW5wdXRUb2tlbnMsIDApO1xyXG4gIGNvbnN0IG91dHB1dFRva2VucyA9IGNvZXJjZVRvTnVtYmVyKHVzYWdlLm91dHB1dF90b2tlbnMgfHwgdXNhZ2Uub3V0cHV0VG9rZW5zLCAwKTtcclxuICByZXR1cm4gaW5wdXRUb2tlbnMgKyBvdXRwdXRUb2tlbnM7XHJcbn07XHJcblxyXG4vKipcclxuICogRGVyaXZlIHN1Y2Nlc3NfcmF0ZSBpZiBtaXNzaW5nIGJ1dCBzdWNjZXNzL3RvdGFsIGF2YWlsYWJsZVxyXG4gKi9cclxuY29uc3QgZGVyaXZlU3VjY2Vzc1JhdGUgPSAocmF3T2JqOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPik6IG51bWJlciA9PiB7XHJcbiAgY29uc3Qgc3VjY2Vzc1JlcXVlc3RzID0gY29lcmNlVG9OdW1iZXIocmF3T2JqLnN1Y2Nlc3NfcmVxdWVzdHMgfHwgcmF3T2JqLnN1Y2Nlc3NmdWxfcmVxdWVzdHMsIDApO1xyXG4gIGNvbnN0IHRvdGFsUmVxdWVzdHMgPSBjb2VyY2VUb051bWJlcihyYXdPYmoudG90YWxfcmVxdWVzdHMgfHwgcmF3T2JqLnRvdGFsX2luZmVyZW5jZXMsIDApO1xyXG4gIFxyXG4gIGlmICh0b3RhbFJlcXVlc3RzID4gMCkge1xyXG4gICAgcmV0dXJuIHN1Y2Nlc3NSZXF1ZXN0cyAvIHRvdGFsUmVxdWVzdHM7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiAwO1xyXG59O1xyXG5cclxuLyoqXHJcbiAqIEVuc3VyZXMgbW9kZWwgbWV0cmljcyBkYXRhIGNvbmZvcm1zIHRvIE1vZGVsTWV0cmljc1NoYXBlIHdpdGggc2FmZSBkZWZhdWx0c1xyXG4gKiBcclxuICogRmVhdHVyZXM6XHJcbiAqIC0gTm9ybWFsaXplcyBtaXNzaW5nIG5lc3RlZCBvYmplY3RzIHRvIHNhZmUgZGVmYXVsdHNcclxuICogLSBNYXBzIGxlZ2FjeSBmaWVsZHMgdG8gY2Fub25pY2FsIHN0cnVjdHVyZSAgXHJcbiAqIC0gQ29lcmNlcyBudW1lcmljIGZpZWxkcyB0byBudW1iZXJzIGFuZCBzdHJpbmdzIHRvIHN0cmluZ3NcclxuICogLSBEZXJpdmVzIGNvbXB1dGVkIGZpZWxkcyAodG90YWxfdG9rZW5zLCBzdWNjZXNzX3JhdGUpXHJcbiAqIC0gQWRkcyBkZXZlbG9wbWVudCBtZXRhZGF0YSBpbiBvcmlnaW5GbGFnc1xyXG4gKiAtIE9uZS10aW1lIGxvZ2dpbmcgZm9yIG1pc3NpbmcgZmllbGRzIGFuZCBsZWdhY3kgdXNhZ2VcclxuICovXHJcbmV4cG9ydCBmdW5jdGlvbiBlbnN1cmVNb2RlbE1ldHJpY3NTaGFwZShyYXc6IHVua25vd24pOiBNb2RlbE1ldHJpY3NTaGFwZSB7XHJcbiAgY29uc3Qgb3JpZ2luRmxhZ3M6IE1vZGVsTWV0cmljc1NoYXBlWydvcmlnaW5GbGFncyddID0ge307XHJcbiAgXHJcbiAgLy8gVHlwZSBndWFyZCBmb3IgcmF3IGRhdGFcclxuICBjb25zdCByYXdPYmogPSByYXcgJiYgdHlwZW9mIHJhdyA9PT0gJ29iamVjdCcgPyByYXcgYXMgUmVjb3JkPHN0cmluZywgdW5rbm93bj4gOiB7fTtcclxuXHJcbiAgbGV0IHVzZWRMZWdhY3lGaWVsZHMgPSBmYWxzZTtcclxuXHJcbiAgLy8gQnVpbGQgbW9kZWwgc2VjdGlvbiB3aXRoIGxlZ2FjeSBtYXBwaW5nXHJcbiAgY29uc3QgbW9kZWxOYW1lID0gZ2V0VmFsdWVXaXRoTGVnYWN5RmFsbGJhY2soXHJcbiAgICByYXdPYmosIFxyXG4gICAgWydtb2RlbCcsICduYW1lJ10sIFxyXG4gICAgW1snbW9kZWxOYW1lJ10sIFsnbW9kZWxfbmFtZSddLCBbJ25hbWUnXV0sIFxyXG4gICAgJ3N0cmluZycsIFxyXG4gICAgJ1Vua25vd24gTW9kZWwnXHJcbiAgKTtcclxuICBpZiAobW9kZWxOYW1lLnVzZWRMZWdhY3kpIHVzZWRMZWdhY3lGaWVsZHMgPSB0cnVlO1xyXG5cclxuICBjb25zdCBwcm92aWRlciA9IGdldFZhbHVlV2l0aExlZ2FjeUZhbGxiYWNrKFxyXG4gICAgcmF3T2JqLCBcclxuICAgIFsnbW9kZWwnLCAncHJvdmlkZXInXSwgXHJcbiAgICBbWydwcm92aWRlciddLCBbJ21vZGVsX3Byb3ZpZGVyJ10sIFsnbW9kZWxQcm92aWRlciddXSwgXHJcbiAgICAnc3RyaW5nJywgXHJcbiAgICAnVW5rbm93biBQcm92aWRlcidcclxuICApO1xyXG4gIGlmIChwcm92aWRlci51c2VkTGVnYWN5KSB1c2VkTGVnYWN5RmllbGRzID0gdHJ1ZTtcclxuXHJcbiAgY29uc3Qgb3B0aW1pemF0aW9uTGV2ZWwgPSBnZXRWYWx1ZVdpdGhMZWdhY3lGYWxsYmFjayhcclxuICAgIHJhd09iaiwgXHJcbiAgICBbJ21vZGVsJywgJ29wdGltaXphdGlvbl9sZXZlbCddLCBcclxuICAgIFtcclxuICAgICAgWydvcHRpbWl6YXRpb25MZXZlbCddLCBcclxuICAgICAgWydvcHRfbGV2ZWwnXSwgXHJcbiAgICAgIFsnb3B0aW1pemF0aW9uX21vZGUnXSxcclxuICAgICAgWydzeXN0ZW1faW5mbycsICdvcHRpbWl6YXRpb25fbGV2ZWwnXSxcclxuICAgICAgWydvcHRpbWl6YXRpb25UaWVyJ10sXHJcbiAgICAgIFsnb3B0VGllciddXHJcbiAgICBdLCBcclxuICAgICdzdHJpbmcnLCBcclxuICAgICdCYXNpYydcclxuICApO1xyXG4gIGlmIChvcHRpbWl6YXRpb25MZXZlbC51c2VkTGVnYWN5KSB1c2VkTGVnYWN5RmllbGRzID0gdHJ1ZTtcclxuXHJcbiAgY29uc3QgdmVyc2lvbiA9IGdldFZhbHVlV2l0aExlZ2FjeUZhbGxiYWNrKFxyXG4gICAgcmF3T2JqLCBcclxuICAgIFsnbW9kZWwnLCAndmVyc2lvbiddLCBcclxuICAgIFtbJ3ZlcnNpb24nXSwgWydtb2RlbF92ZXJzaW9uJ11dLCBcclxuICAgICdzdHJpbmcnLCBcclxuICAgICcnXHJcbiAgKTtcclxuXHJcbiAgY29uc3Qgb3B0aW1pemF0aW9uTW9kZSA9IGdldFZhbHVlV2l0aExlZ2FjeUZhbGxiYWNrKFxyXG4gICAgcmF3T2JqLCBcclxuICAgIFsnbW9kZWwnLCAnb3B0aW1pemF0aW9uX21vZGUnXSwgXHJcbiAgICBbWydvcHRpbWl6YXRpb25fbW9kZSddLCBbJ29wdGltaXphdGlvbk1vZGUnXV0sIFxyXG4gICAgJ3N0cmluZycsIFxyXG4gICAgJydcclxuICApO1xyXG5cclxuICAvLyBCdWlsZCBwZXJmb3JtYW5jZSBzZWN0aW9uXHJcbiAgY29uc3QgdGhyb3VnaHB1dFJwcyA9IGdldFZhbHVlV2l0aExlZ2FjeUZhbGxiYWNrKFxyXG4gICAgcmF3T2JqLCBcclxuICAgIFsncGVyZm9ybWFuY2UnLCAndGhyb3VnaHB1dF9ycHMnXSwgXHJcbiAgICBbWyd0aHJvdWdocHV0J10sIFsndGhyb3VnaHB1dF9wZXJfc2Vjb25kJ10sIFsncnBzJ11dLCBcclxuICAgICdudW1iZXInLCBcclxuICAgIDBcclxuICApO1xyXG4gIGlmICh0aHJvdWdocHV0UnBzLnVzZWRMZWdhY3kpIHVzZWRMZWdhY3lGaWVsZHMgPSB0cnVlO1xyXG5cclxuICBjb25zdCBhdmdMYXRlbmN5TXMgPSBnZXRWYWx1ZVdpdGhMZWdhY3lGYWxsYmFjayhcclxuICAgIHJhd09iaiwgXHJcbiAgICBbJ3BlcmZvcm1hbmNlJywgJ2F2Z19sYXRlbmN5X21zJ10sIFxyXG4gICAgW1snYXZnX2xhdGVuY3knXSwgWydsYXRlbmN5X21zJ10sIFsnYXZnX2xhdGVuY3lfbXMnXV0sIFxyXG4gICAgJ251bWJlcicsIFxyXG4gICAgMFxyXG4gICk7XHJcbiAgaWYgKGF2Z0xhdGVuY3lNcy51c2VkTGVnYWN5KSB1c2VkTGVnYWN5RmllbGRzID0gdHJ1ZTtcclxuXHJcbiAgY29uc3QgcDk1TGF0ZW5jeU1zID0gZ2V0VmFsdWVXaXRoTGVnYWN5RmFsbGJhY2soXHJcbiAgICByYXdPYmosIFxyXG4gICAgWydwZXJmb3JtYW5jZScsICdwOTVfbGF0ZW5jeV9tcyddLCBcclxuICAgIFtbJ3A5NV9sYXRlbmN5J10sIFsncDk1X2xhdGVuY3lfbXMnXV0sIFxyXG4gICAgJ251bWJlcicsIFxyXG4gICAgMFxyXG4gICk7XHJcbiAgaWYgKHA5NUxhdGVuY3lNcy51c2VkTGVnYWN5KSB1c2VkTGVnYWN5RmllbGRzID0gdHJ1ZTtcclxuXHJcbiAgLy8gVHJ5IHRvIGRlcml2ZSBzdWNjZXNzX3JhdGUgb3IgdXNlIGRpcmVjdCB2YWx1ZVxyXG4gIGxldCBzdWNjZXNzUmF0ZTogbnVtYmVyO1xyXG4gIGNvbnN0IGRpcmVjdFN1Y2Nlc3NSYXRlID0gZXh0cmFjdE5lc3RlZFZhbHVlKHJhd09iaiwgWydwZXJmb3JtYW5jZScsICdzdWNjZXNzX3JhdGUnXSk7XHJcbiAgaWYgKGRpcmVjdFN1Y2Nlc3NSYXRlICE9PSB1bmRlZmluZWQpIHtcclxuICAgIHN1Y2Nlc3NSYXRlID0gY29lcmNlVG9OdW1iZXIoZGlyZWN0U3VjY2Vzc1JhdGUsIDApO1xyXG4gIH0gZWxzZSB7XHJcbiAgICBzdWNjZXNzUmF0ZSA9IGRlcml2ZVN1Y2Nlc3NSYXRlKHJhd09iaik7XHJcbiAgICBpZiAoc3VjY2Vzc1JhdGUgPiAwKSB1c2VkTGVnYWN5RmllbGRzID0gdHJ1ZTtcclxuICB9XHJcblxyXG4gIC8vIEJ1aWxkIHVzYWdlIHNlY3Rpb25cclxuICBjb25zdCB0b3RhbFJlcXVlc3RzID0gZ2V0VmFsdWVXaXRoTGVnYWN5RmFsbGJhY2soXHJcbiAgICByYXdPYmosIFxyXG4gICAgWyd1c2FnZScsICd0b3RhbF9yZXF1ZXN0cyddLCBcclxuICAgIFtbJ3RvdGFsX3JlcXVlc3RzJ10sIFsndG90YWxfaW5mZXJlbmNlcyddLCBbJ3RvdGFsUmVxdWVzdHMnXV0sIFxyXG4gICAgJ251bWJlcicsIFxyXG4gICAgMFxyXG4gICk7XHJcbiAgaWYgKHRvdGFsUmVxdWVzdHMudXNlZExlZ2FjeSkgdXNlZExlZ2FjeUZpZWxkcyA9IHRydWU7XHJcblxyXG4gIGNvbnN0IGlucHV0VG9rZW5zID0gZ2V0VmFsdWVXaXRoTGVnYWN5RmFsbGJhY2soXHJcbiAgICByYXdPYmosIFxyXG4gICAgWyd1c2FnZScsICdpbnB1dF90b2tlbnMnXSwgXHJcbiAgICBbWydpbnB1dF90b2tlbnMnXSwgWydpbnB1dFRva2VucyddXSwgXHJcbiAgICAnbnVtYmVyJywgXHJcbiAgICAwXHJcbiAgKTtcclxuICBpZiAoaW5wdXRUb2tlbnMudXNlZExlZ2FjeSkgdXNlZExlZ2FjeUZpZWxkcyA9IHRydWU7XHJcblxyXG4gIGNvbnN0IG91dHB1dFRva2VucyA9IGdldFZhbHVlV2l0aExlZ2FjeUZhbGxiYWNrKFxyXG4gICAgcmF3T2JqLCBcclxuICAgIFsndXNhZ2UnLCAnb3V0cHV0X3Rva2VucyddLCBcclxuICAgIFtbJ291dHB1dF90b2tlbnMnXSwgWydvdXRwdXRUb2tlbnMnXV0sIFxyXG4gICAgJ251bWJlcicsIFxyXG4gICAgMFxyXG4gICk7XHJcbiAgaWYgKG91dHB1dFRva2Vucy51c2VkTGVnYWN5KSB1c2VkTGVnYWN5RmllbGRzID0gdHJ1ZTtcclxuXHJcbiAgLy8gRGVyaXZlIHRvdGFsX3Rva2Vuc1xyXG4gIGxldCB0b3RhbFRva2VucyA9IGdldFZhbHVlV2l0aExlZ2FjeUZhbGxiYWNrKFxyXG4gICAgcmF3T2JqLCBcclxuICAgIFsndXNhZ2UnLCAndG90YWxfdG9rZW5zJ10sIFxyXG4gICAgW1sndG90YWxfdG9rZW5zJ10sIFsndG90YWxUb2tlbnMnXV0sIFxyXG4gICAgJ251bWJlcicsIFxyXG4gICAgMFxyXG4gICkudmFsdWUgYXMgbnVtYmVyO1xyXG5cclxuICBpZiAodG90YWxUb2tlbnMgPT09IDAgJiYgKChpbnB1dFRva2Vucy52YWx1ZSBhcyBudW1iZXIpID4gMCB8fCAob3V0cHV0VG9rZW5zLnZhbHVlIGFzIG51bWJlcikgPiAwKSkge1xyXG4gICAgdG90YWxUb2tlbnMgPSBkZXJpdmVUb3RhbFRva2Vucyh7XHJcbiAgICAgIGlucHV0X3Rva2VuczogaW5wdXRUb2tlbnMudmFsdWUsXHJcbiAgICAgIG91dHB1dF90b2tlbnM6IG91dHB1dFRva2Vucy52YWx1ZVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICBjb25zdCBjYWNoZUhpdHMgPSBnZXRWYWx1ZVdpdGhMZWdhY3lGYWxsYmFjayhcclxuICAgIHJhd09iaiwgXHJcbiAgICBbJ3VzYWdlJywgJ2NhY2hlX2hpdHMnXSwgXHJcbiAgICBbWydjYWNoZV9oaXRzJ10sIFsnY2FjaGVIaXRzJ11dLCBcclxuICAgICdudW1iZXInLCBcclxuICAgIDBcclxuICApO1xyXG5cclxuICBjb25zdCBjYWNoZUhpdFJhdGUgPSBnZXRWYWx1ZVdpdGhMZWdhY3lGYWxsYmFjayhcclxuICAgIHJhd09iaiwgXHJcbiAgICBbJ3VzYWdlJywgJ2NhY2hlX2hpdF9yYXRlJ10sIFxyXG4gICAgW1snY2FjaGVfaGl0X3JhdGUnXSwgWydjYWNoZUhpdFJhdGUnXV0sIFxyXG4gICAgJ251bWJlcicsIFxyXG4gICAgMFxyXG4gICk7XHJcblxyXG4gIC8vIEJ1aWxkIG9wdGlvbmFsIHR1bmluZyBzZWN0aW9uXHJcbiAgbGV0IHR1bmluZzogTW9kZWxNZXRyaWNzU2hhcGVbJ3R1bmluZyddIHwgdW5kZWZpbmVkO1xyXG4gIGNvbnN0IHRlbXBlcmF0dXJlID0gZXh0cmFjdE5lc3RlZFZhbHVlKHJhd09iaiwgWyd0dW5pbmcnLCAndGVtcGVyYXR1cmUnXSkgfHwgcmF3T2JqLnRlbXBlcmF0dXJlO1xyXG4gIGlmICh0ZW1wZXJhdHVyZSAhPT0gdW5kZWZpbmVkIHx8IHJhd09iai50b3BfcCAhPT0gdW5kZWZpbmVkIHx8IHJhd09iai5tYXhfdG9rZW5zICE9PSB1bmRlZmluZWQpIHtcclxuICAgIHR1bmluZyA9IHtcclxuICAgICAgdGVtcGVyYXR1cmU6IGNvZXJjZVRvTnVtYmVyKHRlbXBlcmF0dXJlLCAwLjcpLFxyXG4gICAgICB0b3BfcDogcmF3T2JqLnRvcF9wICE9PSB1bmRlZmluZWQgPyBjb2VyY2VUb051bWJlcihyYXdPYmoudG9wX3AsIHVuZGVmaW5lZCkgOiB1bmRlZmluZWQsXHJcbiAgICAgIG1heF90b2tlbnM6IHJhd09iai5tYXhfdG9rZW5zICE9PSB1bmRlZmluZWQgPyBjb2VyY2VUb051bWJlcihyYXdPYmoubWF4X3Rva2VucywgdW5kZWZpbmVkKSA6IHVuZGVmaW5lZCxcclxuICAgICAgcHJlc2VuY2VfcGVuYWx0eTogcmF3T2JqLnByZXNlbmNlX3BlbmFsdHkgIT09IHVuZGVmaW5lZCA/IGNvZXJjZVRvTnVtYmVyKHJhd09iai5wcmVzZW5jZV9wZW5hbHR5LCB1bmRlZmluZWQpIDogdW5kZWZpbmVkLFxyXG4gICAgICBmcmVxdWVuY3lfcGVuYWx0eTogcmF3T2JqLmZyZXF1ZW5jeV9wZW5hbHR5ICE9PSB1bmRlZmluZWQgPyBjb2VyY2VUb051bWJlcihyYXdPYmouZnJlcXVlbmN5X3BlbmFsdHksIHVuZGVmaW5lZCkgOiB1bmRlZmluZWQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgLy8gU2V0IG9yaWdpbiBmbGFnc1xyXG4gIGlmICh1c2VkTGVnYWN5RmllbGRzKSB7XHJcbiAgICBvcmlnaW5GbGFncy5tYXBwZWRMZWdhY3kgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgY29uc3QgaGFzTW9kZWxTZWN0aW9uID0gcmF3T2JqLm1vZGVsICYmIHR5cGVvZiByYXdPYmoubW9kZWwgPT09ICdvYmplY3QnO1xyXG4gIGNvbnN0IGhhc1BlcmZvcm1hbmNlU2VjdGlvbiA9IHJhd09iai5wZXJmb3JtYW5jZSAmJiB0eXBlb2YgcmF3T2JqLnBlcmZvcm1hbmNlID09PSAnb2JqZWN0JztcclxuICBjb25zdCBoYXNVc2FnZVNlY3Rpb24gPSByYXdPYmoudXNhZ2UgJiYgdHlwZW9mIHJhd09iai51c2FnZSA9PT0gJ29iamVjdCc7XHJcblxyXG4gIGlmICghaGFzTW9kZWxTZWN0aW9uIHx8ICFoYXNQZXJmb3JtYW5jZVNlY3Rpb24gfHwgIWhhc1VzYWdlU2VjdGlvbikge1xyXG4gICAgb3JpZ2luRmxhZ3MucGFydGlhbFBheWxvYWQgPSB0cnVlO1xyXG4gIH1cclxuXHJcbiAgLy8gT25lLXRpbWUgZGV2ZWxvcG1lbnQgbG9nZ2luZ1xyXG4gIGNvbnN0IG1pc3NpbmdGaWVsZHM6IHN0cmluZ1tdID0gW107XHJcbiAgaWYgKCFyYXcpIG1pc3NpbmdGaWVsZHMucHVzaCgnZW50aXJlIG1vZGVsIG1ldHJpY3Mgb2JqZWN0Jyk7XHJcbiAgaWYgKCFoYXNNb2RlbFNlY3Rpb24pIG1pc3NpbmdGaWVsZHMucHVzaCgnbW9kZWwgc2VjdGlvbicpO1xyXG4gIGlmICghaGFzUGVyZm9ybWFuY2VTZWN0aW9uKSBtaXNzaW5nRmllbGRzLnB1c2goJ3BlcmZvcm1hbmNlIHNlY3Rpb24nKTtcclxuICBpZiAoIWhhc1VzYWdlU2VjdGlvbikgbWlzc2luZ0ZpZWxkcy5wdXNoKCd1c2FnZSBzZWN0aW9uJyk7XHJcblxyXG4gIGlmICgocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdkZXZlbG9wbWVudCcgfHxcclxuICAgICAgICBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Rlc3QnIHx8XHJcbiAgICAgICAgdHlwZW9mIGplc3QgIT09ICd1bmRlZmluZWQnKSAmJlxyXG4gICAgICAobWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwIHx8IG9yaWdpbkZsYWdzLm1hcHBlZExlZ2FjeSkgJiZcclxuICAgICAgIWhhc0xvZ2dlZE1pc3NpbmdGaWVsZHMpIHtcclxuICAgIGhhc0xvZ2dlZE1pc3NpbmdGaWVsZHMgPSB0cnVlO1xyXG4gICAgXHJcbiAgICBpZiAobWlzc2luZ0ZpZWxkcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgIGNvbnNvbGUud2FybihcclxuICAgICAgICAnW01vZGVsTWV0cmljc0d1YXJkXSBNaXNzaW5nIG1vZGVsIG1ldHJpY3MgZmllbGRzIGRldGVjdGVkOicsXHJcbiAgICAgICAgbWlzc2luZ0ZpZWxkcy5qb2luKCcsICcpLFxyXG4gICAgICAgICdcXG5SYXcgZGF0YSBzYW1wbGU6JyxcclxuICAgICAgICBzYWZlU3RyaW5naWZ5KHJhd09iaik/LnN1YnN0cmluZygwLCA1MDApICsgJy4uLidcclxuICAgICAgKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgaWYgKG9yaWdpbkZsYWdzLm1hcHBlZExlZ2FjeSkge1xyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICBjb25zb2xlLndhcm4oXHJcbiAgICAgICAgJ1tNb2RlbE1ldHJpY3NHdWFyZF0gVXNpbmcgbGVnYWN5IG1vZGVsIG1ldHJpY3MgZmllbGRzOicsXHJcbiAgICAgICAgJ29wdGltaXphdGlvbkxldmVsLCBvcHRfbGV2ZWwsIG1vZGVsX25hbWUsIHRocm91Z2hwdXRfcGVyX3NlY29uZCwgZXRjLicsXHJcbiAgICAgICAgJ0NvbnNpZGVyIG1pZ3JhdGluZyB0byBjYW5vbmljYWwgc3RydWN0dXJlJ1xyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gQnVpbGQgbm9ybWFsaXplZCBtb2RlbCBtZXRyaWNzIG9iamVjdFxyXG4gIGNvbnN0IG5vcm1hbGl6ZWQ6IE1vZGVsTWV0cmljc1NoYXBlID0ge1xyXG4gICAgbW9kZWw6IHtcclxuICAgICAgbmFtZTogbW9kZWxOYW1lLnZhbHVlIGFzIHN0cmluZyxcclxuICAgICAgcHJvdmlkZXI6IHByb3ZpZGVyLnZhbHVlIGFzIHN0cmluZyxcclxuICAgICAgb3B0aW1pemF0aW9uX2xldmVsOiBvcHRpbWl6YXRpb25MZXZlbC52YWx1ZSBhcyBzdHJpbmcsXHJcbiAgICAgIC4uLih2ZXJzaW9uLnZhbHVlICYmIHZlcnNpb24udmFsdWUgIT09ICcnID8geyB2ZXJzaW9uOiB2ZXJzaW9uLnZhbHVlIGFzIHN0cmluZyB9IDoge30pLFxyXG4gICAgICAuLi4ob3B0aW1pemF0aW9uTW9kZS52YWx1ZSAmJiBvcHRpbWl6YXRpb25Nb2RlLnZhbHVlICE9PSAnJyA/IHsgb3B0aW1pemF0aW9uX21vZGU6IG9wdGltaXphdGlvbk1vZGUudmFsdWUgYXMgc3RyaW5nIH0gOiB7fSksXHJcbiAgICB9LFxyXG4gICAgcGVyZm9ybWFuY2U6IHtcclxuICAgICAgdGhyb3VnaHB1dF9ycHM6IHRocm91Z2hwdXRScHMudmFsdWUgYXMgbnVtYmVyLFxyXG4gICAgICBhdmdfbGF0ZW5jeV9tczogYXZnTGF0ZW5jeU1zLnZhbHVlIGFzIG51bWJlcixcclxuICAgICAgcDk1X2xhdGVuY3lfbXM6IHA5NUxhdGVuY3lNcy52YWx1ZSBhcyBudW1iZXIsXHJcbiAgICAgIHN1Y2Nlc3NfcmF0ZTogc3VjY2Vzc1JhdGUsXHJcbiAgICB9LFxyXG4gICAgdXNhZ2U6IHtcclxuICAgICAgdG90YWxfcmVxdWVzdHM6IHRvdGFsUmVxdWVzdHMudmFsdWUgYXMgbnVtYmVyLFxyXG4gICAgICBpbnB1dF90b2tlbnM6IGlucHV0VG9rZW5zLnZhbHVlIGFzIG51bWJlcixcclxuICAgICAgb3V0cHV0X3Rva2Vuczogb3V0cHV0VG9rZW5zLnZhbHVlIGFzIG51bWJlcixcclxuICAgICAgdG90YWxfdG9rZW5zOiB0b3RhbFRva2VucyxcclxuICAgICAgLi4uKChjYWNoZUhpdHMudmFsdWUgYXMgbnVtYmVyKSA+IDAgPyB7IGNhY2hlX2hpdHM6IGNhY2hlSGl0cy52YWx1ZSBhcyBudW1iZXIgfSA6IHt9KSxcclxuICAgICAgLi4uKChjYWNoZUhpdFJhdGUudmFsdWUgYXMgbnVtYmVyKSA+IDAgPyB7IGNhY2hlX2hpdF9yYXRlOiBjYWNoZUhpdFJhdGUudmFsdWUgYXMgbnVtYmVyIH0gOiB7fSksXHJcbiAgICB9LFxyXG4gICAgLi4uKHR1bmluZyA/IHsgdHVuaW5nIH0gOiB7fSksXHJcbiAgICBvcmlnaW5GbGFncyxcclxuICB9O1xyXG5cclxuICByZXR1cm4gbm9ybWFsaXplZDtcclxufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsSUFBSUEsc0JBQXNCLEdBQUcsS0FBSztBQXFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0EsTUFBTUMsYUFBYSxHQUFJQyxHQUFZLElBQWE7RUFDOUMsSUFBSTtJQUNGLE9BQU9DLElBQUksQ0FBQ0MsU0FBUyxDQUFDRixHQUFHLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQztFQUNyQyxDQUFDLENBQUMsTUFBTTtJQUNOLE9BQU9HLE1BQU0sQ0FBQ0gsR0FBRyxDQUFDO0VBQ3BCO0FBQ0YsQ0FBQzs7QUFFRDtBQUNB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