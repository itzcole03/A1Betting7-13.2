189b20f996291918e195716c50b9620e
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.getActiveHttpRequests = getActiveHttpRequests;
exports.getHttpRequestHistory = getHttpRequestHistory;
exports.getHttpSpanSummary = getHttpSpanSummary;
exports.getHttpTelemetryStats = getHttpTelemetryStats;
exports.httpFetch = httpFetch;
var _RequestContextService = require("./RequestContextService");
var _apiConfig = require("../config/apiConfig");
// HttpClient.ts - Enhanced fetch abstraction with request ID, logging, timing, and telemetry

class HttpTelemetry {
  constructor() {
    this.requestHistory = [];
    this.maxHistorySize = 100;
    this.activeRequests = new Map();
  }
  startRequest(requestId, url, method, span_name, tags) {
    const telemetry = {
      requestId,
      url,
      method,
      startTime: performance.now(),
      success: false,
      span_name,
      tags
    };
    this.activeRequests.set(requestId, telemetry);
    return telemetry;
  }
  finishRequest(requestId, status, error, responseSize, requestSize) {
    const telemetry = this.activeRequests.get(requestId);
    if (!telemetry) return;
    const endTime = performance.now();
    telemetry.endTime = endTime;
    telemetry.duration = endTime - telemetry.startTime;
    telemetry.status = status;
    telemetry.success = !error && (!status || status >= 200 && status < 300);
    telemetry.error = error;
    telemetry.responseSize = responseSize;
    telemetry.requestSize = requestSize;

    // Move to history
    this.activeRequests.delete(requestId);
    this.requestHistory.push(telemetry);

    // Maintain history size
    if (this.requestHistory.length > this.maxHistorySize) {
      this.requestHistory.shift();
    }
  }
  getRequestHistory() {
    return [...this.requestHistory];
  }
  getActiveRequests() {
    return Array.from(this.activeRequests.values());
  }
  getRequestStats() {
    const total = this.requestHistory.length;
    const active = this.activeRequests.size;
    const successful = this.requestHistory.filter(r => r.success).length;
    const success_rate = total > 0 ? successful / total * 100 : 0;
    const durations = this.requestHistory.filter(r => r.duration !== undefined).map(r => r.duration);
    const avg_duration = durations.length > 0 ? durations.reduce((a, b) => a + b, 0) / durations.length : 0;
    const errors = this.requestHistory.filter(r => r.error);
    const error_count = errors.length;
    const recent_errors = errors.slice(-5).map(r => r.error);
    return {
      total,
      active,
      success_rate: Math.round(success_rate * 100) / 100,
      avg_duration: Math.round(avg_duration * 100) / 100,
      error_count,
      recent_errors
    };
  }

  // Get span-based request grouping
  getSpanSummary() {
    const spans = {};
    this.requestHistory.forEach(req => {
      const span = req.span_name || 'default';
      if (!spans[span]) spans[span] = [];
      spans[span].push(req);
    });
    const summary = {};
    Object.entries(spans).forEach(([spanName, requests]) => {
      const durations = requests.filter(r => r.duration).map(r => r.duration);
      const successful = requests.filter(r => r.success).length;
      summary[spanName] = {
        count: requests.length,
        avg_duration: durations.length > 0 ? Math.round(durations.reduce((a, b) => a + b, 0) / durations.length * 100) / 100 : 0,
        success_rate: Math.round(successful / requests.length * 100 * 100) / 100,
        recent_requests: requests.slice(-3)
      };
    });
    return summary;
  }
}

// Global telemetry instance
const httpTelemetry = new HttpTelemetry();
async function httpFetch(url, options = {}) {
  const {
    version,
    logLabel,
    span_name,
    tags,
    ...fetchOptions
  } = options;
  // Explicitly type headers as Record<string, string> for safe indexing
  const headers = {
    ...(fetchOptions.headers || {}),
    ...(0, _RequestContextService.getRequestContext)(version)
  };
  const label = logLabel || 'HttpClient';
  const requestId = headers['X-Request-ID'];
  const method = fetchOptions.method || 'GET';

  // Always prepend base URL to relative paths (starting with '/') that are not already absolute
  let finalUrl = url;
  if (url.startsWith('/') && !/^https?:\/\//.test(url)) {
    const base = _apiConfig.API_BASE_URL;
    finalUrl = base.replace(/\/$/, '') + url;
  }

  // Calculate request size (approximate)
  let requestSize = 0;
  if (fetchOptions.body) {
    if (typeof fetchOptions.body === 'string') {
      requestSize = new Blob([fetchOptions.body]).size;
    } else if (fetchOptions.body instanceof FormData) {
      requestSize = 0; // FormData size is difficult to calculate
    } else {
      requestSize = 0; // Other body types
    }
  }

  // Start telemetry tracking
  const telemetry = httpTelemetry.startRequest(requestId, finalUrl, method, span_name, tags);

  // Enhanced logging with span context
  const logPrefix = `[${label}] [${requestId}]`;
  const spanInfo = span_name ? ` [${span_name}]` : '';
  const isTest = typeof process !== 'undefined' && process.env && process.env.NODE_ENV === 'test';
  if (!isTest) {
    // eslint-disable-next-line no-console
    console.log(`${logPrefix}${spanInfo} Request:`, finalUrl, fetchOptions);
  }
  try {
    const response = await fetch(finalUrl, {
      ...fetchOptions,
      headers
    });

    // Calculate response size from content-length header
    const responseSize = response.headers.get('content-length') ? parseInt(response.headers.get('content-length'), 10) : undefined;

    // Finish telemetry tracking
    httpTelemetry.finishRequest(requestId, response.status, undefined, responseSize, requestSize);
    if (!isTest) {
      // eslint-disable-next-line no-console
      console.log(`${logPrefix}${spanInfo} Response:`, finalUrl, `Status: ${response.status}`, `Duration: ${telemetry.duration?.toFixed(1)}ms`, responseSize ? `Size: ${responseSize}b` : '');
    }
    return response;
  } catch (error) {
    const errorMessage = error instanceof Error ? error.message : String(error);

    // Finish telemetry tracking with error
    httpTelemetry.finishRequest(requestId, undefined, errorMessage, undefined, requestSize);

    // Suppress "Failed to fetch" errors to avoid console noise when backend unavailable
    if (!isTest) {
      if (error instanceof Error && error.message.includes('Failed to fetch')) {
        // Only log as warning instead of error to reduce console noise
        // eslint-disable-next-line no-console
        console.warn(`${logPrefix}${spanInfo} Backend unavailable:`, finalUrl, `Duration: ${telemetry.duration?.toFixed(1)}ms`);
      } else {
        // eslint-disable-next-line no-console
        console.error(`${logPrefix}${spanInfo} Error:`, finalUrl, error, `Duration: ${telemetry.duration?.toFixed(1)}ms`);
      }
    }
    throw error;
  }
}

// Telemetry access functions for debugging and monitoring
function getHttpTelemetryStats() {
  return httpTelemetry.getRequestStats();
}
function getHttpRequestHistory() {
  return httpTelemetry.getRequestHistory();
}
function getActiveHttpRequests() {
  return httpTelemetry.getActiveRequests();
}
function getHttpSpanSummary() {
  return httpTelemetry.getSpanSummary();
}

// Global telemetry access for debugging in browser console
if (typeof window !== 'undefined') {
  window.httpTelemetry = {
    stats: getHttpTelemetryStats,
    history: getHttpRequestHistory,
    active: getActiveHttpRequests,
    spans: getHttpSpanSummary
  };
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfUmVxdWVzdENvbnRleHRTZXJ2aWNlIiwicmVxdWlyZSIsIl9hcGlDb25maWciLCJIdHRwVGVsZW1ldHJ5IiwiY29uc3RydWN0b3IiLCJyZXF1ZXN0SGlzdG9yeSIsIm1heEhpc3RvcnlTaXplIiwiYWN0aXZlUmVxdWVzdHMiLCJNYXAiLCJzdGFydFJlcXVlc3QiLCJyZXF1ZXN0SWQiLCJ1cmwiLCJtZXRob2QiLCJzcGFuX25hbWUiLCJ0YWdzIiwidGVsZW1ldHJ5Iiwic3RhcnRUaW1lIiwicGVyZm9ybWFuY2UiLCJub3ciLCJzdWNjZXNzIiwic2V0IiwiZmluaXNoUmVxdWVzdCIsInN0YXR1cyIsImVycm9yIiwicmVzcG9uc2VTaXplIiwicmVxdWVzdFNpemUiLCJnZXQiLCJlbmRUaW1lIiwiZHVyYXRpb24iLCJkZWxldGUiLCJwdXNoIiwibGVuZ3RoIiwic2hpZnQiLCJnZXRSZXF1ZXN0SGlzdG9yeSIsImdldEFjdGl2ZVJlcXVlc3RzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwiZ2V0UmVxdWVzdFN0YXRzIiwidG90YWwiLCJhY3RpdmUiLCJzaXplIiwic3VjY2Vzc2Z1bCIsImZpbHRlciIsInIiLCJzdWNjZXNzX3JhdGUiLCJkdXJhdGlvbnMiLCJ1bmRlZmluZWQiLCJtYXAiLCJhdmdfZHVyYXRpb24iLCJyZWR1Y2UiLCJhIiwiYiIsImVycm9ycyIsImVycm9yX2NvdW50IiwicmVjZW50X2Vycm9ycyIsInNsaWNlIiwiTWF0aCIsInJvdW5kIiwiZ2V0U3BhblN1bW1hcnkiLCJzcGFucyIsImZvckVhY2giLCJyZXEiLCJzcGFuIiwic3VtbWFyeSIsIk9iamVjdCIsImVudHJpZXMiLCJzcGFuTmFtZSIsInJlcXVlc3RzIiwiY291bnQiLCJyZWNlbnRfcmVxdWVzdHMiLCJodHRwVGVsZW1ldHJ5IiwiaHR0cEZldGNoIiwib3B0aW9ucyIsInZlcnNpb24iLCJsb2dMYWJlbCIsImZldGNoT3B0aW9ucyIsImhlYWRlcnMiLCJnZXRSZXF1ZXN0Q29udGV4dCIsImxhYmVsIiwiZmluYWxVcmwiLCJzdGFydHNXaXRoIiwidGVzdCIsImJhc2UiLCJBUElfQkFTRV9VUkwiLCJyZXBsYWNlIiwiYm9keSIsIkJsb2IiLCJGb3JtRGF0YSIsImxvZ1ByZWZpeCIsInNwYW5JbmZvIiwiaXNUZXN0IiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwiY29uc29sZSIsImxvZyIsInJlc3BvbnNlIiwiZmV0Y2giLCJwYXJzZUludCIsInRvRml4ZWQiLCJlcnJvck1lc3NhZ2UiLCJFcnJvciIsIm1lc3NhZ2UiLCJTdHJpbmciLCJpbmNsdWRlcyIsIndhcm4iLCJnZXRIdHRwVGVsZW1ldHJ5U3RhdHMiLCJnZXRIdHRwUmVxdWVzdEhpc3RvcnkiLCJnZXRBY3RpdmVIdHRwUmVxdWVzdHMiLCJnZXRIdHRwU3BhblN1bW1hcnkiLCJ3aW5kb3ciLCJzdGF0cyIsImhpc3RvcnkiXSwic291cmNlcyI6WyJIdHRwQ2xpZW50LnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8vIEh0dHBDbGllbnQudHMgLSBFbmhhbmNlZCBmZXRjaCBhYnN0cmFjdGlvbiB3aXRoIHJlcXVlc3QgSUQsIGxvZ2dpbmcsIHRpbWluZywgYW5kIHRlbGVtZXRyeVxuaW1wb3J0IHsgZ2V0UmVxdWVzdENvbnRleHQgfSBmcm9tICcuL1JlcXVlc3RDb250ZXh0U2VydmljZSc7XG5pbXBvcnQgeyBBUElfQkFTRV9VUkwgfSBmcm9tICcuLi9jb25maWcvYXBpQ29uZmlnJztcblxuZXhwb3J0IGludGVyZmFjZSBIdHRwUmVxdWVzdE9wdGlvbnMgZXh0ZW5kcyBSZXF1ZXN0SW5pdCB7XG4gIHZlcnNpb24/OiBzdHJpbmc7XG4gIGxvZ0xhYmVsPzogc3RyaW5nO1xuICBzcGFuX25hbWU/OiBzdHJpbmc7ICAvLyBGb3Igc3BhbiB0cmFja2luZ1xuICB0YWdzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbj47ICAvLyBGb3IgcmVxdWVzdCB0YWdnaW5nXG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgUmVxdWVzdFRlbGVtZXRyeSB7XG4gIHJlcXVlc3RJZDogc3RyaW5nO1xuICB1cmw6IHN0cmluZztcbiAgbWV0aG9kOiBzdHJpbmc7XG4gIHN0YXJ0VGltZTogbnVtYmVyO1xuICBlbmRUaW1lPzogbnVtYmVyO1xuICBkdXJhdGlvbj86IG51bWJlcjtcbiAgc3RhdHVzPzogbnVtYmVyO1xuICBzdWNjZXNzOiBib29sZWFuO1xuICBlcnJvcj86IHN0cmluZztcbiAgc3Bhbl9uYW1lPzogc3RyaW5nO1xuICB0YWdzPzogUmVjb3JkPHN0cmluZywgc3RyaW5nIHwgbnVtYmVyIHwgYm9vbGVhbj47XG4gIHJlc3BvbnNlU2l6ZT86IG51bWJlcjtcbiAgcmVxdWVzdFNpemU/OiBudW1iZXI7XG59XG5cbmNsYXNzIEh0dHBUZWxlbWV0cnkge1xuICBwcml2YXRlIHJlcXVlc3RIaXN0b3J5OiBSZXF1ZXN0VGVsZW1ldHJ5W10gPSBbXTtcbiAgcHJpdmF0ZSBtYXhIaXN0b3J5U2l6ZSA9IDEwMDtcbiAgcHJpdmF0ZSBhY3RpdmVSZXF1ZXN0cyA9IG5ldyBNYXA8c3RyaW5nLCBSZXF1ZXN0VGVsZW1ldHJ5PigpO1xuXG4gIHN0YXJ0UmVxdWVzdChcbiAgICByZXF1ZXN0SWQ6IHN0cmluZyxcbiAgICB1cmw6IHN0cmluZyxcbiAgICBtZXRob2Q6IHN0cmluZyxcbiAgICBzcGFuX25hbWU/OiBzdHJpbmcsXG4gICAgdGFncz86IFJlY29yZDxzdHJpbmcsIHN0cmluZyB8IG51bWJlciB8IGJvb2xlYW4+XG4gICk6IFJlcXVlc3RUZWxlbWV0cnkge1xuICAgIGNvbnN0IHRlbGVtZXRyeTogUmVxdWVzdFRlbGVtZXRyeSA9IHtcbiAgICAgIHJlcXVlc3RJZCxcbiAgICAgIHVybCxcbiAgICAgIG1ldGhvZCxcbiAgICAgIHN0YXJ0VGltZTogcGVyZm9ybWFuY2Uubm93KCksXG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIHNwYW5fbmFtZSxcbiAgICAgIHRhZ3NcbiAgICB9O1xuXG4gICAgdGhpcy5hY3RpdmVSZXF1ZXN0cy5zZXQocmVxdWVzdElkLCB0ZWxlbWV0cnkpO1xuICAgIHJldHVybiB0ZWxlbWV0cnk7XG4gIH1cblxuICBmaW5pc2hSZXF1ZXN0KFxuICAgIHJlcXVlc3RJZDogc3RyaW5nLFxuICAgIHN0YXR1cz86IG51bWJlcixcbiAgICBlcnJvcj86IHN0cmluZyxcbiAgICByZXNwb25zZVNpemU/OiBudW1iZXIsXG4gICAgcmVxdWVzdFNpemU/OiBudW1iZXJcbiAgKTogdm9pZCB7XG4gICAgY29uc3QgdGVsZW1ldHJ5ID0gdGhpcy5hY3RpdmVSZXF1ZXN0cy5nZXQocmVxdWVzdElkKTtcbiAgICBpZiAoIXRlbGVtZXRyeSkgcmV0dXJuO1xuXG4gICAgY29uc3QgZW5kVGltZSA9IHBlcmZvcm1hbmNlLm5vdygpO1xuICAgIHRlbGVtZXRyeS5lbmRUaW1lID0gZW5kVGltZTtcbiAgICB0ZWxlbWV0cnkuZHVyYXRpb24gPSBlbmRUaW1lIC0gdGVsZW1ldHJ5LnN0YXJ0VGltZTtcbiAgICB0ZWxlbWV0cnkuc3RhdHVzID0gc3RhdHVzO1xuICAgIHRlbGVtZXRyeS5zdWNjZXNzID0gIWVycm9yICYmICghc3RhdHVzIHx8IChzdGF0dXMgPj0gMjAwICYmIHN0YXR1cyA8IDMwMCkpO1xuICAgIHRlbGVtZXRyeS5lcnJvciA9IGVycm9yO1xuICAgIHRlbGVtZXRyeS5yZXNwb25zZVNpemUgPSByZXNwb25zZVNpemU7XG4gICAgdGVsZW1ldHJ5LnJlcXVlc3RTaXplID0gcmVxdWVzdFNpemU7XG5cbiAgICAvLyBNb3ZlIHRvIGhpc3RvcnlcbiAgICB0aGlzLmFjdGl2ZVJlcXVlc3RzLmRlbGV0ZShyZXF1ZXN0SWQpO1xuICAgIHRoaXMucmVxdWVzdEhpc3RvcnkucHVzaCh0ZWxlbWV0cnkpO1xuXG4gICAgLy8gTWFpbnRhaW4gaGlzdG9yeSBzaXplXG4gICAgaWYgKHRoaXMucmVxdWVzdEhpc3RvcnkubGVuZ3RoID4gdGhpcy5tYXhIaXN0b3J5U2l6ZSkge1xuICAgICAgdGhpcy5yZXF1ZXN0SGlzdG9yeS5zaGlmdCgpO1xuICAgIH1cbiAgfVxuXG4gIGdldFJlcXVlc3RIaXN0b3J5KCk6IFJlcXVlc3RUZWxlbWV0cnlbXSB7XG4gICAgcmV0dXJuIFsuLi50aGlzLnJlcXVlc3RIaXN0b3J5XTtcbiAgfVxuXG4gIGdldEFjdGl2ZVJlcXVlc3RzKCk6IFJlcXVlc3RUZWxlbWV0cnlbXSB7XG4gICAgcmV0dXJuIEFycmF5LmZyb20odGhpcy5hY3RpdmVSZXF1ZXN0cy52YWx1ZXMoKSk7XG4gIH1cblxuICBnZXRSZXF1ZXN0U3RhdHMoKToge1xuICAgIHRvdGFsOiBudW1iZXI7XG4gICAgYWN0aXZlOiBudW1iZXI7XG4gICAgc3VjY2Vzc19yYXRlOiBudW1iZXI7XG4gICAgYXZnX2R1cmF0aW9uOiBudW1iZXI7XG4gICAgZXJyb3JfY291bnQ6IG51bWJlcjtcbiAgICByZWNlbnRfZXJyb3JzOiBzdHJpbmdbXTtcbiAgfSB7XG4gICAgY29uc3QgdG90YWwgPSB0aGlzLnJlcXVlc3RIaXN0b3J5Lmxlbmd0aDtcbiAgICBjb25zdCBhY3RpdmUgPSB0aGlzLmFjdGl2ZVJlcXVlc3RzLnNpemU7XG4gICAgY29uc3Qgc3VjY2Vzc2Z1bCA9IHRoaXMucmVxdWVzdEhpc3RvcnkuZmlsdGVyKHIgPT4gci5zdWNjZXNzKS5sZW5ndGg7XG4gICAgY29uc3Qgc3VjY2Vzc19yYXRlID0gdG90YWwgPiAwID8gKHN1Y2Nlc3NmdWwgLyB0b3RhbCkgKiAxMDAgOiAwO1xuICAgIFxuICAgIGNvbnN0IGR1cmF0aW9ucyA9IHRoaXMucmVxdWVzdEhpc3RvcnlcbiAgICAgIC5maWx0ZXIociA9PiByLmR1cmF0aW9uICE9PSB1bmRlZmluZWQpXG4gICAgICAubWFwKHIgPT4gci5kdXJhdGlvbiEpO1xuICAgIGNvbnN0IGF2Z19kdXJhdGlvbiA9IGR1cmF0aW9ucy5sZW5ndGggPiAwIFxuICAgICAgPyBkdXJhdGlvbnMucmVkdWNlKChhLCBiKSA9PiBhICsgYiwgMCkgLyBkdXJhdGlvbnMubGVuZ3RoIFxuICAgICAgOiAwO1xuICAgIFxuICAgIGNvbnN0IGVycm9ycyA9IHRoaXMucmVxdWVzdEhpc3RvcnkuZmlsdGVyKHIgPT4gci5lcnJvcik7XG4gICAgY29uc3QgZXJyb3JfY291bnQgPSBlcnJvcnMubGVuZ3RoO1xuICAgIGNvbnN0IHJlY2VudF9lcnJvcnMgPSBlcnJvcnMuc2xpY2UoLTUpLm1hcChyID0+IHIuZXJyb3IhKTtcblxuICAgIHJldHVybiB7XG4gICAgICB0b3RhbCxcbiAgICAgIGFjdGl2ZSxcbiAgICAgIHN1Y2Nlc3NfcmF0ZTogTWF0aC5yb3VuZChzdWNjZXNzX3JhdGUgKiAxMDApIC8gMTAwLFxuICAgICAgYXZnX2R1cmF0aW9uOiBNYXRoLnJvdW5kKGF2Z19kdXJhdGlvbiAqIDEwMCkgLyAxMDAsXG4gICAgICBlcnJvcl9jb3VudCxcbiAgICAgIHJlY2VudF9lcnJvcnNcbiAgICB9O1xuICB9XG5cbiAgLy8gR2V0IHNwYW4tYmFzZWQgcmVxdWVzdCBncm91cGluZ1xuICBnZXRTcGFuU3VtbWFyeSgpOiBSZWNvcmQ8c3RyaW5nLCB7XG4gICAgY291bnQ6IG51bWJlcjtcbiAgICBhdmdfZHVyYXRpb246IG51bWJlcjtcbiAgICBzdWNjZXNzX3JhdGU6IG51bWJlcjtcbiAgICByZWNlbnRfcmVxdWVzdHM6IFJlcXVlc3RUZWxlbWV0cnlbXTtcbiAgfT4ge1xuICAgIGNvbnN0IHNwYW5zOiBSZWNvcmQ8c3RyaW5nLCBSZXF1ZXN0VGVsZW1ldHJ5W10+ID0ge307XG4gICAgXG4gICAgdGhpcy5yZXF1ZXN0SGlzdG9yeS5mb3JFYWNoKHJlcSA9PiB7XG4gICAgICBjb25zdCBzcGFuID0gcmVxLnNwYW5fbmFtZSB8fCAnZGVmYXVsdCc7XG4gICAgICBpZiAoIXNwYW5zW3NwYW5dKSBzcGFuc1tzcGFuXSA9IFtdO1xuICAgICAgc3BhbnNbc3Bhbl0ucHVzaChyZXEpO1xuICAgIH0pO1xuXG4gICAgY29uc3Qgc3VtbWFyeTogUmVjb3JkPHN0cmluZywge1xuICAgICAgY291bnQ6IG51bWJlcjtcbiAgICAgIGF2Z19kdXJhdGlvbjogbnVtYmVyO1xuICAgICAgc3VjY2Vzc19yYXRlOiBudW1iZXI7XG4gICAgICByZWNlbnRfcmVxdWVzdHM6IFJlcXVlc3RUZWxlbWV0cnlbXTtcbiAgICB9PiA9IHt9O1xuICAgIE9iamVjdC5lbnRyaWVzKHNwYW5zKS5mb3JFYWNoKChbc3Bhbk5hbWUsIHJlcXVlc3RzXSkgPT4ge1xuICAgICAgY29uc3QgZHVyYXRpb25zID0gcmVxdWVzdHMuZmlsdGVyKHIgPT4gci5kdXJhdGlvbikubWFwKHIgPT4gci5kdXJhdGlvbiEpO1xuICAgICAgY29uc3Qgc3VjY2Vzc2Z1bCA9IHJlcXVlc3RzLmZpbHRlcihyID0+IHIuc3VjY2VzcykubGVuZ3RoO1xuICAgICAgXG4gICAgICBzdW1tYXJ5W3NwYW5OYW1lXSA9IHtcbiAgICAgICAgY291bnQ6IHJlcXVlc3RzLmxlbmd0aCxcbiAgICAgICAgYXZnX2R1cmF0aW9uOiBkdXJhdGlvbnMubGVuZ3RoID4gMCBcbiAgICAgICAgICA/IE1hdGgucm91bmQoKGR1cmF0aW9ucy5yZWR1Y2UoKGEsIGIpID0+IGEgKyBiLCAwKSAvIGR1cmF0aW9ucy5sZW5ndGgpICogMTAwKSAvIDEwMFxuICAgICAgICAgIDogMCxcbiAgICAgICAgc3VjY2Vzc19yYXRlOiBNYXRoLnJvdW5kKChzdWNjZXNzZnVsIC8gcmVxdWVzdHMubGVuZ3RoKSAqIDEwMCAqIDEwMCkgLyAxMDAsXG4gICAgICAgIHJlY2VudF9yZXF1ZXN0czogcmVxdWVzdHMuc2xpY2UoLTMpXG4gICAgICB9O1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHN1bW1hcnk7XG4gIH1cbn1cblxuLy8gR2xvYmFsIHRlbGVtZXRyeSBpbnN0YW5jZVxuY29uc3QgaHR0cFRlbGVtZXRyeSA9IG5ldyBIdHRwVGVsZW1ldHJ5KCk7XG5cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBodHRwRmV0Y2godXJsOiBzdHJpbmcsIG9wdGlvbnM6IEh0dHBSZXF1ZXN0T3B0aW9ucyA9IHt9KTogUHJvbWlzZTxSZXNwb25zZT4ge1xuICBjb25zdCB7IHZlcnNpb24sIGxvZ0xhYmVsLCBzcGFuX25hbWUsIHRhZ3MsIC4uLmZldGNoT3B0aW9ucyB9ID0gb3B0aW9ucztcbiAgLy8gRXhwbGljaXRseSB0eXBlIGhlYWRlcnMgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPiBmb3Igc2FmZSBpbmRleGluZ1xuICBjb25zdCBoZWFkZXJzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+ID0ge1xuICAgIC4uLigoZmV0Y2hPcHRpb25zLmhlYWRlcnMgYXMgUmVjb3JkPHN0cmluZywgc3RyaW5nPikgfHwge30pLFxuICAgIC4uLmdldFJlcXVlc3RDb250ZXh0KHZlcnNpb24pLFxuICB9O1xuICBjb25zdCBsYWJlbCA9IGxvZ0xhYmVsIHx8ICdIdHRwQ2xpZW50JztcbiAgY29uc3QgcmVxdWVzdElkID0gaGVhZGVyc1snWC1SZXF1ZXN0LUlEJ107XG4gIGNvbnN0IG1ldGhvZCA9IGZldGNoT3B0aW9ucy5tZXRob2QgfHwgJ0dFVCc7XG5cbiAgLy8gQWx3YXlzIHByZXBlbmQgYmFzZSBVUkwgdG8gcmVsYXRpdmUgcGF0aHMgKHN0YXJ0aW5nIHdpdGggJy8nKSB0aGF0IGFyZSBub3QgYWxyZWFkeSBhYnNvbHV0ZVxuICBsZXQgZmluYWxVcmwgPSB1cmw7XG4gIGlmICh1cmwuc3RhcnRzV2l0aCgnLycpICYmICEvXmh0dHBzPzpcXC9cXC8vLnRlc3QodXJsKSkge1xuICAgIGNvbnN0IGJhc2UgPSBBUElfQkFTRV9VUkw7XG4gICAgZmluYWxVcmwgPSBiYXNlLnJlcGxhY2UoL1xcLyQvLCAnJykgKyB1cmw7XG4gIH1cblxuICAvLyBDYWxjdWxhdGUgcmVxdWVzdCBzaXplIChhcHByb3hpbWF0ZSlcbiAgbGV0IHJlcXVlc3RTaXplID0gMDtcbiAgaWYgKGZldGNoT3B0aW9ucy5ib2R5KSB7XG4gICAgaWYgKHR5cGVvZiBmZXRjaE9wdGlvbnMuYm9keSA9PT0gJ3N0cmluZycpIHtcbiAgICAgIHJlcXVlc3RTaXplID0gbmV3IEJsb2IoW2ZldGNoT3B0aW9ucy5ib2R5XSkuc2l6ZTtcbiAgICB9IGVsc2UgaWYgKGZldGNoT3B0aW9ucy5ib2R5IGluc3RhbmNlb2YgRm9ybURhdGEpIHtcbiAgICAgIHJlcXVlc3RTaXplID0gMDsgLy8gRm9ybURhdGEgc2l6ZSBpcyBkaWZmaWN1bHQgdG8gY2FsY3VsYXRlXG4gICAgfSBlbHNlIHtcbiAgICAgIHJlcXVlc3RTaXplID0gMDsgLy8gT3RoZXIgYm9keSB0eXBlc1xuICAgIH1cbiAgfVxuXG4gIC8vIFN0YXJ0IHRlbGVtZXRyeSB0cmFja2luZ1xuICBjb25zdCB0ZWxlbWV0cnkgPSBodHRwVGVsZW1ldHJ5LnN0YXJ0UmVxdWVzdChcbiAgICByZXF1ZXN0SWQsXG4gICAgZmluYWxVcmwsXG4gICAgbWV0aG9kLFxuICAgIHNwYW5fbmFtZSxcbiAgICB0YWdzXG4gICk7XG5cbiAgLy8gRW5oYW5jZWQgbG9nZ2luZyB3aXRoIHNwYW4gY29udGV4dFxuICBjb25zdCBsb2dQcmVmaXggPSBgWyR7bGFiZWx9XSBbJHtyZXF1ZXN0SWR9XWA7XG4gIGNvbnN0IHNwYW5JbmZvID0gc3Bhbl9uYW1lID8gYCBbJHtzcGFuX25hbWV9XWAgOiAnJztcbiAgICBjb25zdCBpc1Rlc3QgPSB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYgcHJvY2Vzcy5lbnYgJiYgcHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICd0ZXN0JztcbiAgICBpZiAoIWlzVGVzdCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUubG9nKGAke2xvZ1ByZWZpeH0ke3NwYW5JbmZvfSBSZXF1ZXN0OmAsIGZpbmFsVXJsLCBmZXRjaE9wdGlvbnMpO1xuICAgIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2goZmluYWxVcmwsIHsgLi4uZmV0Y2hPcHRpb25zLCBoZWFkZXJzIH0pO1xuICAgIFxuICAgIC8vIENhbGN1bGF0ZSByZXNwb25zZSBzaXplIGZyb20gY29udGVudC1sZW5ndGggaGVhZGVyXG4gICAgY29uc3QgcmVzcG9uc2VTaXplID0gcmVzcG9uc2UuaGVhZGVycy5nZXQoJ2NvbnRlbnQtbGVuZ3RoJykgXG4gICAgICA/IHBhcnNlSW50KHJlc3BvbnNlLmhlYWRlcnMuZ2V0KCdjb250ZW50LWxlbmd0aCcpISwgMTApXG4gICAgICA6IHVuZGVmaW5lZDtcblxuICAgIC8vIEZpbmlzaCB0ZWxlbWV0cnkgdHJhY2tpbmdcbiAgICBodHRwVGVsZW1ldHJ5LmZpbmlzaFJlcXVlc3QoXG4gICAgICByZXF1ZXN0SWQsXG4gICAgICByZXNwb25zZS5zdGF0dXMsXG4gICAgICB1bmRlZmluZWQsXG4gICAgICByZXNwb25zZVNpemUsXG4gICAgICByZXF1ZXN0U2l6ZVxuICAgICk7XG5cbiAgICBpZiAoIWlzVGVzdCkge1xuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICBgJHtsb2dQcmVmaXh9JHtzcGFuSW5mb30gUmVzcG9uc2U6YCxcbiAgICAgICAgZmluYWxVcmwsXG4gICAgICAgIGBTdGF0dXM6ICR7cmVzcG9uc2Uuc3RhdHVzfWAsXG4gICAgICAgIGBEdXJhdGlvbjogJHt0ZWxlbWV0cnkuZHVyYXRpb24/LnRvRml4ZWQoMSl9bXNgLFxuICAgICAgICByZXNwb25zZVNpemUgPyBgU2l6ZTogJHtyZXNwb25zZVNpemV9YmAgOiAnJ1xuICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzcG9uc2U7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlID0gZXJyb3IgaW5zdGFuY2VvZiBFcnJvciA/IGVycm9yLm1lc3NhZ2UgOiBTdHJpbmcoZXJyb3IpO1xuICAgIFxuICAgIC8vIEZpbmlzaCB0ZWxlbWV0cnkgdHJhY2tpbmcgd2l0aCBlcnJvclxuICAgIGh0dHBUZWxlbWV0cnkuZmluaXNoUmVxdWVzdChcbiAgICAgIHJlcXVlc3RJZCxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICAgIGVycm9yTWVzc2FnZSxcbiAgICAgIHVuZGVmaW5lZCxcbiAgICAgIHJlcXVlc3RTaXplXG4gICAgKTtcblxuICAgIC8vIFN1cHByZXNzIFwiRmFpbGVkIHRvIGZldGNoXCIgZXJyb3JzIHRvIGF2b2lkIGNvbnNvbGUgbm9pc2Ugd2hlbiBiYWNrZW5kIHVuYXZhaWxhYmxlXG4gICAgaWYgKCFpc1Rlc3QpIHtcbiAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yICYmIGVycm9yLm1lc3NhZ2UuaW5jbHVkZXMoJ0ZhaWxlZCB0byBmZXRjaCcpKSB7XG4gICAgICAgIC8vIE9ubHkgbG9nIGFzIHdhcm5pbmcgaW5zdGVhZCBvZiBlcnJvciB0byByZWR1Y2UgY29uc29sZSBub2lzZVxuICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYCR7bG9nUHJlZml4fSR7c3BhbkluZm99IEJhY2tlbmQgdW5hdmFpbGFibGU6YCxcbiAgICAgICAgICBmaW5hbFVybCxcbiAgICAgICAgICBgRHVyYXRpb246ICR7dGVsZW1ldHJ5LmR1cmF0aW9uPy50b0ZpeGVkKDEpfW1zYFxuICAgICAgICApO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICAgICAgY29uc29sZS5lcnJvcihcbiAgICAgICAgICBgJHtsb2dQcmVmaXh9JHtzcGFuSW5mb30gRXJyb3I6YCxcbiAgICAgICAgICBmaW5hbFVybCxcbiAgICAgICAgICBlcnJvcixcbiAgICAgICAgICBgRHVyYXRpb246ICR7dGVsZW1ldHJ5LmR1cmF0aW9uPy50b0ZpeGVkKDEpfW1zYFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxufVxuXG4vLyBUZWxlbWV0cnkgYWNjZXNzIGZ1bmN0aW9ucyBmb3IgZGVidWdnaW5nIGFuZCBtb25pdG9yaW5nXG5leHBvcnQgZnVuY3Rpb24gZ2V0SHR0cFRlbGVtZXRyeVN0YXRzKCkge1xuICByZXR1cm4gaHR0cFRlbGVtZXRyeS5nZXRSZXF1ZXN0U3RhdHMoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEh0dHBSZXF1ZXN0SGlzdG9yeSgpIHtcbiAgcmV0dXJuIGh0dHBUZWxlbWV0cnkuZ2V0UmVxdWVzdEhpc3RvcnkoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEFjdGl2ZUh0dHBSZXF1ZXN0cygpIHtcbiAgcmV0dXJuIGh0dHBUZWxlbWV0cnkuZ2V0QWN0aXZlUmVxdWVzdHMoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGdldEh0dHBTcGFuU3VtbWFyeSgpIHtcbiAgcmV0dXJuIGh0dHBUZWxlbWV0cnkuZ2V0U3BhblN1bW1hcnkoKTtcbn1cblxuLy8gR2xvYmFsIHRlbGVtZXRyeSBhY2Nlc3MgZm9yIGRlYnVnZ2luZyBpbiBicm93c2VyIGNvbnNvbGVcbmlmICh0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJykge1xuICAod2luZG93IGFzIHVua25vd24gYXMge1xuICAgIGh0dHBUZWxlbWV0cnk6IHtcbiAgICAgIHN0YXRzOiAoKSA9PiBSZXR1cm5UeXBlPHR5cGVvZiBnZXRIdHRwVGVsZW1ldHJ5U3RhdHM+O1xuICAgICAgaGlzdG9yeTogKCkgPT4gUmVxdWVzdFRlbGVtZXRyeVtdO1xuICAgICAgYWN0aXZlOiAoKSA9PiBSZXF1ZXN0VGVsZW1ldHJ5W107XG4gICAgICBzcGFuczogKCkgPT4gUmV0dXJuVHlwZTx0eXBlb2YgZ2V0SHR0cFNwYW5TdW1tYXJ5PjtcbiAgICB9O1xuICB9KS5odHRwVGVsZW1ldHJ5ID0ge1xuICAgIHN0YXRzOiBnZXRIdHRwVGVsZW1ldHJ5U3RhdHMsXG4gICAgaGlzdG9yeTogZ2V0SHR0cFJlcXVlc3RIaXN0b3J5LFxuICAgIGFjdGl2ZTogZ2V0QWN0aXZlSHR0cFJlcXVlc3RzLFxuICAgIHNwYW5zOiBnZXRIdHRwU3BhblN1bW1hcnlcbiAgfTtcbn1c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