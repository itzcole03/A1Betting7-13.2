21574b8813cdabcfa7947263544964a5
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.__resetPerformanceGuardsForTests = __resetPerformanceGuardsForTests;
exports.getNavigationTiming = getNavigationTiming;
exports.initWebVitals = initWebVitals;
var _webVitals = require("web-vitals");
/*
 * Normalized performance metrics utilities (PR1 Performance Metrics Correction)
 * Provides:
 *  - Stable navigation timing (PerformanceNavigationTiming preferred)
 *  - Legacy fallback (performance.timing) with clamped non-negative values
 *  - Single initialization guard for Web Vitals collection
 *  - Consistent totalLoadTime calculation (duration) avoiding mixed time origins
 *  - Safe numeric coercion & validation helpers
 */

// Internal guard flags
let webVitalsInitialized = false;
let lcpRecorded = false; // ensure only first LCP forwarded

// Clamp helper ensuring non-negative finite numbers
function clampNonNegative(value) {
  if (value == null) return undefined;
  if (!Number.isFinite(value)) return undefined;
  return value < 0 ? 0 : value;
}
function getNavigationTiming() {
  try {
    // Prefer modern PerformanceNavigationTiming entries
    const navEntries = performance.getEntriesByType('navigation');
    if (navEntries && navEntries.length > 0) {
      const nav = navEntries[0];
      const totalLoadTime = clampNonNegative(nav.duration) ?? 0;
      const metrics = {
        startTime: nav.startTime,
        // should be 0 for navigation entries
        domContentLoaded: clampNonNegative(nav.domContentLoadedEventEnd - nav.startTime) ?? 0,
        firstPaint: undefined,
        // can be populated if paint entries queried outside
        firstContentfulPaint: undefined,
        totalLoadTime,
        type: nav.type,
        timestamp: Date.now(),
        source: 'navigation-timing'
      };
      return metrics;
    }

    // Legacy fallback using performance.timing (deprecated but still in some browsers)
    // Use indexed access to avoid any cast while acknowledging legacy API
    const perfObj = performance;
    const t = perfObj.timing;
    if (t) {
      const navigationStart = t.navigationStart || 0;
      const domContentLoaded = clampNonNegative(t.domContentLoadedEventEnd - navigationStart) ?? 0;
      const loadEventEnd = clampNonNegative(t.loadEventEnd - navigationStart) ?? 0;
      const metrics = {
        startTime: 0,
        domContentLoaded,
        firstPaint: undefined,
        firstContentfulPaint: undefined,
        totalLoadTime: loadEventEnd,
        type: 'navigate',
        timestamp: Date.now(),
        source: 'legacy-timing'
      };
      return metrics;
    }
    return null;
  } catch {
    return null;
  }
}
// Initialize web vitals a single time; returns true on first init, false otherwise
function initWebVitals(options = {}) {
  if (webVitalsInitialized && !options.force) return false;
  webVitalsInitialized = true;
  if (options.force) {
    // allow tests to reset recording state
    lcpRecorded = false;
  }
  const emit = metric => {
    if (!options.onMetric) return;
    // Safely read navigation entries: mocked getEntriesByType may return undefined
    let navigationType = undefined;
    try {
      const entries = typeof performance.getEntriesByType === 'function' && performance.getEntriesByType('navigation') || [];
      if (Array.isArray(entries) && entries.length > 0 && entries[0] && entries[0].type) {
        navigationType = entries[0].type;
      }
    } catch (e) {
      // ignore and leave navigationType undefined
    }
    const record = {
      name: metric.name,
      value: clampNonNegative(metric.value) ?? 0,
      rating: metric.rating,
      delta: metric.delta,
      id: metric.id,
      navigationType,
      timestamp: Date.now()
    };
    if (record.name === 'LCP') {
      if (lcpRecorded) return; // swallow duplicates
      lcpRecorded = true;
    }
    options.onMetric(record);
  };

  // Register web-vitals listeners
  (0, _webVitals.onCLS)(emit);
  (0, _webVitals.onINP)(emit);
  (0, _webVitals.onLCP)(emit);
  (0, _webVitals.onFCP)(emit);
  (0, _webVitals.onTTFB)(emit);

  // Optional navigation metrics emission
  if (options.includeNavigationMetrics) {
    const nav = getNavigationTiming();
    if (nav && options.onMetric) {
      options.onMetric({
        name: 'navigation-total-load-time',
        value: nav.totalLoadTime,
        timestamp: nav.timestamp
      });
      options.onMetric({
        name: 'navigation-dom-content-loaded',
        value: nav.domContentLoaded,
        timestamp: nav.timestamp
      });
    }
  }
  return true;
}

// Exposed for tests to reset state safely
function __resetPerformanceGuardsForTests() {
  webVitalsInitialized = false;
  lcpRecorded = false;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfd2ViVml0YWxzIiwicmVxdWlyZSIsIndlYlZpdGFsc0luaXRpYWxpemVkIiwibGNwUmVjb3JkZWQiLCJjbGFtcE5vbk5lZ2F0aXZlIiwidmFsdWUiLCJ1bmRlZmluZWQiLCJOdW1iZXIiLCJpc0Zpbml0ZSIsImdldE5hdmlnYXRpb25UaW1pbmciLCJuYXZFbnRyaWVzIiwicGVyZm9ybWFuY2UiLCJnZXRFbnRyaWVzQnlUeXBlIiwibGVuZ3RoIiwibmF2IiwidG90YWxMb2FkVGltZSIsImR1cmF0aW9uIiwibWV0cmljcyIsInN0YXJ0VGltZSIsImRvbUNvbnRlbnRMb2FkZWQiLCJkb21Db250ZW50TG9hZGVkRXZlbnRFbmQiLCJmaXJzdFBhaW50IiwiZmlyc3RDb250ZW50ZnVsUGFpbnQiLCJ0eXBlIiwidGltZXN0YW1wIiwiRGF0ZSIsIm5vdyIsInNvdXJjZSIsInBlcmZPYmoiLCJ0IiwidGltaW5nIiwibmF2aWdhdGlvblN0YXJ0IiwibG9hZEV2ZW50RW5kIiwiaW5pdFdlYlZpdGFscyIsIm9wdGlvbnMiLCJmb3JjZSIsImVtaXQiLCJtZXRyaWMiLCJvbk1ldHJpYyIsIm5hdmlnYXRpb25UeXBlIiwiZW50cmllcyIsIkFycmF5IiwiaXNBcnJheSIsImUiLCJyZWNvcmQiLCJuYW1lIiwicmF0aW5nIiwiZGVsdGEiLCJpZCIsIm9uQ0xTIiwib25JTlAiLCJvbkxDUCIsIm9uRkNQIiwib25UVEZCIiwiaW5jbHVkZU5hdmlnYXRpb25NZXRyaWNzIiwiX19yZXNldFBlcmZvcm1hbmNlR3VhcmRzRm9yVGVzdHMiXSwic291cmNlcyI6WyJwZXJmb3JtYW5jZU1ldHJpY3MudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLypcclxuICogTm9ybWFsaXplZCBwZXJmb3JtYW5jZSBtZXRyaWNzIHV0aWxpdGllcyAoUFIxIFBlcmZvcm1hbmNlIE1ldHJpY3MgQ29ycmVjdGlvbilcclxuICogUHJvdmlkZXM6XHJcbiAqICAtIFN0YWJsZSBuYXZpZ2F0aW9uIHRpbWluZyAoUGVyZm9ybWFuY2VOYXZpZ2F0aW9uVGltaW5nIHByZWZlcnJlZClcclxuICogIC0gTGVnYWN5IGZhbGxiYWNrIChwZXJmb3JtYW5jZS50aW1pbmcpIHdpdGggY2xhbXBlZCBub24tbmVnYXRpdmUgdmFsdWVzXHJcbiAqICAtIFNpbmdsZSBpbml0aWFsaXphdGlvbiBndWFyZCBmb3IgV2ViIFZpdGFscyBjb2xsZWN0aW9uXHJcbiAqICAtIENvbnNpc3RlbnQgdG90YWxMb2FkVGltZSBjYWxjdWxhdGlvbiAoZHVyYXRpb24pIGF2b2lkaW5nIG1peGVkIHRpbWUgb3JpZ2luc1xyXG4gKiAgLSBTYWZlIG51bWVyaWMgY29lcmNpb24gJiB2YWxpZGF0aW9uIGhlbHBlcnNcclxuICovXHJcblxyXG5pbXBvcnQgeyBvbkNMUywgb25JTlAsIG9uTENQLCBvbkZDUCwgb25UVEZCIH0gZnJvbSAnd2ViLXZpdGFscyc7XHJcblxyXG5leHBvcnQgaW50ZXJmYWNlIE5hdmlnYXRpb25UaW1pbmdNZXRyaWNzIHtcclxuICBzdGFydFRpbWU6IG51bWJlcjsgICAgICAgICAgLy8gbmF2aWdhdGlvblN0YXJ0XHJcbiAgZG9tQ29udGVudExvYWRlZDogbnVtYmVyOyAgIC8vIERPTUNvbnRlbnRMb2FkZWRFdmVudEVuZCAtIG5hdmlnYXRpb25TdGFydFxyXG4gIGZpcnN0UGFpbnQ/OiBudW1iZXI7ICAgICAgICAvLyBGaXJzdCBQYWludCBpZiBhdmFpbGFibGVcclxuICBmaXJzdENvbnRlbnRmdWxQYWludD86IG51bWJlcjsgLy8gRkNQIGlmIGF2YWlsYWJsZSAoY2FwdHVyZWQgc2VwYXJhdGVseSB0b28pXHJcbiAgdG90YWxMb2FkVGltZTogbnVtYmVyOyAgICAgIC8vIGR1cmF0aW9uIG9yIGxvYWRFdmVudEVuZCAtIG5hdmlnYXRpb25TdGFydFxyXG4gIHR5cGU6IHN0cmluZzsgICAgICAgICAgICAgICAvLyBuYXZpZ2F0aW9uIHR5cGUgKHJlbG9hZCwgbmF2aWdhdGUsIGV0Yy4pXHJcbiAgdGltZXN0YW1wOiBudW1iZXI7ICAgICAgICAgIC8vIGVwb2NoIG1zIGNhcHR1cmVkIHRpbWVcclxuICBzb3VyY2U6ICduYXZpZ2F0aW9uLXRpbWluZycgfCAnbGVnYWN5LXRpbWluZyc7XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgV2ViVml0YWxNZXRyaWNSZWNvcmQge1xyXG4gIG5hbWU6IHN0cmluZztcclxuICB2YWx1ZTogbnVtYmVyO1xyXG4gIHJhdGluZz86IHN0cmluZztcclxuICBkZWx0YT86IG51bWJlcjtcclxuICBpZD86IHN0cmluZztcclxuICBuYXZpZ2F0aW9uVHlwZT86IHN0cmluZztcclxuICB0aW1lc3RhbXA6IG51bWJlcjtcclxufVxyXG5cclxuLy8gSW50ZXJuYWwgZ3VhcmQgZmxhZ3NcclxubGV0IHdlYlZpdGFsc0luaXRpYWxpemVkID0gZmFsc2U7XHJcbmxldCBsY3BSZWNvcmRlZCA9IGZhbHNlOyAvLyBlbnN1cmUgb25seSBmaXJzdCBMQ1AgZm9yd2FyZGVkXHJcblxyXG4vLyBDbGFtcCBoZWxwZXIgZW5zdXJpbmcgbm9uLW5lZ2F0aXZlIGZpbml0ZSBudW1iZXJzXHJcbmZ1bmN0aW9uIGNsYW1wTm9uTmVnYXRpdmUodmFsdWU6IG51bWJlciB8IHVuZGVmaW5lZCB8IG51bGwpOiBudW1iZXIgfCB1bmRlZmluZWQge1xyXG4gIGlmICh2YWx1ZSA9PSBudWxsKSByZXR1cm4gdW5kZWZpbmVkO1xyXG4gIGlmICghTnVtYmVyLmlzRmluaXRlKHZhbHVlKSkgcmV0dXJuIHVuZGVmaW5lZDtcclxuICByZXR1cm4gdmFsdWUgPCAwID8gMCA6IHZhbHVlO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0TmF2aWdhdGlvblRpbWluZygpOiBOYXZpZ2F0aW9uVGltaW5nTWV0cmljcyB8IG51bGwge1xyXG4gIHRyeSB7XHJcbiAgICAvLyBQcmVmZXIgbW9kZXJuIFBlcmZvcm1hbmNlTmF2aWdhdGlvblRpbWluZyBlbnRyaWVzXHJcbiAgICBjb25zdCBuYXZFbnRyaWVzID0gcGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZSgnbmF2aWdhdGlvbicpIGFzIFBlcmZvcm1hbmNlTmF2aWdhdGlvblRpbWluZ1tdO1xyXG4gICAgaWYgKG5hdkVudHJpZXMgJiYgbmF2RW50cmllcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgIGNvbnN0IG5hdiA9IG5hdkVudHJpZXNbMF07XHJcbiAgICAgIGNvbnN0IHRvdGFsTG9hZFRpbWUgPSBjbGFtcE5vbk5lZ2F0aXZlKG5hdi5kdXJhdGlvbikgPz8gMDtcclxuICAgICAgY29uc3QgbWV0cmljczogTmF2aWdhdGlvblRpbWluZ01ldHJpY3MgPSB7XHJcbiAgICAgICAgc3RhcnRUaW1lOiBuYXYuc3RhcnRUaW1lLCAvLyBzaG91bGQgYmUgMCBmb3IgbmF2aWdhdGlvbiBlbnRyaWVzXHJcbiAgICAgICAgZG9tQ29udGVudExvYWRlZDogY2xhbXBOb25OZWdhdGl2ZShuYXYuZG9tQ29udGVudExvYWRlZEV2ZW50RW5kIC0gbmF2LnN0YXJ0VGltZSkgPz8gMCxcclxuICAgICAgICBmaXJzdFBhaW50OiB1bmRlZmluZWQsIC8vIGNhbiBiZSBwb3B1bGF0ZWQgaWYgcGFpbnQgZW50cmllcyBxdWVyaWVkIG91dHNpZGVcclxuICAgICAgICBmaXJzdENvbnRlbnRmdWxQYWludDogdW5kZWZpbmVkLFxyXG4gICAgICAgIHRvdGFsTG9hZFRpbWUsXHJcbiAgICAgICAgdHlwZTogbmF2LnR5cGUsXHJcbiAgICAgICAgdGltZXN0YW1wOiBEYXRlLm5vdygpLFxyXG4gICAgICAgIHNvdXJjZTogJ25hdmlnYXRpb24tdGltaW5nJ1xyXG4gICAgICB9O1xyXG4gICAgICByZXR1cm4gbWV0cmljcztcclxuICAgIH1cclxuXHJcbiAgICAvLyBMZWdhY3kgZmFsbGJhY2sgdXNpbmcgcGVyZm9ybWFuY2UudGltaW5nIChkZXByZWNhdGVkIGJ1dCBzdGlsbCBpbiBzb21lIGJyb3dzZXJzKVxyXG4gIC8vIFVzZSBpbmRleGVkIGFjY2VzcyB0byBhdm9pZCBhbnkgY2FzdCB3aGlsZSBhY2tub3dsZWRnaW5nIGxlZ2FjeSBBUElcclxuICBjb25zdCBwZXJmT2JqOiBQZXJmb3JtYW5jZSAmIHsgdGltaW5nPzogUGVyZm9ybWFuY2VUaW1pbmcgfSA9IHBlcmZvcm1hbmNlIGFzIFBlcmZvcm1hbmNlICYgeyB0aW1pbmc/OiBQZXJmb3JtYW5jZVRpbWluZyB9O1xyXG4gIGNvbnN0IHQgPSBwZXJmT2JqLnRpbWluZztcclxuICAgIGlmICh0KSB7XHJcbiAgICAgIGNvbnN0IG5hdmlnYXRpb25TdGFydCA9IHQubmF2aWdhdGlvblN0YXJ0IHx8IDA7XHJcbiAgICAgIGNvbnN0IGRvbUNvbnRlbnRMb2FkZWQgPSBjbGFtcE5vbk5lZ2F0aXZlKHQuZG9tQ29udGVudExvYWRlZEV2ZW50RW5kIC0gbmF2aWdhdGlvblN0YXJ0KSA/PyAwO1xyXG4gICAgICBjb25zdCBsb2FkRXZlbnRFbmQgPSBjbGFtcE5vbk5lZ2F0aXZlKHQubG9hZEV2ZW50RW5kIC0gbmF2aWdhdGlvblN0YXJ0KSA/PyAwO1xyXG4gICAgICBjb25zdCBtZXRyaWNzOiBOYXZpZ2F0aW9uVGltaW5nTWV0cmljcyA9IHtcclxuICAgICAgICBzdGFydFRpbWU6IDAsXHJcbiAgICAgICAgZG9tQ29udGVudExvYWRlZCxcclxuICAgICAgICBmaXJzdFBhaW50OiB1bmRlZmluZWQsXHJcbiAgICAgICAgZmlyc3RDb250ZW50ZnVsUGFpbnQ6IHVuZGVmaW5lZCxcclxuICAgICAgICB0b3RhbExvYWRUaW1lOiBsb2FkRXZlbnRFbmQsXHJcbiAgICAgICAgdHlwZTogJ25hdmlnYXRlJyxcclxuICAgICAgICB0aW1lc3RhbXA6IERhdGUubm93KCksXHJcbiAgICAgICAgc291cmNlOiAnbGVnYWN5LXRpbWluZydcclxuICAgICAgfTtcclxuICAgICAgcmV0dXJuIG1ldHJpY3M7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIG51bGw7XHJcbiAgfSBjYXRjaCB7XHJcbiAgICByZXR1cm4gbnVsbDtcclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgSW5pdFdlYlZpdGFsc09wdGlvbnMge1xyXG4gIG9uTWV0cmljPzogKG1ldHJpYzogV2ViVml0YWxNZXRyaWNSZWNvcmQpID0+IHZvaWQ7XHJcbiAgaW5jbHVkZU5hdmlnYXRpb25NZXRyaWNzPzogYm9vbGVhbjtcclxuICAvLyBPcHRpb25hbGx5IGZvcmNlIHJlLWluaXQgKGZvciB0ZXN0cykgYnV0IGRlZmF1bHQgaXMgZmFsc2UgaW4gcHJvZFxyXG4gIGZvcmNlPzogYm9vbGVhbjtcclxufVxyXG5cclxuLy8gSW5pdGlhbGl6ZSB3ZWIgdml0YWxzIGEgc2luZ2xlIHRpbWU7IHJldHVybnMgdHJ1ZSBvbiBmaXJzdCBpbml0LCBmYWxzZSBvdGhlcndpc2VcclxuZXhwb3J0IGZ1bmN0aW9uIGluaXRXZWJWaXRhbHMob3B0aW9uczogSW5pdFdlYlZpdGFsc09wdGlvbnMgPSB7fSk6IGJvb2xlYW4ge1xyXG4gIGlmICh3ZWJWaXRhbHNJbml0aWFsaXplZCAmJiAhb3B0aW9ucy5mb3JjZSkgcmV0dXJuIGZhbHNlO1xyXG4gIHdlYlZpdGFsc0luaXRpYWxpemVkID0gdHJ1ZTtcclxuICBpZiAob3B0aW9ucy5mb3JjZSkge1xyXG4gICAgLy8gYWxsb3cgdGVzdHMgdG8gcmVzZXQgcmVjb3JkaW5nIHN0YXRlXHJcbiAgICBsY3BSZWNvcmRlZCA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgaW50ZXJmYWNlIENvcmVXZWJWaXRhbE1ldHJpYyB7XHJcbiAgICBuYW1lOiBzdHJpbmc7XHJcbiAgICB2YWx1ZTogbnVtYmVyO1xyXG4gICAgcmF0aW5nPzogc3RyaW5nO1xyXG4gICAgZGVsdGE/OiBudW1iZXI7XHJcbiAgICBpZD86IHN0cmluZztcclxuICB9XHJcbiAgY29uc3QgZW1pdCA9IChtZXRyaWM6IENvcmVXZWJWaXRhbE1ldHJpYykgPT4ge1xyXG4gICAgaWYgKCFvcHRpb25zLm9uTWV0cmljKSByZXR1cm47XHJcbiAgICAvLyBTYWZlbHkgcmVhZCBuYXZpZ2F0aW9uIGVudHJpZXM6IG1vY2tlZCBnZXRFbnRyaWVzQnlUeXBlIG1heSByZXR1cm4gdW5kZWZpbmVkXHJcbiAgICBsZXQgbmF2aWdhdGlvblR5cGU6IHN0cmluZyB8IHVuZGVmaW5lZCA9IHVuZGVmaW5lZDtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGVudHJpZXMgPSAodHlwZW9mIHBlcmZvcm1hbmNlLmdldEVudHJpZXNCeVR5cGUgPT09ICdmdW5jdGlvbicgJiYgcGVyZm9ybWFuY2UuZ2V0RW50cmllc0J5VHlwZSgnbmF2aWdhdGlvbicpKSB8fCBbXTtcclxuICAgICAgaWYgKEFycmF5LmlzQXJyYXkoZW50cmllcykgJiYgZW50cmllcy5sZW5ndGggPiAwICYmIGVudHJpZXNbMF0gJiYgKGVudHJpZXNbMF0gYXMgYW55KS50eXBlKSB7XHJcbiAgICAgICAgbmF2aWdhdGlvblR5cGUgPSAoZW50cmllc1swXSBhcyBhbnkpLnR5cGU7XHJcbiAgICAgIH1cclxuICAgIH0gY2F0Y2ggKGUpIHtcclxuICAgICAgLy8gaWdub3JlIGFuZCBsZWF2ZSBuYXZpZ2F0aW9uVHlwZSB1bmRlZmluZWRcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZWNvcmQ6IFdlYlZpdGFsTWV0cmljUmVjb3JkID0ge1xyXG4gICAgICBuYW1lOiBtZXRyaWMubmFtZSxcclxuICAgICAgdmFsdWU6IGNsYW1wTm9uTmVnYXRpdmUobWV0cmljLnZhbHVlKSA/PyAwLFxyXG4gICAgICByYXRpbmc6IG1ldHJpYy5yYXRpbmcsXHJcbiAgICAgIGRlbHRhOiBtZXRyaWMuZGVsdGEsXHJcbiAgICAgIGlkOiBtZXRyaWMuaWQsXHJcbiAgICAgIG5hdmlnYXRpb25UeXBlLFxyXG4gICAgICB0aW1lc3RhbXA6IERhdGUubm93KClcclxuICAgIH07XHJcblxyXG4gICAgaWYgKHJlY29yZC5uYW1lID09PSAnTENQJykge1xyXG4gICAgICBpZiAobGNwUmVjb3JkZWQpIHJldHVybjsgLy8gc3dhbGxvdyBkdXBsaWNhdGVzXHJcbiAgICAgIGxjcFJlY29yZGVkID0gdHJ1ZTtcclxuICAgIH1cclxuXHJcbiAgICBvcHRpb25zLm9uTWV0cmljKHJlY29yZCk7XHJcbiAgfTtcclxuXHJcbiAgLy8gUmVnaXN0ZXIgd2ViLXZpdGFscyBsaXN0ZW5lcnNcclxuICBvbkNMUyhlbWl0KTtcclxuICBvbklOUChlbWl0KTtcclxuICBvbkxDUChlbWl0KTtcclxuICBvbkZDUChlbWl0KTtcclxuICBvblRURkIoZW1pdCk7XHJcblxyXG4gIC8vIE9wdGlvbmFsIG5hdmlnYXRpb24gbWV0cmljcyBlbWlzc2lvblxyXG4gIGlmIChvcHRpb25zLmluY2x1ZGVOYXZpZ2F0aW9uTWV0cmljcykge1xyXG4gICAgY29uc3QgbmF2ID0gZ2V0TmF2aWdhdGlvblRpbWluZygpO1xyXG4gICAgaWYgKG5hdiAmJiBvcHRpb25zLm9uTWV0cmljKSB7XHJcbiAgICAgIG9wdGlvbnMub25NZXRyaWMoe1xyXG4gICAgICAgIG5hbWU6ICduYXZpZ2F0aW9uLXRvdGFsLWxvYWQtdGltZScsXHJcbiAgICAgICAgdmFsdWU6IG5hdi50b3RhbExvYWRUaW1lLFxyXG4gICAgICAgIHRpbWVzdGFtcDogbmF2LnRpbWVzdGFtcFxyXG4gICAgICB9KTtcclxuICAgICAgb3B0aW9ucy5vbk1ldHJpYyh7XHJcbiAgICAgICAgbmFtZTogJ25hdmlnYXRpb24tZG9tLWNvbnRlbnQtbG9hZGVkJyxcclxuICAgICAgICB2YWx1ZTogbmF2LmRvbUNvbnRlbnRMb2FkZWQsXHJcbiAgICAgICAgdGltZXN0YW1wOiBuYXYudGltZXN0YW1wXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcmV0dXJuIHRydWU7XHJcbn1cclxuXHJcbi8vIEV4cG9zZWQgZm9yIHRlc3RzIHRvIHJlc2V0IHN0YXRlIHNhZmVseVxyXG5leHBvcnQgZnVuY3Rpb24gX19yZXNldFBlcmZvcm1hbmNlR3VhcmRzRm9yVGVzdHMoKTogdm9pZCB7XHJcbiAgd2ViVml0YWxzSW5pdGlhbGl6ZWQgPSBmYWxzZTtcclxuICBsY3BSZWNvcmRlZCA9IGZhbHNlO1xyXG59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