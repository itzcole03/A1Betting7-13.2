9d2da710abfd24aa98f132049050904d
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = exports.UnifiedErrorService = exports.ErrorSeverity = exports.ErrorCategory = void 0;
var _BaseService = require("./BaseService");
var _UnifiedErrorService;
let ErrorSeverity = exports.ErrorSeverity = /*#__PURE__*/function (ErrorSeverity) {
  ErrorSeverity["LOW"] = "low";
  ErrorSeverity["MEDIUM"] = "medium";
  ErrorSeverity["HIGH"] = "high";
  ErrorSeverity["CRITICAL"] = "critical";
  return ErrorSeverity;
}({});
let ErrorCategory = exports.ErrorCategory = /*#__PURE__*/function (ErrorCategory) {
  ErrorCategory["NETWORK"] = "network";
  ErrorCategory["VALIDATION"] = "validation";
  ErrorCategory["AUTHENTICATION"] = "authentication";
  ErrorCategory["PERMISSION"] = "permission";
  ErrorCategory["BUSINESS_LOGIC"] = "business_logic";
  ErrorCategory["SYSTEM"] = "system";
  ErrorCategory["UNKNOWN"] = "unknown";
  return ErrorCategory;
}({});
class UnifiedErrorService extends _BaseService.BaseService {
  // milliseconds

  constructor() {
    // @ts-expect-error TS(2554): Expected 2 arguments, but got 1. BaseService expects two arguments, but only one is provided here for singleton pattern compatibility.
    super('UnifiedErrorService');
    this.errors = new Map();
    this.errorCounter = 0;
    this.maxRetries = 3;
    this.retryDelays = [1000, 2000, 5000];
  }
  static getInstance() {
    if (!UnifiedErrorService.instance) {
      UnifiedErrorService.instance = new UnifiedErrorService();
    }
    return UnifiedErrorService.instance;
  }
  reportError(error, context = {}, category = ErrorCategory.UNKNOWN, severity = ErrorSeverity.MEDIUM) {
    const _errorId = `error_${++this.errorCounter}_${Date.now()}`;

    // Properly serialize error and context objects
    let errorMessage = '';
    let errorCode = 'UNKNOWN_ERROR';
    let errorStack = '';
    if (typeof error === 'string') {
      errorMessage = error;
    } else if (error instanceof Error) {
      errorMessage = error.message;
      errorCode = error.name || 'Error';
      errorStack = error.stack || '';
    } else if (error && typeof error === 'object') {
      errorMessage = JSON.stringify(error);
      errorCode = error.code || error.name || 'ObjectError';
    } else {
      errorMessage = String(error);
    }

    // Serialize context safely
    let serializedContext = {};
    try {
      serializedContext = typeof context === 'object' && context !== null ? JSON.parse(JSON.stringify(context)) : context;
    } catch (serializationError) {
      serializedContext = {
        error: 'Failed to serialize context',
        original: String(context)
      };
    }
    const _errorDetails = {
      id: _errorId,
      message: errorMessage,
      code: errorCode,
      category,
      severity,
      context: serializedContext,
      timestamp: new Date(),
      stack: errorStack,
      resolved: false,
      retryCount: 0
    };
    this.errors.set(_errorId, _errorDetails);

    // Log with properly serialized data
    // Production console statements disabled for lint compliance
    // console.error('[UnifiedErrorService] Error reported:', {
    //   id: _errorId,
    //   message: errorMessage,
    //   code: errorCode,
    //   category,
    //   severity,
    //   context: serializedContext,
    //   timestamp: _errorDetails.timestamp.toISOString()
    // });

    this.logger.error('Error reported', _errorDetails);
    this.emit('error_reported', _errorDetails);

    // Auto-resolve low severity errors after some time
    if (severity === ErrorSeverity.LOW) {
      setTimeout(() => this.resolveError(_errorId), 60000); // 1 minute
    }

    // Notify if critical
    if (severity === ErrorSeverity.CRITICAL) {
      this.emit('critical_error', _errorDetails);
    }
    return _errorId;
  }
  async retryOperation(operation, context = {}, category = ErrorCategory.NETWORK) {
    let lastError = null;
    for (let _attempt = 0; _attempt <= this.maxRetries; _attempt++) {
      try {
        if (_attempt > 0) {
          const _delay = this.retryDelays[Math.min(_attempt - 1, this.retryDelays.length - 1)];
          await this.delay(_delay);
          this.logger.info('Retrying operation', {
            attempt: _attempt,
            delay: _delay,
            context
          });
        }
        return await operation();
      } catch (error) {
        lastError = error;
        if (_attempt === this.maxRetries) {
          // Final attempt failed
          const _errorId = this.reportError(lastError, {
            ...context,
            totalAttempts: _attempt + 1
          }, category, ErrorSeverity.HIGH);
          throw new Error(`Operation failed after ${_attempt + 1} attempts. Error ID: ${_errorId}`);
        }
      }
    }
    throw lastError;
  }
  resolveError(errorId, resolution) {
    const _error = this.errors.get(errorId);
    if (!_error) {
      this.logger.warn('Attempted to resolve non-existent error', {
        errorId
      });
      return false;
    }
    _error.resolved = true;
    _error.context.resolution = resolution;
    _error.context.resolvedAt = new Date();
    this.logger.info('Error resolved', {
      errorId,
      resolution
    });
    this.emit('error_resolved', _error);
    return true;
  }
  getError(errorId) {
    return this.errors.get(errorId) || null;
  }
  getErrors(filters = {}) {
    const _allErrors = Array.from(this.errors.values());
    return _allErrors.filter(error => {
      if (filters.category && error.category !== filters.category) return false;
      if (filters.severity && error.severity !== filters.severity) return false;
      if (filters.resolved !== undefined && error.resolved !== filters.resolved) return false;
      if (filters.since && error.timestamp < filters.since) return false;
      return true;
    });
  }
  getErrorStats() {
    const _errors = Array.from(this.errors.values());
    const _stats = {
      total: _errors.length,
      resolved: _errors.filter(e => e.resolved).length,
      byCategory: {},
      bySeverity: {}
    };

    // Initialize counts
    Object.values(ErrorCategory).forEach(cat => _stats.byCategory[cat] = 0);
    Object.values(ErrorSeverity).forEach(sev => _stats.bySeverity[sev] = 0);

    // Count errors
    _errors.forEach(error => {
      _stats.byCategory[error.category]++;
      _stats.bySeverity[error.severity]++;
    });
    return _stats;
  }
  clearErrors(olderThan) {
    let _cleared = 0;
    for (const [id, error] of this.errors.entries()) {
      if (!olderThan || error.timestamp < olderThan) {
        if (error.resolved || error.severity === ErrorSeverity.LOW) {
          this.errors.delete(id);
          _cleared++;
        }
      }
    }
    this.logger.info('Errors cleared', {
      cleared: _cleared,
      olderThan
    });
    return _cleared;
  }
  delay(ms) {
    return new Promise(resolve => setTimeout(resolve, ms));
  }

  // Helper methods for common error categories
  reportNetworkError(error, context = {}) {
    return this.reportError(error, context, ErrorCategory.NETWORK, ErrorSeverity.MEDIUM);
  }
  reportValidationError(message, context = {}) {
    return this.reportError(message, context, ErrorCategory.VALIDATION, ErrorSeverity.LOW);
  }
  reportAuthError(error, context = {}) {
    return this.reportError(error, context, ErrorCategory.AUTHENTICATION, ErrorSeverity.HIGH);
  }
  reportCriticalError(error, context = {}) {
    return this.reportError(error, context, ErrorCategory.SYSTEM, ErrorSeverity.CRITICAL);
  }
}
exports.UnifiedErrorService = UnifiedErrorService;
_UnifiedErrorService = UnifiedErrorService;
UnifiedErrorService.instance = void 0;
var _default = exports.default = UnifiedErrorService;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfQmFzZVNlcnZpY2UiLCJyZXF1aXJlIiwiX1VuaWZpZWRFcnJvclNlcnZpY2UiLCJFcnJvclNldmVyaXR5IiwiZXhwb3J0cyIsIkVycm9yQ2F0ZWdvcnkiLCJVbmlmaWVkRXJyb3JTZXJ2aWNlIiwiQmFzZVNlcnZpY2UiLCJjb25zdHJ1Y3RvciIsImVycm9ycyIsIk1hcCIsImVycm9yQ291bnRlciIsIm1heFJldHJpZXMiLCJyZXRyeURlbGF5cyIsImdldEluc3RhbmNlIiwiaW5zdGFuY2UiLCJyZXBvcnRFcnJvciIsImVycm9yIiwiY29udGV4dCIsImNhdGVnb3J5IiwiVU5LTk9XTiIsInNldmVyaXR5IiwiTUVESVVNIiwiX2Vycm9ySWQiLCJEYXRlIiwibm93IiwiZXJyb3JNZXNzYWdlIiwiZXJyb3JDb2RlIiwiZXJyb3JTdGFjayIsIkVycm9yIiwibWVzc2FnZSIsIm5hbWUiLCJzdGFjayIsIkpTT04iLCJzdHJpbmdpZnkiLCJjb2RlIiwiU3RyaW5nIiwic2VyaWFsaXplZENvbnRleHQiLCJwYXJzZSIsInNlcmlhbGl6YXRpb25FcnJvciIsIm9yaWdpbmFsIiwiX2Vycm9yRGV0YWlscyIsImlkIiwidGltZXN0YW1wIiwicmVzb2x2ZWQiLCJyZXRyeUNvdW50Iiwic2V0IiwibG9nZ2VyIiwiZW1pdCIsIkxPVyIsInNldFRpbWVvdXQiLCJyZXNvbHZlRXJyb3IiLCJDUklUSUNBTCIsInJldHJ5T3BlcmF0aW9uIiwib3BlcmF0aW9uIiwiTkVUV09SSyIsImxhc3RFcnJvciIsIl9hdHRlbXB0IiwiX2RlbGF5IiwiTWF0aCIsIm1pbiIsImxlbmd0aCIsImRlbGF5IiwiaW5mbyIsImF0dGVtcHQiLCJ0b3RhbEF0dGVtcHRzIiwiSElHSCIsImVycm9ySWQiLCJyZXNvbHV0aW9uIiwiX2Vycm9yIiwiZ2V0Iiwid2FybiIsInJlc29sdmVkQXQiLCJnZXRFcnJvciIsImdldEVycm9ycyIsImZpbHRlcnMiLCJfYWxsRXJyb3JzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwiZmlsdGVyIiwidW5kZWZpbmVkIiwic2luY2UiLCJnZXRFcnJvclN0YXRzIiwiX2Vycm9ycyIsIl9zdGF0cyIsInRvdGFsIiwiZSIsImJ5Q2F0ZWdvcnkiLCJieVNldmVyaXR5IiwiT2JqZWN0IiwiZm9yRWFjaCIsImNhdCIsInNldiIsImNsZWFyRXJyb3JzIiwib2xkZXJUaGFuIiwiX2NsZWFyZWQiLCJlbnRyaWVzIiwiZGVsZXRlIiwiY2xlYXJlZCIsIm1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZXBvcnROZXR3b3JrRXJyb3IiLCJyZXBvcnRWYWxpZGF0aW9uRXJyb3IiLCJWQUxJREFUSU9OIiwicmVwb3J0QXV0aEVycm9yIiwiQVVUSEVOVElDQVRJT04iLCJyZXBvcnRDcml0aWNhbEVycm9yIiwiU1lTVEVNIiwiX2RlZmF1bHQiLCJkZWZhdWx0Il0sInNvdXJjZXMiOlsiVW5pZmllZEVycm9yU2VydmljZS50cyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCYXNlU2VydmljZSB9IGZyb20gJy4vQmFzZVNlcnZpY2UnO1xyXG5cclxuZXhwb3J0IGVudW0gRXJyb3JTZXZlcml0eSB7XHJcbiAgTE9XID0gJ2xvdycsXHJcbiAgTUVESVVNID0gJ21lZGl1bScsXHJcbiAgSElHSCA9ICdoaWdoJyxcclxuICBDUklUSUNBTCA9ICdjcml0aWNhbCcsXHJcbn1cclxuXHJcbmV4cG9ydCBlbnVtIEVycm9yQ2F0ZWdvcnkge1xyXG4gIE5FVFdPUksgPSAnbmV0d29yaycsXHJcbiAgVkFMSURBVElPTiA9ICd2YWxpZGF0aW9uJyxcclxuICBBVVRIRU5USUNBVElPTiA9ICdhdXRoZW50aWNhdGlvbicsXHJcbiAgUEVSTUlTU0lPTiA9ICdwZXJtaXNzaW9uJyxcclxuICBCVVNJTkVTU19MT0dJQyA9ICdidXNpbmVzc19sb2dpYycsXHJcbiAgU1lTVEVNID0gJ3N5c3RlbScsXHJcbiAgVU5LTk9XTiA9ICd1bmtub3duJyxcclxufVxyXG5cclxuZXhwb3J0IGludGVyZmFjZSBFcnJvckRldGFpbHMge1xyXG4gIGlkOiBzdHJpbmc7XHJcbiAgbWVzc2FnZTogc3RyaW5nO1xyXG4gIGNvZGU/OiBzdHJpbmc7XHJcbiAgY2F0ZWdvcnk6IEVycm9yQ2F0ZWdvcnk7XHJcbiAgc2V2ZXJpdHk6IEVycm9yU2V2ZXJpdHk7XHJcbiAgY29udGV4dDogdW5rbm93bjtcclxuICB0aW1lc3RhbXA6IERhdGU7XHJcbiAgc3RhY2s/OiBzdHJpbmc7XHJcbiAgcmVzb2x2ZWQ6IGJvb2xlYW47XHJcbiAgcmV0cnlDb3VudDogbnVtYmVyO1xyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgVW5pZmllZEVycm9yU2VydmljZSBleHRlbmRzIEJhc2VTZXJ2aWNlIHtcclxuICBwcml2YXRlIHN0YXRpYyBpbnN0YW5jZTogVW5pZmllZEVycm9yU2VydmljZTtcclxuICBwcml2YXRlIGVycm9yczogTWFwPHN0cmluZywgRXJyb3JEZXRhaWxzPiA9IG5ldyBNYXAoKTtcclxuICBwcml2YXRlIGVycm9yQ291bnRlciA9IDA7XHJcbiAgcHJpdmF0ZSBtYXhSZXRyaWVzID0gMztcclxuICBwcml2YXRlIHJldHJ5RGVsYXlzID0gWzEwMDAsIDIwMDAsIDUwMDBdOyAvLyBtaWxsaXNlY29uZHNcclxuXHJcbiAgcHJvdGVjdGVkIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgLy8gQHRzLWV4cGVjdC1lcnJvciBUUygyNTU0KTogRXhwZWN0ZWQgMiBhcmd1bWVudHMsIGJ1dCBnb3QgMS4gQmFzZVNlcnZpY2UgZXhwZWN0cyB0d28gYXJndW1lbnRzLCBidXQgb25seSBvbmUgaXMgcHJvdmlkZWQgaGVyZSBmb3Igc2luZ2xldG9uIHBhdHRlcm4gY29tcGF0aWJpbGl0eS5cclxuICAgIHN1cGVyKCdVbmlmaWVkRXJyb3JTZXJ2aWNlJyk7XHJcbiAgfVxyXG5cclxuICBzdGF0aWMgZ2V0SW5zdGFuY2UoKTogVW5pZmllZEVycm9yU2VydmljZSB7XHJcbiAgICBpZiAoIVVuaWZpZWRFcnJvclNlcnZpY2UuaW5zdGFuY2UpIHtcclxuICAgICAgVW5pZmllZEVycm9yU2VydmljZS5pbnN0YW5jZSA9IG5ldyBVbmlmaWVkRXJyb3JTZXJ2aWNlKCk7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gVW5pZmllZEVycm9yU2VydmljZS5pbnN0YW5jZTtcclxuICB9XHJcblxyXG4gIHJlcG9ydEVycm9yKFxyXG4gICAgZXJyb3I6IEVycm9yIHwgc3RyaW5nLFxyXG4gICAgY29udGV4dDogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9LFxyXG4gICAgY2F0ZWdvcnk6IEVycm9yQ2F0ZWdvcnkgPSBFcnJvckNhdGVnb3J5LlVOS05PV04sXHJcbiAgICBzZXZlcml0eTogRXJyb3JTZXZlcml0eSA9IEVycm9yU2V2ZXJpdHkuTUVESVVNXHJcbiAgKTogc3RyaW5nIHtcclxuICAgIGNvbnN0IF9lcnJvcklkID0gYGVycm9yXyR7Kyt0aGlzLmVycm9yQ291bnRlcn1fJHtEYXRlLm5vdygpfWA7XHJcblxyXG4gICAgLy8gUHJvcGVybHkgc2VyaWFsaXplIGVycm9yIGFuZCBjb250ZXh0IG9iamVjdHNcclxuICAgIGxldCBlcnJvck1lc3NhZ2UgPSAnJztcclxuICAgIGxldCBlcnJvckNvZGUgPSAnVU5LTk9XTl9FUlJPUic7XHJcbiAgICBsZXQgZXJyb3JTdGFjayA9ICcnO1xyXG5cclxuICAgIGlmICh0eXBlb2YgZXJyb3IgPT09ICdzdHJpbmcnKSB7XHJcbiAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yO1xyXG4gICAgfSBlbHNlIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XHJcbiAgICAgIGVycm9yTWVzc2FnZSA9IGVycm9yLm1lc3NhZ2U7XHJcbiAgICAgIGVycm9yQ29kZSA9IGVycm9yLm5hbWUgfHwgJ0Vycm9yJztcclxuICAgICAgZXJyb3JTdGFjayA9IGVycm9yLnN0YWNrIHx8ICcnO1xyXG4gICAgfSBlbHNlIGlmIChlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09ICdvYmplY3QnKSB7XHJcbiAgICAgIGVycm9yTWVzc2FnZSA9IEpTT04uc3RyaW5naWZ5KGVycm9yKTtcclxuICAgICAgZXJyb3JDb2RlID0gKGVycm9yIGFzIGFueSkuY29kZSB8fCAoZXJyb3IgYXMgYW55KS5uYW1lIHx8ICdPYmplY3RFcnJvcic7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBlcnJvck1lc3NhZ2UgPSBTdHJpbmcoZXJyb3IpO1xyXG4gICAgfVxyXG5cclxuICAgIC8vIFNlcmlhbGl6ZSBjb250ZXh0IHNhZmVseVxyXG4gICAgbGV0IHNlcmlhbGl6ZWRDb250ZXh0OiBhbnkgPSB7fTtcclxuICAgIHRyeSB7XHJcbiAgICAgIHNlcmlhbGl6ZWRDb250ZXh0ID1cclxuICAgICAgICB0eXBlb2YgY29udGV4dCA9PT0gJ29iamVjdCcgJiYgY29udGV4dCAhPT0gbnVsbFxyXG4gICAgICAgICAgPyBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KGNvbnRleHQpKVxyXG4gICAgICAgICAgOiBjb250ZXh0O1xyXG4gICAgfSBjYXRjaCAoc2VyaWFsaXphdGlvbkVycm9yKSB7XHJcbiAgICAgIHNlcmlhbGl6ZWRDb250ZXh0ID0geyBlcnJvcjogJ0ZhaWxlZCB0byBzZXJpYWxpemUgY29udGV4dCcsIG9yaWdpbmFsOiBTdHJpbmcoY29udGV4dCkgfTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCBfZXJyb3JEZXRhaWxzOiBFcnJvckRldGFpbHMgPSB7XHJcbiAgICAgIGlkOiBfZXJyb3JJZCxcclxuICAgICAgbWVzc2FnZTogZXJyb3JNZXNzYWdlLFxyXG4gICAgICBjb2RlOiBlcnJvckNvZGUsXHJcbiAgICAgIGNhdGVnb3J5LFxyXG4gICAgICBzZXZlcml0eSxcclxuICAgICAgY29udGV4dDogc2VyaWFsaXplZENvbnRleHQsXHJcbiAgICAgIHRpbWVzdGFtcDogbmV3IERhdGUoKSxcclxuICAgICAgc3RhY2s6IGVycm9yU3RhY2ssXHJcbiAgICAgIHJlc29sdmVkOiBmYWxzZSxcclxuICAgICAgcmV0cnlDb3VudDogMCxcclxuICAgIH07XHJcblxyXG4gICAgdGhpcy5lcnJvcnMuc2V0KF9lcnJvcklkLCBfZXJyb3JEZXRhaWxzKTtcclxuXHJcbiAgICAvLyBMb2cgd2l0aCBwcm9wZXJseSBzZXJpYWxpemVkIGRhdGFcclxuICAgIC8vIFByb2R1Y3Rpb24gY29uc29sZSBzdGF0ZW1lbnRzIGRpc2FibGVkIGZvciBsaW50IGNvbXBsaWFuY2VcclxuICAgIC8vIGNvbnNvbGUuZXJyb3IoJ1tVbmlmaWVkRXJyb3JTZXJ2aWNlXSBFcnJvciByZXBvcnRlZDonLCB7XHJcbiAgICAvLyAgIGlkOiBfZXJyb3JJZCxcclxuICAgIC8vICAgbWVzc2FnZTogZXJyb3JNZXNzYWdlLFxyXG4gICAgLy8gICBjb2RlOiBlcnJvckNvZGUsXHJcbiAgICAvLyAgIGNhdGVnb3J5LFxyXG4gICAgLy8gICBzZXZlcml0eSxcclxuICAgIC8vICAgY29udGV4dDogc2VyaWFsaXplZENvbnRleHQsXHJcbiAgICAvLyAgIHRpbWVzdGFtcDogX2Vycm9yRGV0YWlscy50aW1lc3RhbXAudG9JU09TdHJpbmcoKVxyXG4gICAgLy8gfSk7XHJcblxyXG4gICAgdGhpcy5sb2dnZXIuZXJyb3IoJ0Vycm9yIHJlcG9ydGVkJywgX2Vycm9yRGV0YWlscyk7XHJcbiAgICB0aGlzLmVtaXQoJ2Vycm9yX3JlcG9ydGVkJywgX2Vycm9yRGV0YWlscyk7XHJcblxyXG4gICAgLy8gQXV0by1yZXNvbHZlIGxvdyBzZXZlcml0eSBlcnJvcnMgYWZ0ZXIgc29tZSB0aW1lXHJcbiAgICBpZiAoc2V2ZXJpdHkgPT09IEVycm9yU2V2ZXJpdHkuTE9XKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gdGhpcy5yZXNvbHZlRXJyb3IoX2Vycm9ySWQpLCA2MDAwMCk7IC8vIDEgbWludXRlXHJcbiAgICB9XHJcblxyXG4gICAgLy8gTm90aWZ5IGlmIGNyaXRpY2FsXHJcbiAgICBpZiAoc2V2ZXJpdHkgPT09IEVycm9yU2V2ZXJpdHkuQ1JJVElDQUwpIHtcclxuICAgICAgdGhpcy5lbWl0KCdjcml0aWNhbF9lcnJvcicsIF9lcnJvckRldGFpbHMpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBfZXJyb3JJZDtcclxuICB9XHJcblxyXG4gIGFzeW5jIHJldHJ5T3BlcmF0aW9uPFQ+KFxyXG4gICAgb3BlcmF0aW9uOiAoKSA9PiBQcm9taXNlPFQ+LFxyXG4gICAgY29udGV4dDogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9LFxyXG4gICAgY2F0ZWdvcnk6IEVycm9yQ2F0ZWdvcnkgPSBFcnJvckNhdGVnb3J5Lk5FVFdPUktcclxuICApOiBQcm9taXNlPFQ+IHtcclxuICAgIGxldCBsYXN0RXJyb3I6IEVycm9yIHwgbnVsbCA9IG51bGw7XHJcblxyXG4gICAgZm9yIChsZXQgX2F0dGVtcHQgPSAwOyBfYXR0ZW1wdCA8PSB0aGlzLm1heFJldHJpZXM7IF9hdHRlbXB0KyspIHtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICBpZiAoX2F0dGVtcHQgPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCBfZGVsYXkgPSB0aGlzLnJldHJ5RGVsYXlzW01hdGgubWluKF9hdHRlbXB0IC0gMSwgdGhpcy5yZXRyeURlbGF5cy5sZW5ndGggLSAxKV07XHJcbiAgICAgICAgICBhd2FpdCB0aGlzLmRlbGF5KF9kZWxheSk7XHJcbiAgICAgICAgICB0aGlzLmxvZ2dlci5pbmZvKCdSZXRyeWluZyBvcGVyYXRpb24nLCB7IGF0dGVtcHQ6IF9hdHRlbXB0LCBkZWxheTogX2RlbGF5LCBjb250ZXh0IH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIGF3YWl0IG9wZXJhdGlvbigpO1xyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGxhc3RFcnJvciA9IGVycm9yIGFzIEVycm9yO1xyXG5cclxuICAgICAgICBpZiAoX2F0dGVtcHQgPT09IHRoaXMubWF4UmV0cmllcykge1xyXG4gICAgICAgICAgLy8gRmluYWwgYXR0ZW1wdCBmYWlsZWRcclxuICAgICAgICAgIGNvbnN0IF9lcnJvcklkID0gdGhpcy5yZXBvcnRFcnJvcihcclxuICAgICAgICAgICAgbGFzdEVycm9yLFxyXG4gICAgICAgICAgICB7IC4uLmNvbnRleHQsIHRvdGFsQXR0ZW1wdHM6IF9hdHRlbXB0ICsgMSB9LFxyXG4gICAgICAgICAgICBjYXRlZ29yeSxcclxuICAgICAgICAgICAgRXJyb3JTZXZlcml0eS5ISUdIXHJcbiAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgIHRocm93IG5ldyBFcnJvcihgT3BlcmF0aW9uIGZhaWxlZCBhZnRlciAke19hdHRlbXB0ICsgMX0gYXR0ZW1wdHMuIEVycm9yIElEOiAke19lcnJvcklkfWApO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRocm93IGxhc3RFcnJvcjtcclxuICB9XHJcblxyXG4gIHJlc29sdmVFcnJvcihlcnJvcklkOiBzdHJpbmcsIHJlc29sdXRpb24/OiBzdHJpbmcpOiBib29sZWFuIHtcclxuICAgIGNvbnN0IF9lcnJvciA9IHRoaXMuZXJyb3JzLmdldChlcnJvcklkKTtcclxuICAgIGlmICghX2Vycm9yKSB7XHJcbiAgICAgIHRoaXMubG9nZ2VyLndhcm4oJ0F0dGVtcHRlZCB0byByZXNvbHZlIG5vbi1leGlzdGVudCBlcnJvcicsIHsgZXJyb3JJZCB9KTtcclxuICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgfVxyXG5cclxuICAgIF9lcnJvci5yZXNvbHZlZCA9IHRydWU7XHJcbiAgICAoX2Vycm9yLmNvbnRleHQgYXMgYW55KS5yZXNvbHV0aW9uID0gcmVzb2x1dGlvbjtcclxuICAgIChfZXJyb3IuY29udGV4dCBhcyBhbnkpLnJlc29sdmVkQXQgPSBuZXcgRGF0ZSgpO1xyXG5cclxuICAgIHRoaXMubG9nZ2VyLmluZm8oJ0Vycm9yIHJlc29sdmVkJywgeyBlcnJvcklkLCByZXNvbHV0aW9uIH0pO1xyXG4gICAgdGhpcy5lbWl0KCdlcnJvcl9yZXNvbHZlZCcsIF9lcnJvcik7XHJcblxyXG4gICAgcmV0dXJuIHRydWU7XHJcbiAgfVxyXG5cclxuICBnZXRFcnJvcihlcnJvcklkOiBzdHJpbmcpOiBFcnJvckRldGFpbHMgfCBudWxsIHtcclxuICAgIHJldHVybiB0aGlzLmVycm9ycy5nZXQoZXJyb3JJZCkgfHwgbnVsbDtcclxuICB9XHJcblxyXG4gIGdldEVycm9ycyhcclxuICAgIGZpbHRlcnM6IHtcclxuICAgICAgY2F0ZWdvcnk/OiBFcnJvckNhdGVnb3J5O1xyXG4gICAgICBzZXZlcml0eT86IEVycm9yU2V2ZXJpdHk7XHJcbiAgICAgIHJlc29sdmVkPzogYm9vbGVhbjtcclxuICAgICAgc2luY2U/OiBEYXRlO1xyXG4gICAgfSA9IHt9XHJcbiAgKTogRXJyb3JEZXRhaWxzW10ge1xyXG4gICAgY29uc3QgX2FsbEVycm9ycyA9IEFycmF5LmZyb20odGhpcy5lcnJvcnMudmFsdWVzKCkpO1xyXG5cclxuICAgIHJldHVybiBfYWxsRXJyb3JzLmZpbHRlcihlcnJvciA9PiB7XHJcbiAgICAgIGlmIChmaWx0ZXJzLmNhdGVnb3J5ICYmIGVycm9yLmNhdGVnb3J5ICE9PSBmaWx0ZXJzLmNhdGVnb3J5KSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmIChmaWx0ZXJzLnNldmVyaXR5ICYmIGVycm9yLnNldmVyaXR5ICE9PSBmaWx0ZXJzLnNldmVyaXR5KSByZXR1cm4gZmFsc2U7XHJcbiAgICAgIGlmIChmaWx0ZXJzLnJlc29sdmVkICE9PSB1bmRlZmluZWQgJiYgZXJyb3IucmVzb2x2ZWQgIT09IGZpbHRlcnMucmVzb2x2ZWQpIHJldHVybiBmYWxzZTtcclxuICAgICAgaWYgKGZpbHRlcnMuc2luY2UgJiYgZXJyb3IudGltZXN0YW1wIDwgZmlsdGVycy5zaW5jZSkgcmV0dXJuIGZhbHNlO1xyXG4gICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgZ2V0RXJyb3JTdGF0cygpOiB7XHJcbiAgICB0b3RhbDogbnVtYmVyO1xyXG4gICAgcmVzb2x2ZWQ6IG51bWJlcjtcclxuICAgIGJ5Q2F0ZWdvcnk6IFJlY29yZDxFcnJvckNhdGVnb3J5LCBudW1iZXI+O1xyXG4gICAgYnlTZXZlcml0eTogUmVjb3JkPEVycm9yU2V2ZXJpdHksIG51bWJlcj47XHJcbiAgfSB7XHJcbiAgICBjb25zdCBfZXJyb3JzID0gQXJyYXkuZnJvbSh0aGlzLmVycm9ycy52YWx1ZXMoKSk7XHJcblxyXG4gICAgY29uc3QgX3N0YXRzID0ge1xyXG4gICAgICB0b3RhbDogX2Vycm9ycy5sZW5ndGgsXHJcbiAgICAgIHJlc29sdmVkOiBfZXJyb3JzLmZpbHRlcihlID0+IGUucmVzb2x2ZWQpLmxlbmd0aCxcclxuICAgICAgYnlDYXRlZ29yeToge30gYXMgUmVjb3JkPEVycm9yQ2F0ZWdvcnksIG51bWJlcj4sXHJcbiAgICAgIGJ5U2V2ZXJpdHk6IHt9IGFzIFJlY29yZDxFcnJvclNldmVyaXR5LCBudW1iZXI+LFxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBJbml0aWFsaXplIGNvdW50c1xyXG4gICAgT2JqZWN0LnZhbHVlcyhFcnJvckNhdGVnb3J5KS5mb3JFYWNoKGNhdCA9PiAoX3N0YXRzLmJ5Q2F0ZWdvcnlbY2F0XSA9IDApKTtcclxuICAgIE9iamVjdC52YWx1ZXMoRXJyb3JTZXZlcml0eSkuZm9yRWFjaChzZXYgPT4gKF9zdGF0cy5ieVNldmVyaXR5W3Nldl0gPSAwKSk7XHJcblxyXG4gICAgLy8gQ291bnQgZXJyb3JzXHJcbiAgICBfZXJyb3JzLmZvckVhY2goZXJyb3IgPT4ge1xyXG4gICAgICBfc3RhdHMuYnlDYXRlZ29yeVtlcnJvci5jYXRlZ29yeV0rKztcclxuICAgICAgX3N0YXRzLmJ5U2V2ZXJpdHlbZXJyb3Iuc2V2ZXJpdHldKys7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXR1cm4gX3N0YXRzO1xyXG4gIH1cclxuXHJcbiAgY2xlYXJFcnJvcnMob2xkZXJUaGFuPzogRGF0ZSk6IG51bWJlciB7XHJcbiAgICBsZXQgX2NsZWFyZWQgPSAwO1xyXG5cclxuICAgIGZvciAoY29uc3QgW2lkLCBlcnJvcl0gb2YgdGhpcy5lcnJvcnMuZW50cmllcygpKSB7XHJcbiAgICAgIGlmICghb2xkZXJUaGFuIHx8IGVycm9yLnRpbWVzdGFtcCA8IG9sZGVyVGhhbikge1xyXG4gICAgICAgIGlmIChlcnJvci5yZXNvbHZlZCB8fCBlcnJvci5zZXZlcml0eSA9PT0gRXJyb3JTZXZlcml0eS5MT1cpIHtcclxuICAgICAgICAgIHRoaXMuZXJyb3JzLmRlbGV0ZShpZCk7XHJcbiAgICAgICAgICBfY2xlYXJlZCsrO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIHRoaXMubG9nZ2VyLmluZm8oJ0Vycm9ycyBjbGVhcmVkJywgeyBjbGVhcmVkOiBfY2xlYXJlZCwgb2xkZXJUaGFuIH0pO1xyXG4gICAgcmV0dXJuIF9jbGVhcmVkO1xyXG4gIH1cclxuXHJcbiAgcHJpdmF0ZSBkZWxheShtczogbnVtYmVyKTogUHJvbWlzZTx2b2lkPiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UocmVzb2x2ZSA9PiBzZXRUaW1lb3V0KHJlc29sdmUsIG1zKSk7XHJcbiAgfVxyXG5cclxuICAvLyBIZWxwZXIgbWV0aG9kcyBmb3IgY29tbW9uIGVycm9yIGNhdGVnb3JpZXNcclxuICByZXBvcnROZXR3b3JrRXJyb3IoZXJyb3I6IEVycm9yLCBjb250ZXh0OiBSZWNvcmQ8c3RyaW5nLCBhbnk+ID0ge30pOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIHRoaXMucmVwb3J0RXJyb3IoZXJyb3IsIGNvbnRleHQsIEVycm9yQ2F0ZWdvcnkuTkVUV09SSywgRXJyb3JTZXZlcml0eS5NRURJVU0pO1xyXG4gIH1cclxuXHJcbiAgcmVwb3J0VmFsaWRhdGlvbkVycm9yKG1lc3NhZ2U6IHN0cmluZywgY29udGV4dDogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9KTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLnJlcG9ydEVycm9yKG1lc3NhZ2UsIGNvbnRleHQsIEVycm9yQ2F0ZWdvcnkuVkFMSURBVElPTiwgRXJyb3JTZXZlcml0eS5MT1cpO1xyXG4gIH1cclxuXHJcbiAgcmVwb3J0QXV0aEVycm9yKGVycm9yOiBFcnJvciwgY29udGV4dDogUmVjb3JkPHN0cmluZywgYW55PiA9IHt9KTogc3RyaW5nIHtcclxuICAgIHJldHVybiB0aGlzLnJlcG9ydEVycm9yKGVycm9yLCBjb250ZXh0LCBFcnJvckNhdGVnb3J5LkFVVEhFTlRJQ0FUSU9OLCBFcnJvclNldmVyaXR5LkhJR0gpO1xyXG4gIH1cclxuXHJcbiAgcmVwb3J0Q3JpdGljYWxFcnJvcihlcnJvcjogRXJyb3IsIGNvbnRleHQ6IFJlY29yZDxzdHJpbmcsIGFueT4gPSB7fSk6IHN0cmluZyB7XHJcbiAgICByZXR1cm4gdGhpcy5yZXBvcnRFcnJvcihlcnJvciwgY29udGV4dCwgRXJyb3JDYXRlZ29yeS5TWVNURU0sIEVycm9yU2V2ZXJpdHkuQ1JJVElDQUwpO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgVW5pZmllZEVycm9yU2VydmljZTtcclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7QUFBQSxJQUFBQSxZQUFBLEdBQUFDLE9BQUE7QUFBNEMsSUFBQUMsb0JBQUE7QUFBQSxJQUVoQ0MsYUFBYSxHQUFBQyxPQUFBLENBQUFELGFBQUEsMEJBQWJBLGFBQWE7RUFBYkEsYUFBYTtFQUFiQSxhQUFhO0VBQWJBLGFBQWE7RUFBYkEsYUFBYTtFQUFBLE9BQWJBLGFBQWE7QUFBQTtBQUFBLElBT2JFLGFBQWEsR0FBQUQsT0FBQSxDQUFBQyxhQUFBLDBCQUFiQSxhQUFhO0VBQWJBLGFBQWE7RUFBYkEsYUFBYTtFQUFiQSxhQUFhO0VBQWJBLGFBQWE7RUFBYkEsYUFBYTtFQUFiQSxhQUFhO0VBQWJBLGFBQWE7RUFBQSxPQUFiQSxhQUFhO0FBQUE7QUF1QmxCLE1BQU1DLG1CQUFtQixTQUFTQyx3QkFBVyxDQUFDO0VBS1Q7O0VBRWhDQyxXQUFXQSxDQUFBLEVBQUc7SUFDdEI7SUFDQSxLQUFLLENBQUMscUJBQXFCLENBQUM7SUFBQyxLQVB2QkMsTUFBTSxHQUE4QixJQUFJQyxHQUFHLENBQUMsQ0FBQztJQUFB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QUFRLEVBQUU7UUFDWjtNQUNGO0lBQ0Y7SUFFQSxJQUFJLENBQUNqRCxNQUFNLENBQUNnQixJQUFJLENBQUMsZ0JBQWdCLEVBQUU7TUFBRW9DLE9BQU8sRUFBRUgsUUFBUTtNQUFFRDtJQUFVLENBQUMsQ0FBQztJQUNwRSxPQUFPQyxRQUFRO0VBQ2pCO0VBRVFsQyxLQUFLQSxDQUFDc0MsRUFBVSxFQUFpQjtJQUN2QyxPQUFPLElBQUlDLE9BQU8sQ0FBQ0MsT0FBTyxJQUFJcEQsVUFBVSxDQUFDb0QsT0FBTyxFQUFFRixFQUFFLENBQUMsQ0FBQztFQUN4RDs7RUFFQTtFQUNBRyxrQkFBa0JBLENBQUN0RixLQUFZLEVBQUVDLE9BQTRCLEdBQUcsQ0FBQyxDQUFDLEVBQVU7SUFDMUUsT0FBTyxJQUFJLENBQUNGLFdBQVcsQ0FBQ0MsS0FBSyxFQUFFQyxPQUFPLEVBQUViLGFBQWEsQ0FBQ2tELE9BQU8sRUFBRXBELGFBQWEsQ0FBQ21CLE1BQU0sQ0FBQztFQUN0RjtFQUVBa0YscUJBQXFCQSxDQUFDMUUsT0FBZSxFQUFFWixPQUE0QixHQUFHLENBQUMsQ0FBQyxFQUFVO0lBQ2hGLE9BQU8sSUFBSSxDQUFDRixXQUFXLENBQUNjLE9BQU8sRUFBRVosT0FBTyxFQUFFYixhQUFhLENBQUNvRyxVQUFVLEVBQUV0RyxhQUFhLENBQUM4QyxHQUFHLENBQUM7RUFDeEY7RUFFQXlELGVBQWVBLENBQUN6RixLQUFZLEVBQUVDLE9BQTRCLEdBQUcsQ0FBQyxDQUFDLEVBQVU7SUFDdkUsT0FBTyxJQUFJLENBQUNGLFdBQVcsQ0FBQ0MsS0FBSyxFQUFFQyxPQUFPLEVBQUViLGFBQWEsQ0FBQ3NHLGNBQWMsRUFBRXhHLGFBQWEsQ0FBQytELElBQUksQ0FBQztFQUMzRjtFQUVBMEMsbUJBQW1CQSxDQUFDM0YsS0FBWSxFQUFFQyxPQUE0QixHQUFHLENBQUMsQ0FBQyxFQUFVO0lBQzNFLE9BQU8sSUFBSSxDQUFDRixXQUFXLENBQUNDLEtBQUssRUFBRUMsT0FBTyxFQUFFYixhQUFhLENBQUN3RyxNQUFNLEVBQUUxRyxhQUFhLENBQUNpRCxRQUFRLENBQUM7RUFDdkY7QUFDRjtBQUFDaEQsT0FBQSxDQUFBRSxtQkFBQSxHQUFBQSxtQkFBQTtBQUFBSixvQkFBQSxHQS9PWUksbUJBQW1CO0FBQW5CQSxtQkFBbUIsQ0FDZlMsUUFBUTtBQUFBLElBQUErRixRQUFBLEdBQUExRyxPQUFBLENBQUEyRyxPQUFBLEdBZ1BWekcsbUJBQW1CIiwiaWdub3JlTGlzdCI6W119