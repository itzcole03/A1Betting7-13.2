c3b0f643620fd9428f689555319f926e
"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
var _react = _interopRequireDefault(require("react"));
var _react2 = require("@testing-library/react");
require("@testing-library/jest-dom");
var robustApi = _interopRequireWildcard(require("../../../utils/robustApi"));
var _PerformanceMonitoringDashboard = _interopRequireDefault(require("../PerformanceMonitoringDashboard"));
var _jsxRuntime = require("react/jsx-runtime");
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) "default" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }
/**
 * Component tests for PerformanceMonitoringDashboard
 * Focus: Safe cache_hit_rate rendering without runtime errors
 */

describe('PerformanceMonitoringDashboard - Cache Hit Rate Safety', () => {
  let consoleLogSpy;
  beforeEach(() => {
    jest.clearAllMocks();
    // Suppress console.log for development diagnostics
    consoleLogSpy = jest.spyOn(console, 'log').mockImplementation(() => {});
    // Default: stub fetchPerformanceStats to resolve to undefined (component handles missing perf)
    jest.spyOn(robustApi, 'fetchPerformanceStats').mockResolvedValue(undefined);
  });
  afterEach(() => {
    consoleLogSpy.mockRestore();
  });
  describe('Safe cache_hit_rate rendering', () => {
    it('should render 0% when cache_hit_rate is undefined', async () => {
      // Mock API response with missing cache_hit_rate
      jest.spyOn(robustApi, 'fetchHealthData').mockResolvedValue({
        status: 'healthy',
        services: {
          api: 'healthy',
          cache: 'healthy',
          database: 'healthy'
        },
        performance: {
          // cache_hit_rate is missing/undefined
          cache_type: 'redis'
        },
        uptime_seconds: 3600
      });
      (0, _react2.render)(/*#__PURE__*/(0, _jsxRuntime.jsx)(_PerformanceMonitoringDashboard.default, {}));

      // Ensure the component invoked the health API mock
      await (0, _react2.waitFor)(() => expect(robustApi.fetchHealthData).toHaveBeenCalled());
      await (0, _react2.waitFor)(() => {
        const cacheHitRate = _react2.screen.getByText(/Cache Hit Rate/);
        expect(cacheHitRate).toBeInTheDocument();

        // Should display 0% instead of crashing (allow multiple matching nodes)
        const percentages = _react2.screen.getAllByText('0.0%');
        expect(percentages.length).toBeGreaterThan(0);
      });
    });
    it('should render 0% when performance object is null', async () => {
      jest.spyOn(robustApi, 'fetchHealthData').mockResolvedValue({
        status: 'healthy',
        services: {
          api: 'healthy',
          cache: 'healthy',
          database: 'healthy'
        },
        performance: null,
        // Null performance object
        uptime_seconds: 3600
      });
      (0, _react2.render)(/*#__PURE__*/(0, _jsxRuntime.jsx)(_PerformanceMonitoringDashboard.default, {}));
      await (0, _react2.waitFor)(() => {
        const percentages = _react2.screen.getAllByText('0.0%');
        expect(percentages.length).toBeGreaterThan(0);
      });
    });
    it('should render 0% when entire health data is malformed', async () => {
      jest.spyOn(robustApi, 'fetchHealthData').mockResolvedValue(null);
      (0, _react2.render)(/*#__PURE__*/(0, _jsxRuntime.jsx)(_PerformanceMonitoringDashboard.default, {}));
      await (0, _react2.waitFor)(() => {
        // Should still render something instead of crashing
        // Accept any percent-like text (e.g., '0.0%', '82.3%') or numeric values
        const percentages = _react2.screen.getAllByText((content, _node) => /\d+(?:\.\d+)?%/.test(content));
        expect(percentages.length).toBeGreaterThan(0);
      });
    });
    it('should format valid cache_hit_rate correctly', async () => {
      jest.spyOn(robustApi, 'fetchHealthData').mockResolvedValue({
        status: 'healthy',
        services: {
          api: 'healthy',
          cache: 'healthy',
          database: 'healthy'
        },
        performance: {
          cache_hit_rate: 87.654,
          cache_type: 'redis'
        },
        uptime_seconds: 3600
      });
      (0, _react2.render)(/*#__PURE__*/(0, _jsxRuntime.jsx)(_PerformanceMonitoringDashboard.default, {}));
      await (0, _react2.waitFor)(() => {
        // Should format to 1 decimal place
        const percentages = _react2.screen.getAllByText('87.7%');
        expect(percentages.length).toBeGreaterThan(0);
      });
    });
  });
  describe('Regression prevention', () => {
    it('should prevent "Cannot read properties of undefined" errors', async () => {
      // Test the exact error condition that was reported
      const problematicApiResponse = {
        status: 'healthy',
        services: {
          api: 'healthy',
          cache: 'degraded',
          database: 'healthy'
        },
        // performance object exists but cache_hit_rate is undefined
        performance: {
          cache_type: 'redis'
          // cache_hit_rate is missing
        },
        uptime_seconds: 3600
      };
      jest.spyOn(robustApi, 'fetchHealthData').mockResolvedValue(problematicApiResponse);

      // This should not throw any errors
      const {
        container
      } = (0, _react2.render)(/*#__PURE__*/(0, _jsxRuntime.jsx)(_PerformanceMonitoringDashboard.default, {}));
      await (0, _react2.waitFor)(() => {
        expect(container).toBeInTheDocument();
        const percentages = _react2.screen.getAllByText('0.0%');
        expect(percentages.length).toBeGreaterThan(0);
      });
    });
    it('should work with hit_rate field mapping', async () => {
      jest.spyOn(robustApi, 'fetchHealthData').mockResolvedValue({
        status: 'healthy',
        services: {
          api: 'healthy',
          cache: 'healthy',
          database: 'healthy'
        },
        performance: {
          hit_rate: 92.3,
          // Old field name
          cache_type: 'redis'
        },
        uptime_seconds: 3600
      });
      (0, _react2.render)(/*#__PURE__*/(0, _jsxRuntime.jsx)(_PerformanceMonitoringDashboard.default, {}));
      await (0, _react2.waitFor)(() => {
        // Should map hit_rate to cache_hit_rate
        const percentages = _react2.screen.getAllByText('92.3%');
        expect(percentages.length).toBeGreaterThan(0);
      });
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwicmVxdWlyZSIsIl9yZWFjdDIiLCJyb2J1c3RBcGkiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsIl9QZXJmb3JtYW5jZU1vbml0b3JpbmdEYXNoYm9hcmQiLCJfanN4UnVudGltZSIsImUiLCJ0IiwiV2Vha01hcCIsInIiLCJuIiwiX19lc01vZHVsZSIsIm8iLCJpIiwiZiIsIl9fcHJvdG9fXyIsImRlZmF1bHQiLCJoYXMiLCJnZXQiLCJzZXQiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsImRlc2NyaWJlIiwiY29uc29sZUxvZ1NweSIsImJlZm9yZUVhY2giLCJqZXN0IiwiY2xlYXJBbGxNb2NrcyIsInNweU9uIiwiY29uc29sZSIsIm1vY2tJbXBsZW1lbnRhdGlvbiIsIm1vY2tSZXNvbHZlZFZhbHVlIiwidW5kZWZpbmVkIiwiYWZ0ZXJFYWNoIiwibW9ja1Jlc3RvcmUiLCJpdCIsInN0YXR1cyIsInNlcnZpY2VzIiwiYXBpIiwiY2FjaGUiLCJkYXRhYmFzZSIsInBlcmZvcm1hbmNlIiwiY2FjaGVfdHlwZSIsInVwdGltZV9zZWNvbmRzIiwicmVuZGVyIiwianN4Iiwid2FpdEZvciIsImV4cGVjdCIsImZldGNoSGVhbHRoRGF0YSIsInRvSGF2ZUJlZW5DYWxsZWQiLCJjYWNoZUhpdFJhdGUiLCJzY3JlZW4iLCJnZXRCeVRleHQiLCJ0b0JlSW5UaGVEb2N1bWVudCIsInBlcmNlbnRhZ2VzIiwiZ2V0QWxsQnlUZXh0IiwibGVuZ3RoIiwidG9CZUdyZWF0ZXJUaGFuIiwiY29udGVudCIsIl9ub2RlIiwidGVzdCIsImNhY2hlX2hpdF9yYXRlIiwicHJvYmxlbWF0aWNBcGlSZXNwb25zZSIsImNvbnRhaW5lciIsImhpdF9yYXRlIl0sInNvdXJjZXMiOlsiUGVyZm9ybWFuY2VNb25pdG9yaW5nRGFzaGJvYXJkLnRlc3QudHN4Il0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDb21wb25lbnQgdGVzdHMgZm9yIFBlcmZvcm1hbmNlTW9uaXRvcmluZ0Rhc2hib2FyZFxyXG4gKiBGb2N1czogU2FmZSBjYWNoZV9oaXRfcmF0ZSByZW5kZXJpbmcgd2l0aG91dCBydW50aW1lIGVycm9yc1xyXG4gKi9cclxuXHJcbmltcG9ydCBSZWFjdCBmcm9tICdyZWFjdCc7XHJcbmltcG9ydCB7IHJlbmRlciwgc2NyZWVuLCB3YWl0Rm9yIH0gZnJvbSAnQHRlc3RpbmctbGlicmFyeS9yZWFjdCc7XHJcbmltcG9ydCAnQHRlc3RpbmctbGlicmFyeS9qZXN0LWRvbSc7XHJcbmltcG9ydCAqIGFzIHJvYnVzdEFwaSBmcm9tICcuLi8uLi8uLi91dGlscy9yb2J1c3RBcGknO1xyXG5pbXBvcnQgUGVyZm9ybWFuY2VNb25pdG9yaW5nRGFzaGJvYXJkIGZyb20gJy4uL1BlcmZvcm1hbmNlTW9uaXRvcmluZ0Rhc2hib2FyZCc7XHJcblxyXG5kZXNjcmliZSgnUGVyZm9ybWFuY2VNb25pdG9yaW5nRGFzaGJvYXJkIC0gQ2FjaGUgSGl0IFJhdGUgU2FmZXR5JywgKCkgPT4ge1xyXG4gIGxldCBjb25zb2xlTG9nU3B5OiBqZXN0LlNweUluc3RhbmNlO1xyXG5cclxuICBiZWZvcmVFYWNoKCgpID0+IHtcclxuICAgIGplc3QuY2xlYXJBbGxNb2NrcygpO1xyXG4gICAgLy8gU3VwcHJlc3MgY29uc29sZS5sb2cgZm9yIGRldmVsb3BtZW50IGRpYWdub3N0aWNzXHJcbiAgICBjb25zb2xlTG9nU3B5ID0gamVzdC5zcHlPbihjb25zb2xlLCAnbG9nJykubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+IHt9KTtcclxuICAgIC8vIERlZmF1bHQ6IHN0dWIgZmV0Y2hQZXJmb3JtYW5jZVN0YXRzIHRvIHJlc29sdmUgdG8gdW5kZWZpbmVkIChjb21wb25lbnQgaGFuZGxlcyBtaXNzaW5nIHBlcmYpXHJcbiAgICBqZXN0LnNweU9uKHJvYnVzdEFwaSwgJ2ZldGNoUGVyZm9ybWFuY2VTdGF0cycpLm1vY2tSZXNvbHZlZFZhbHVlKHVuZGVmaW5lZCBhcyBhbnkpO1xyXG4gIH0pO1xyXG5cclxuICBhZnRlckVhY2goKCkgPT4ge1xyXG4gICAgY29uc29sZUxvZ1NweS5tb2NrUmVzdG9yZSgpO1xyXG4gIH0pO1xyXG5cclxuICBkZXNjcmliZSgnU2FmZSBjYWNoZV9oaXRfcmF0ZSByZW5kZXJpbmcnLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHJlbmRlciAwJSB3aGVuIGNhY2hlX2hpdF9yYXRlIGlzIHVuZGVmaW5lZCcsIGFzeW5jICgpID0+IHtcclxuICAvLyBNb2NrIEFQSSByZXNwb25zZSB3aXRoIG1pc3NpbmcgY2FjaGVfaGl0X3JhdGVcclxuICBqZXN0LnNweU9uKHJvYnVzdEFwaSwgJ2ZldGNoSGVhbHRoRGF0YScpLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBzdGF0dXM6ICdoZWFsdGh5JyxcclxuICAgICAgICBzZXJ2aWNlczoge1xyXG4gICAgICAgICAgYXBpOiAnaGVhbHRoeScsXHJcbiAgICAgICAgICBjYWNoZTogJ2hlYWx0aHknLCBcclxuICAgICAgICAgIGRhdGFiYXNlOiAnaGVhbHRoeSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBlcmZvcm1hbmNlOiB7XHJcbiAgICAgICAgICAvLyBjYWNoZV9oaXRfcmF0ZSBpcyBtaXNzaW5nL3VuZGVmaW5lZFxyXG4gICAgICAgICAgY2FjaGVfdHlwZTogJ3JlZGlzJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXB0aW1lX3NlY29uZHM6IDM2MDBcclxuICB9IGFzIGFueSk7XHJcblxyXG4gICAgICByZW5kZXIoPFBlcmZvcm1hbmNlTW9uaXRvcmluZ0Rhc2hib2FyZCAvPik7XHJcblxyXG4gICAgICAvLyBFbnN1cmUgdGhlIGNvbXBvbmVudCBpbnZva2VkIHRoZSBoZWFsdGggQVBJIG1vY2tcclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiBleHBlY3Qocm9idXN0QXBpLmZldGNoSGVhbHRoRGF0YSkudG9IYXZlQmVlbkNhbGxlZCgpKTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIGNvbnN0IGNhY2hlSGl0UmF0ZSA9IHNjcmVlbi5nZXRCeVRleHQoL0NhY2hlIEhpdCBSYXRlLyk7XHJcbiAgICAgICAgZXhwZWN0KGNhY2hlSGl0UmF0ZSkudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuXHJcbiAgICAgICAgLy8gU2hvdWxkIGRpc3BsYXkgMCUgaW5zdGVhZCBvZiBjcmFzaGluZyAoYWxsb3cgbXVsdGlwbGUgbWF0Y2hpbmcgbm9kZXMpXHJcbiAgY29uc3QgcGVyY2VudGFnZXMgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KCcwLjAlJyk7XHJcbiAgICAgICAgZXhwZWN0KHBlcmNlbnRhZ2VzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVuZGVyIDAlIHdoZW4gcGVyZm9ybWFuY2Ugb2JqZWN0IGlzIG51bGwnLCBhc3luYyAoKSA9PiB7XHJcbiAgamVzdC5zcHlPbihyb2J1c3RBcGksICdmZXRjaEhlYWx0aERhdGEnKS5tb2NrUmVzb2x2ZWRWYWx1ZSh7XHJcbiAgICAgICAgc3RhdHVzOiAnaGVhbHRoeScsXHJcbiAgICAgICAgc2VydmljZXM6IHtcclxuICAgICAgICAgIGFwaTogJ2hlYWx0aHknLFxyXG4gICAgICAgICAgY2FjaGU6ICdoZWFsdGh5JyxcclxuICAgICAgICAgIGRhdGFiYXNlOiAnaGVhbHRoeSdcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBlcmZvcm1hbmNlOiBudWxsLCAvLyBOdWxsIHBlcmZvcm1hbmNlIG9iamVjdFxyXG4gICAgICAgIHVwdGltZV9zZWNvbmRzOiAzNjAwXHJcbiAgfSBhcyBhbnkpO1xyXG5cclxuICAgICAgcmVuZGVyKDxQZXJmb3JtYW5jZU1vbml0b3JpbmdEYXNoYm9hcmQgLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgY29uc3QgcGVyY2VudGFnZXMgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KCcwLjAlJyk7XHJcbiAgICAgICAgZXhwZWN0KHBlcmNlbnRhZ2VzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG5cclxuICAgIGl0KCdzaG91bGQgcmVuZGVyIDAlIHdoZW4gZW50aXJlIGhlYWx0aCBkYXRhIGlzIG1hbGZvcm1lZCcsIGFzeW5jICgpID0+IHtcclxuICBqZXN0LnNweU9uKHJvYnVzdEFwaSwgJ2ZldGNoSGVhbHRoRGF0YScpLm1vY2tSZXNvbHZlZFZhbHVlKG51bGwgYXMgYW55KTtcclxuXHJcbiAgICAgIHJlbmRlcig8UGVyZm9ybWFuY2VNb25pdG9yaW5nRGFzaGJvYXJkIC8+KTtcclxuXHJcbiAgICAgIGF3YWl0IHdhaXRGb3IoKCkgPT4ge1xyXG4gICAgICAgIC8vIFNob3VsZCBzdGlsbCByZW5kZXIgc29tZXRoaW5nIGluc3RlYWQgb2YgY3Jhc2hpbmdcclxuICAgICAgICAvLyBBY2NlcHQgYW55IHBlcmNlbnQtbGlrZSB0ZXh0IChlLmcuLCAnMC4wJScsICc4Mi4zJScpIG9yIG51bWVyaWMgdmFsdWVzXHJcbiAgY29uc3QgcGVyY2VudGFnZXMgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KChjb250ZW50LCBfbm9kZSkgPT4gL1xcZCsoPzpcXC5cXGQrKT8lLy50ZXN0KGNvbnRlbnQpKTtcclxuICAgICAgICBleHBlY3QocGVyY2VudGFnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCBmb3JtYXQgdmFsaWQgY2FjaGVfaGl0X3JhdGUgY29ycmVjdGx5JywgYXN5bmMgKCkgPT4ge1xyXG4gIGplc3Quc3B5T24ocm9idXN0QXBpLCAnZmV0Y2hIZWFsdGhEYXRhJykubW9ja1Jlc29sdmVkVmFsdWUoe1xyXG4gICAgICAgIHN0YXR1czogJ2hlYWx0aHknLFxyXG4gICAgICAgIHNlcnZpY2VzOiB7XHJcbiAgICAgICAgICBhcGk6ICdoZWFsdGh5JyxcclxuICAgICAgICAgIGNhY2hlOiAnaGVhbHRoeScsXHJcbiAgICAgICAgICBkYXRhYmFzZTogJ2hlYWx0aHknXHJcbiAgICAgICAgfSxcclxuICAgICAgICBwZXJmb3JtYW5jZToge1xyXG4gICAgICAgICAgY2FjaGVfaGl0X3JhdGU6IDg3LjY1NCxcclxuICAgICAgICAgIGNhY2hlX3R5cGU6ICdyZWRpcydcclxuICAgICAgICB9LFxyXG4gICAgICAgIHVwdGltZV9zZWNvbmRzOiAzNjAwXHJcbiAgfSk7XHJcblxyXG4gICAgICByZW5kZXIoPFBlcmZvcm1hbmNlTW9uaXRvcmluZ0Rhc2hib2FyZCAvPik7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICAvLyBTaG91bGQgZm9ybWF0IHRvIDEgZGVjaW1hbCBwbGFjZVxyXG4gICAgICAgIGNvbnN0IHBlcmNlbnRhZ2VzID0gc2NyZWVuLmdldEFsbEJ5VGV4dCgnODcuNyUnKTtcclxuICAgICAgICBleHBlY3QocGVyY2VudGFnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcblxyXG4gIGRlc2NyaWJlKCdSZWdyZXNzaW9uIHByZXZlbnRpb24nLCAoKSA9PiB7XHJcbiAgICBpdCgnc2hvdWxkIHByZXZlbnQgXCJDYW5ub3QgcmVhZCBwcm9wZXJ0aWVzIG9mIHVuZGVmaW5lZFwiIGVycm9ycycsIGFzeW5jICgpID0+IHtcclxuICAgICAgLy8gVGVzdCB0aGUgZXhhY3QgZXJyb3IgY29uZGl0aW9uIHRoYXQgd2FzIHJlcG9ydGVkXHJcbiAgICAgIGNvbnN0IHByb2JsZW1hdGljQXBpUmVzcG9uc2UgPSB7XHJcbiAgICAgICAgc3RhdHVzOiAnaGVhbHRoeScsXHJcbiAgICAgICAgc2VydmljZXM6IHtcclxuICAgICAgICAgIGFwaTogJ2hlYWx0aHknLFxyXG4gICAgICAgICAgY2FjaGU6ICdkZWdyYWRlZCcsXHJcbiAgICAgICAgICBkYXRhYmFzZTogJ2hlYWx0aHknXHJcbiAgICAgICAgfSxcclxuICAgICAgICAvLyBwZXJmb3JtYW5jZSBvYmplY3QgZXhpc3RzIGJ1dCBjYWNoZV9oaXRfcmF0ZSBpcyB1bmRlZmluZWRcclxuICAgICAgICBwZXJmb3JtYW5jZToge1xyXG4gICAgICAgICAgY2FjaGVfdHlwZTogJ3JlZGlzJ1xyXG4gICAgICAgICAgLy8gY2FjaGVfaGl0X3JhdGUgaXMgbWlzc2luZ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXB0aW1lX3NlY29uZHM6IDM2MDBcclxuICAgICAgfTtcclxuXHJcbiAgamVzdC5zcHlPbihyb2J1c3RBcGksICdmZXRjaEhlYWx0aERhdGEnKS5tb2NrUmVzb2x2ZWRWYWx1ZShwcm9ibGVtYXRpY0FwaVJlc3BvbnNlIGFzIGFueSk7XHJcblxyXG4gICAgICAvLyBUaGlzIHNob3VsZCBub3QgdGhyb3cgYW55IGVycm9yc1xyXG4gICAgICBjb25zdCB7IGNvbnRhaW5lciB9ID0gcmVuZGVyKDxQZXJmb3JtYW5jZU1vbml0b3JpbmdEYXNoYm9hcmQgLz4pO1xyXG5cclxuICAgICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgICAgZXhwZWN0KGNvbnRhaW5lcikudG9CZUluVGhlRG9jdW1lbnQoKTtcclxuICBjb25zdCBwZXJjZW50YWdlcyA9IHNjcmVlbi5nZXRBbGxCeVRleHQoJzAuMCUnKTtcclxuICAgICAgICBleHBlY3QocGVyY2VudGFnZXMubGVuZ3RoKS50b0JlR3JlYXRlclRoYW4oMCk7XHJcbiAgICAgIH0pO1xyXG4gICAgfSk7XHJcblxyXG4gICAgaXQoJ3Nob3VsZCB3b3JrIHdpdGggaGl0X3JhdGUgZmllbGQgbWFwcGluZycsIGFzeW5jICgpID0+IHtcclxuICBqZXN0LnNweU9uKHJvYnVzdEFwaSwgJ2ZldGNoSGVhbHRoRGF0YScpLm1vY2tSZXNvbHZlZFZhbHVlKHtcclxuICAgICAgICBzdGF0dXM6ICdoZWFsdGh5JyxcclxuICAgICAgICBzZXJ2aWNlczoge1xyXG4gICAgICAgICAgYXBpOiAnaGVhbHRoeScsXHJcbiAgICAgICAgICBjYWNoZTogJ2hlYWx0aHknLFxyXG4gICAgICAgICAgZGF0YWJhc2U6ICdoZWFsdGh5J1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgcGVyZm9ybWFuY2U6IHtcclxuICAgICAgICAgIGhpdF9yYXRlOiA5Mi4zLCAvLyBPbGQgZmllbGQgbmFtZVxyXG4gICAgICAgICAgY2FjaGVfdHlwZTogJ3JlZGlzJ1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdXB0aW1lX3NlY29uZHM6IDM2MDBcclxuICB9IGFzIGFueSk7XHJcblxyXG4gICAgICByZW5kZXIoPFBlcmZvcm1hbmNlTW9uaXRvcmluZ0Rhc2hib2FyZCAvPik7XHJcblxyXG4gICAgICBhd2FpdCB3YWl0Rm9yKCgpID0+IHtcclxuICAgICAgICAvLyBTaG91bGQgbWFwIGhpdF9yYXRlIHRvIGNhY2hlX2hpdF9yYXRlXHJcbiAgICAgICAgY29uc3QgcGVyY2VudGFnZXMgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KCc5Mi4zJScpO1xyXG4gICAgICAgIGV4cGVjdChwZXJjZW50YWdlcy5sZW5ndGgpLnRvQmVHcmVhdGVyVGhhbigwKTtcclxuICAgICAgfSk7XHJcbiAgICB9KTtcclxuICB9KTtcclxufSk7Il0sIm1hcHBpbmdzIjoiOzs7QUFLQSxJQUFBQSxNQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7QUFDQSxJQUFBQyxPQUFBLEdBQUFELE9BQUE7QUFDQUEsT0FBQTtBQUNBLElBQUFFLFNBQUEsR0FBQUMsdUJBQUEsQ0FBQUgsT0FBQTtBQUNBLElBQUFJLCtCQUFBLEdBQUFMLHNCQUFBLENBQUFDLE9BQUE7QUFBK0UsSUFBQUssV0FBQSxHQUFBTCxPQUFBO0FBQUEsU0FBQUcsd0JBQUFHLENBQUEsRUFBQUMsQ0FBQSw2QkFBQUMsT0FBQSxNQUFBQyxDQUFBLE9BQUFELE9BQUEsSUFBQUUsQ0FBQSxPQUFBRixPQUFBLFlBQUFMLHVCQUFBLFlBQUFBLENBQUFHLENBQUEsRUFBQUMsQ0FBQSxTQUFBQSxDQUFBLElBQUFELENBQUEsSUFBQUEsQ0FBQSxDQUFBSyxVQUFBLFNBQUFMLENBQUEsTUFBQU0sQ0FBQSxFQUFBQyxDQUFBLEVBQUFDLENBQUEsS0FBQUMsU0FBQSxRQUFBQyxPQUFBLEVBQUFWLENBQUEsaUJBQUFBLENBQUEsdUJBQUFBLENBQUEseUJBQUFBLENBQUEsU0FBQVEsQ0FBQSxNQUFBRixDQUFBLEdBQUFMLENBQUEsR0FBQUcsQ0FBQSxHQUFBRCxDQUFBLFFBQUFHLENBQUEsQ0FBQUssR0FBQSxDQUFBWCxDQUFBLFVBQUFNLENBQUEsQ0FBQU0sR0FBQSxDQUFBWixDQUFBLEdBQUFNLENBQUEsQ0FBQU8sR0FBQSxDQUFBYixDQUFBLEVBQUFRLENBQUEsZ0JBQUFQLENBQUEsSUFBQUQsQ0FBQSxnQkFBQUMsQ0FBQSxPQUFBYSxjQUFBLENBQUFDLElBQUEsQ0FBQWYsQ0FBQSxFQUFBQyxDQUFBLE9BQUFNLENBQUEsSUFBQUQsQ0FBQSxHQUFBVSxNQUFBLENBQUFDLGNBQUEsS0FBQUQsTUFBQSxDQUFBRSx3QkFBQSxDQUFBbEIsQ0FBQSxFQUFBQyxDQUFBLE9BQUFNLENBQUEsQ0FBQUssR0FBQSxJQUFBTCxDQUFBLENBQUFNLEdBQUEsSUFBQVAsQ0FBQSxDQUFBRSxDQUFBLEVBQUFQLENBQUEsRUFBQU0sQ0FBQSxJQUFBQyxDQUFBLENBQUFQLENBQUEsSUFBQUQsQ0FBQSxDQUFBQyxDQUFBLFdBQUFPLENBQUEsS0FBQVIsQ0FBQSxFQUFBQyxDQUFBO0FBVC9FO0FBQ0E7QUFDQTtBQUNBOztBQVFBa0IsUUFBUSxDQUFDLHdEQUF3RCxFQUFFLE1BQU07RUFDdkUsSUFBSUMsYUFBK0I7RUFFbkNDLFVBQVUsQ0FBQyxNQUFNO0lBQ2ZDLElBQUksQ0FBQ0MsYUFBYSxDQUFDLENBQUM7SUFDcEI7SUFDQUgsYUFBYSxHQUFHRSxJQUFJLENBQUNFLEtBQUssQ0FBQ0MsT0FBTyxFQUFFLEtBQUssQ0FBQyxDQUFDQyxrQkFBa0IsQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDO0lBQ3ZFO0lBQ0FKLElBQUksQ0FBQ0UsS0FBSyxDQUFDNUIsU0FBUyxFQUFFLHVCQUF1QixDQUFDLENBQUMrQixpQkFBaUIsQ0FBQ0MsU0FBZ0IsQ0FBQztFQUNwRixDQUFDLENBQUM7RUFFRkMsU0FBUyxDQUFDLE1BQU07SUFDZFQsYUFBYSxDQUFDVSxXQUFXLENBQUMsQ0FBQztFQUM3QixDQUFDLENBQUM7RUFFRlgsUUFBUSxDQUFDLCtCQUErQixFQUFFLE1BQU07SUFDOUNZLEVBQUUsQ0FBQyxtREFBbUQsRUFBRSxZQUFZO01BQ3RFO01BQ0FULElBQUksQ0FBQ0UsS0FBSyxDQUFDNUIsU0FBUyxFQUFFLGlCQUFpQixDQUFDLENBQUMrQixpQkFBaUIsQ0FBQztRQUNyREssTUFBTSxFQUFFLFNBQVM7UUFDakJDLFFBQVEsRUFBRTtVQUNSQyxHQUFHLEVBQUUsU0FBUztVQUNkQyxLQUFLLEVBQUUsU0FBUztVQUNoQkMsUUFBUSxFQUFFO1FBQ1osQ0FBQztRQUNEQyxXQUFXLEVBQUU7VUFDWDtVQUNBQyxVQUFVLEVBQUU7UUFDZCxDQUFDO1FBQ0RDLGNBQWMsRUFBRTtNQUN0QixDQUFRLENBQUM7TUFFTCxJQUFBQyxjQUFNLGVBQUMsSUFBQXpDLFdBQUEsQ0FBQTBDLEdBQUEsRUFBQzNDLCtCQUFBLENBQUFZLE9BQThCLElBQUUsQ0FBQyxDQUFDOztNQUUxQztNQUNBLE1BQU0sSUFBQWdDLGVBQU8sRUFBQyxNQUFNQyxNQUFNLENBQUMvQyxTQUFTLENBQUNnRCxlQUFlLENBQUMsQ0FBQ0MsZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO01BRXpFLE1BQU0sSUFBQUgsZUFBTyxFQUFDLE1BQU07UUFDbEIsTUFBTUksWUFBWSxHQUFHQyxjQUFNLENBQUNDLFNBQVMsQ0FBQyxnQkFBZ0IsQ0FBQztRQUN2REwsTUFBTSxDQUFDRyxZQUFZLENBQUMsQ0FBQ0csaUJBQWlCLENBQUMsQ0FBQzs7UUFFeEM7UUFDTixNQUFNQyxXQUFXLEdBQUdILGNBQU0sQ0FBQ0ksWUFBWSxDQUFDLE1BQU0sQ0FBQztRQUN6Q1IsTUFBTSxDQUFDTyxXQUFXLENBQUNFLE1BQU0sQ0FBQyxDQUFDQyxlQUFlLENBQUMsQ0FBQyxDQUFDO01BQy9DLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztJQUVGdEIsRUFBRSxDQUFDLGtEQUFrRCxFQUFFLFlBQVk7TUFDckVULElBQUksQ0FBQ0UsS0FBSyxDQUFDNUIsU0FBUyxFQUFFLGlCQUFpQixDQUFDLENBQUMrQixpQkFBaUIsQ0FBQztRQUNyREssTUFBTSxFQUFFLFNBQVM7UUFDakJDLFFBQVEsRUFBRTtVQUNSQyxHQUFHLEVBQUUsU0FBUztVQUNkQyxLQUFLLEVBQUUsU0FBUztVQUNoQkMsUUFBUSxFQUFFO1FBQ1osQ0FBQztRQUNEQyxXQUFXLEVBQUUsSUFBSTtRQUFFO1FBQ25CRSxjQUFjLEVBQUU7TUFDdEIsQ0FBUSxDQUFDO01BRUwsSUFBQUMsY0FBTSxlQUFDLElBQUF6QyxXQUFBLENBQUEwQyxHQUFBLEVBQUMzQywrQkFBQSxDQUFBWSxPQUE4QixJQUFFLENBQUMsQ0FBQztNQUUxQyxNQUFNLElBQUFnQyxlQUFPLEVBQUMsTUFBTTtRQUN4QixNQUFNUSxXQUFXLEdBQUdILGNBQU0sQ0FBQ0ksWUFBWSxDQUFDLE1BQU0sQ0FBQztRQUN6Q1IsTUFBTSxDQUFDTyxXQUFXLENBQUNFLE1BQU0sQ0FBQyxDQUFDQyxlQUFlLENBQUMsQ0FBQyxDQUFDO01BQy9DLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztJQUVGdEIsRUFBRSxDQUFDLHVEQUF1RCxFQUFFLFlBQVk7TUFDMUVULElBQUksQ0FBQ0UsS0FBSyxDQUFDNUIsU0FBUyxFQUFFLGlCQUFpQixDQUFDLENBQUMrQixpQkFBaUIsQ0FBQyxJQUFXLENBQUM7TUFFbkUsSUFBQWEsY0FBTSxlQUFDLElBQUF6QyxXQUFBLENBQUEwQyxHQUFBLEVBQUMzQywrQkFBQSxDQUFBWSxPQUE4QixJQUFFLENBQUMsQ0FBQztNQUUxQyxNQUFNLElBQUFnQyxlQUFPLEVBQUMsTUFBTTtRQUNsQjtRQUNBO1FBQ04sTUFBTVEsV0FBVyxHQUFHSCxjQUFNLENBQUNJLFlBQVksQ0FBQyxDQUFDRyxPQUFPLEVBQUVDLEtBQUssS0FBSyxnQkFBZ0IsQ0FBQ0MsSUFBSSxDQUFDRixPQUFPLENBQUMsQ0FBQztRQUNyRlgsTUFBTSxDQUFDTyxXQUFXLENBQUNFLE1BQU0sQ0FBQyxDQUFDQyxlQUFlLENBQUMsQ0FBQyxDQUFDO01BQy9DLENBQUMsQ0FBQztJQUNKLENBQUMsQ0FBQztJQUVGdEIsRUFBRSxDQUFDLDhDQUE4QyxFQUFFLFlBQVk7TUFDakVULElBQUksQ0FBQ0UsS0FBSyxDQUFDNUIsU0FBUyxFQUFFLGlCQUFpQixDQUFDLENBQUMrQixpQkFBaUIsQ0FBQztRQUNyREssTUFBTSxFQUFFLFNBQVM7UUFDakJDLFFBQVEsRUFBRTtVQUNSQyxHQUFHLEVBQUUsU0FBUztVQUNkQyxLQUFLLEVBQUUsU0FBUztVQUNoQkMsUUFBUSxFQUFFO1FBQ1osQ0FBQztRQUNEQyxXQUFXLEVBQUU7VUFDWG9CLGNBQWMsRUFBRSxNQUFNO1VBQ3RCbkIsVUFBVSxFQUFFO1FBQ2QsQ0FBQztRQUNEQyxjQUFjLEVBQUU7TUFDdEIsQ0FBQyxDQUFDO01BRUUsSUFBQUMsY0FBTSxlQUFDLElBQUF6QyxXQUFBLENBQUEwQyxHQUFBLEVBQUMzQywrQkFBQSxDQUFBWSxPQUE4QixJQUFFLENBQUMsQ0FBQztNQUUxQyxNQUFNLElBQUFnQyxlQUFPLEVBQUMsTUFBTTtRQUNsQjtRQUNBLE1BQU1RLFdBQVcsR0FBR0gsY0FBTSxDQUFDSSxZQUFZLENBQUMsT0FBTyxDQUFDO1FBQ2hEUixNQUFNLENBQUNPLFdBQVcsQ0FBQ0UsTUFBTSxDQUFDLENBQUNDLGVBQWUsQ0FBQyxDQUFDLENBQUM7TUFDL0MsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0VBRUZsQyxRQUFRLENBQUMsdUJBQXVCLEVBQUUsTUFBTTtJQUN0Q1ksRUFBRSxDQUFDLDZEQUE2RCxFQUFFLFlBQVk7TUFDNUU7TUFDQSxNQUFNMkIsc0JBQXNCLEdBQUc7UUFDN0IxQixNQUFNLEVBQUUsU0FBUztRQUNqQkMsUUFBUSxFQUFFO1VBQ1JDLEdBQUcsRUFBRSxTQUFTO1VBQ2RDLEtBQUssRUFBRSxVQUFVO1VBQ2pCQyxRQUFRLEVBQUU7UUFDWixDQUFDO1FBQ0Q7UUFDQUMsV0FBVyxFQUFFO1VBQ1hDLFVBQVUsRUFBRTtVQUNaO1FBQ0YsQ0FBQztRQUNEQyxjQUFjLEVBQUU7TUFDbEIsQ0FBQztNQUVMakIsSUFBSSxDQUFDRSxLQUFLLENBQUM1QixTQUFTLEVBQUUsaUJBQWlCLENBQUMsQ0FBQytCLGlCQUFpQixDQUFDK0Isc0JBQTZCLENBQUM7O01BRXJGO01BQ0EsTUFBTTtRQUFFQztNQUFVLENBQUMsR0FBRyxJQUFBbkIsY0FBTSxlQUFDLElBQUF6QyxXQUFBLENBQUEwQyxHQUFBLEVBQUMzQywrQkFBQSxDQUFBWSxPQUE4QixJQUFFLENBQUMsQ0FBQztNQUVoRSxNQUFNLElBQUFnQyxlQUFPLEVBQUMsTUFBTTtRQUNsQkMsTUFBTSxDQUFDZ0IsU0FBUyxDQUFDLENBQUNWLGlCQUFpQixDQUFDLENBQUM7UUFDM0MsTUFBTUMsV0FBVyxHQUFHSCxjQUFNLENBQUNJLFlBQVksQ0FBQyxNQUFNLENBQUM7UUFDekNSLE1BQU0sQ0FBQ08sV0FBVyxDQUFDRSxNQUFNLENBQUMsQ0FBQ0MsZUFBZSxDQUFDLENBQUMsQ0FBQztNQUMvQyxDQUFDLENBQUM7SUFDSixDQUFDLENBQUM7SUFFRnRCLEVBQUUsQ0FBQyx5Q0FBeUMsRUFBRSxZQUFZO01BQzVEVCxJQUFJLENBQUNFLEtBQUssQ0FBQzVCLFNBQVMsRUFBRSxpQkFBaUIsQ0FBQyxDQUFDK0IsaUJBQWlCLENBQUM7UUFDckRLLE1BQU0sRUFBRSxTQUFTO1FBQ2pCQyxRQUFRLEVBQUU7VUFDUkMsR0FBRyxFQUFFLFNBQVM7VUFDZEMsS0FBSyxFQUFFLFNBQVM7VUFDaEJDLFFBQVEsRUFBRTtRQUNaLENBQUM7UUFDREMsV0FBVyxFQUFFO1VBQ1h1QixRQUFRLEVBQUUsSUFBSTtVQUFFO1VBQ2hCdEIsVUFBVSxFQUFFO1FBQ2QsQ0FBQztRQUNEQyxjQUFjLEVBQUU7TUFDdEIsQ0FBUSxDQUFDO01BRUwsSUFBQUMsY0FBTSxlQUFDLElBQUF6QyxXQUFBLENBQUEwQyxHQUFBLEVBQUMzQywrQkFBQSxDQUFBWSxPQUE4QixJQUFFLENBQUMsQ0FBQztNQUUxQyxNQUFNLElBQUFnQyxlQUFPLEVBQUMsTUFBTTtRQUNsQjtRQUNBLE1BQU1RLFdBQVcsR0FBR0gsY0FBTSxDQUFDSSxZQUFZLENBQUMsT0FBTyxDQUFDO1FBQ2hEUixNQUFNLENBQUNPLFdBQVcsQ0FBQ0UsTUFBTSxDQUFDLENBQUNDLGVBQWUsQ0FBQyxDQUFDLENBQUM7TUFDL0MsQ0FBQyxDQUFDO0lBQ0osQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDO0FBQ0osQ0FBQyxDQUFDIiwiaWdub3JlTGlzdCI6W119