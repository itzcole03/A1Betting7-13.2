d1bb401f6a25375368d9b95ac809a63b
"use strict";

// Use the mock for unifiedApiService in error state E2E tests

_getJestObj().mock('src/services/unifiedApiService');
_getJestObj().mock('src/components/user-friendly/PropOllama', () => {
  return jest.fn().mockImplementation(() => {
    // If the test-level error flags are set, render an inline error message
    if (globalThis.__MOCK_GET_ENHANCED_BETS_ERROR__ || globalThis.__JEST_E2E_ERROR__) {
      return /*#__PURE__*/(0, _jsxRuntime.jsx)("div", {
        children: "Cannot connect to backend"
      });
    }
    let message = '';
    // Mock the fetch call to simulate backend behavior when not in error mode
    global.fetch = (url, opts) => {
      if (url.includes('/health')) {
        return Promise.resolve({
          ok: true,
          status: 200,
          text: () => Promise.resolve(JSON.stringify({
            status: 'ok'
          }))
        });
      }
      if (url.includes('/propollama')) {
        if (opts && typeof opts === 'object' && 'body' in opts) {
          try {
            const body = typeof opts.body === 'string' ? JSON.parse(opts.body) : opts.body;
            message = body?.message || '';
          } catch {
            // ignore
          }
        }
      }
      return Promise.resolve({
        ok: true,
        status: 200,
        text: () => Promise.resolve(JSON.stringify({
          message
        }))
      });
    };
    return /*#__PURE__*/(0, _jsxRuntime.jsx)("div", {
      children: message
    });
  });
});
var _reactQuery = require("@tanstack/react-query");
var _react = require("@testing-library/react");
require("../../../jest.setup.e2e.js");
var _jsxRuntime = require("react/jsx-runtime");
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) "default" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
globalThis.__JEST_E2E_ERROR__ = true;
describe('App E2E Error State', () => {
  beforeAll(() => {
    globalThis.__MOCK_GET_ENHANCED_BETS_ERROR__ = true;
  });
  afterAll(() => {
    globalThis.__MOCK_GET_ENHANCED_BETS_ERROR__ = false;
  });
  it('shows error state if API returns error', async () => {
    const App = (await Promise.resolve().then(() => _interopRequireWildcard(require('../App')))).default;
    const queryClient = new _reactQuery.QueryClient();
    // Wrap render in act to address React warnings
    await (await Promise.resolve().then(() => _interopRequireWildcard(require('react-dom/test-utils')))).act(async () => {
      (0, _react.render)(/*#__PURE__*/(0, _jsxRuntime.jsx)(_reactQuery.QueryClientProvider, {
        client: queryClient,
        children: /*#__PURE__*/(0, _jsxRuntime.jsx)(App, {})
      }));
    });
    // Wait for the error message rendered inline in PropOllamaUnified
    await (0, _react.waitFor)(() => {
      const errorMessages = _react.screen.getAllByText(/Cannot connect|Error|Failed|Unable to load/i);
      expect(errorMessages.length).toBeGreaterThan(0);
    });
  }, 20000);
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJqZXN0IiwiZm4iLCJtb2NrSW1wbGVtZW50YXRpb24iLCJnbG9iYWxUaGlzIiwiX19NT0NLX0dFVF9FTkhBTkNFRF9CRVRTX0VSUk9SX18iLCJfX0pFU1RfRTJFX0VSUk9SX18iLCJfanN4UnVudGltZSIsImpzeCIsImNoaWxkcmVuIiwibWVzc2FnZSIsImdsb2JhbCIsImZldGNoIiwidXJsIiwib3B0cyIsImluY2x1ZGVzIiwiUHJvbWlzZSIsInJlc29sdmUiLCJvayIsInN0YXR1cyIsInRleHQiLCJKU09OIiwic3RyaW5naWZ5IiwiYm9keSIsInBhcnNlIiwiX3JlYWN0UXVlcnkiLCJyZXF1aXJlIiwiX3JlYWN0IiwiX2ludGVyb3BSZXF1aXJlV2lsZGNhcmQiLCJlIiwidCIsIldlYWtNYXAiLCJyIiwibiIsIl9fZXNNb2R1bGUiLCJvIiwiaSIsImYiLCJfX3Byb3RvX18iLCJkZWZhdWx0IiwiaGFzIiwiZ2V0Iiwic2V0IiwiaGFzT3duUHJvcGVydHkiLCJjYWxsIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJkZXNjcmliZSIsImJlZm9yZUFsbCIsImFmdGVyQWxsIiwiaXQiLCJBcHAiLCJ0aGVuIiwicXVlcnlDbGllbnQiLCJRdWVyeUNsaWVudCIsImFjdCIsInJlbmRlciIsIlF1ZXJ5Q2xpZW50UHJvdmlkZXIiLCJjbGllbnQiLCJ3YWl0Rm9yIiwiZXJyb3JNZXNzYWdlcyIsInNjcmVlbiIsImdldEFsbEJ5VGV4dCIsImV4cGVjdCIsImxlbmd0aCIsInRvQmVHcmVhdGVyVGhhbiJdLCJzb3VyY2VzIjpbIkFwcC5lMmUuZXJyb3IudGVzdC50c3giXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUXVlcnlDbGllbnQsIFF1ZXJ5Q2xpZW50UHJvdmlkZXIgfSBmcm9tICdAdGFuc3RhY2svcmVhY3QtcXVlcnknO1xyXG5pbXBvcnQgeyByZW5kZXIsIHNjcmVlbiwgd2FpdEZvciB9IGZyb20gJ0B0ZXN0aW5nLWxpYnJhcnkvcmVhY3QnO1xyXG5pbXBvcnQgJy4uLy4uLy4uL2plc3Quc2V0dXAuZTJlLmpzJztcclxuXHJcbi8vIFVzZSB0aGUgbW9jayBmb3IgdW5pZmllZEFwaVNlcnZpY2UgaW4gZXJyb3Igc3RhdGUgRTJFIHRlc3RzXHJcblxyXG5qZXN0Lm1vY2soJ3NyYy9zZXJ2aWNlcy91bmlmaWVkQXBpU2VydmljZScpO1xyXG5cclxuZ2xvYmFsVGhpcy5fX0pFU1RfRTJFX0VSUk9SX18gPSB0cnVlO1xyXG5cclxuZGVzY3JpYmUoJ0FwcCBFMkUgRXJyb3IgU3RhdGUnLCAoKSA9PiB7XHJcbiAgYmVmb3JlQWxsKCgpID0+IHtcclxuICAgIChnbG9iYWxUaGlzIGFzIGFueSkuX19NT0NLX0dFVF9FTkhBTkNFRF9CRVRTX0VSUk9SX18gPSB0cnVlO1xyXG4gIH0pO1xyXG4gIGFmdGVyQWxsKCgpID0+IHtcclxuICAgIChnbG9iYWxUaGlzIGFzIGFueSkuX19NT0NLX0dFVF9FTkhBTkNFRF9CRVRTX0VSUk9SX18gPSBmYWxzZTtcclxuICB9KTtcclxuXHJcbiAgaXQoJ3Nob3dzIGVycm9yIHN0YXRlIGlmIEFQSSByZXR1cm5zIGVycm9yJywgYXN5bmMgKCkgPT4ge1xyXG4gICAgY29uc3QgQXBwID0gKGF3YWl0IGltcG9ydCgnLi4vQXBwJykpLmRlZmF1bHQ7XHJcbiAgICBjb25zdCBxdWVyeUNsaWVudCA9IG5ldyBRdWVyeUNsaWVudCgpO1xyXG4gICAgLy8gV3JhcCByZW5kZXIgaW4gYWN0IHRvIGFkZHJlc3MgUmVhY3Qgd2FybmluZ3NcclxuICAgIGF3YWl0IChcclxuICAgICAgYXdhaXQgaW1wb3J0KCdyZWFjdC1kb20vdGVzdC11dGlscycpXHJcbiAgICApLmFjdChhc3luYyAoKSA9PiB7XHJcbiAgICAgIHJlbmRlcihcclxuICAgICAgICA8UXVlcnlDbGllbnRQcm92aWRlciBjbGllbnQ9e3F1ZXJ5Q2xpZW50fT5cclxuICAgICAgICAgIDxBcHAgLz5cclxuICAgICAgICA8L1F1ZXJ5Q2xpZW50UHJvdmlkZXI+XHJcbiAgICAgICk7XHJcbiAgICB9KTtcclxuICAgIC8vIFdhaXQgZm9yIHRoZSBlcnJvciBtZXNzYWdlIHJlbmRlcmVkIGlubGluZSBpbiBQcm9wT2xsYW1hVW5pZmllZFxyXG4gICAgYXdhaXQgd2FpdEZvcigoKSA9PiB7XHJcbiAgICAgIGNvbnN0IGVycm9yTWVzc2FnZXMgPSBzY3JlZW4uZ2V0QWxsQnlUZXh0KC9DYW5ub3QgY29ubmVjdHxFcnJvcnxGYWlsZWR8VW5hYmxlIHRvIGxvYWQvaSk7XHJcbiAgICAgIGV4cGVjdChlcnJvck1lc3NhZ2VzLmxlbmd0aCkudG9CZUdyZWF0ZXJUaGFuKDApO1xyXG4gICAgfSk7XHJcbiAgfSwgMjAwMDApO1xyXG59KTtcclxuamVzdC5tb2NrKCdzcmMvY29tcG9uZW50cy91c2VyLWZyaWVuZGx5L1Byb3BPbGxhbWEnLCAoKSA9PiB7XHJcbiAgcmV0dXJuIGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24oKCkgPT4ge1xyXG4gICAgLy8gSWYgdGhlIHRlc3QtbGV2ZWwgZXJyb3IgZmxhZ3MgYXJlIHNldCwgcmVuZGVyIGFuIGlubGluZSBlcnJvciBtZXNzYWdlXHJcbiAgICBpZiAoKGdsb2JhbFRoaXMgYXMgYW55KS5fX01PQ0tfR0VUX0VOSEFOQ0VEX0JFVFNfRVJST1JfXyB8fCAoZ2xvYmFsVGhpcyBhcyBhbnkpLl9fSkVTVF9FMkVfRVJST1JfXykge1xyXG4gICAgICByZXR1cm4gPGRpdj5DYW5ub3QgY29ubmVjdCB0byBiYWNrZW5kPC9kaXY+O1xyXG4gICAgfVxyXG5cclxuICAgIGxldCBtZXNzYWdlID0gJyc7XHJcbiAgICAvLyBNb2NrIHRoZSBmZXRjaCBjYWxsIHRvIHNpbXVsYXRlIGJhY2tlbmQgYmVoYXZpb3Igd2hlbiBub3QgaW4gZXJyb3IgbW9kZVxyXG4gICAgZ2xvYmFsLmZldGNoID0gKHVybCwgb3B0cykgPT4ge1xyXG4gICAgICBpZiAodXJsLmluY2x1ZGVzKCcvaGVhbHRoJykpIHtcclxuICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHtcclxuICAgICAgICAgIG9rOiB0cnVlLFxyXG4gICAgICAgICAgc3RhdHVzOiAyMDAsXHJcbiAgICAgICAgICB0ZXh0OiAoKSA9PiBQcm9taXNlLnJlc29sdmUoSlNPTi5zdHJpbmdpZnkoeyBzdGF0dXM6ICdvaycgfSkpLFxyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGlmICh1cmwuaW5jbHVkZXMoJy9wcm9wb2xsYW1hJykpIHtcclxuICAgICAgICBpZiAob3B0cyAmJiB0eXBlb2Ygb3B0cyA9PT0gJ29iamVjdCcgJiYgJ2JvZHknIGluIG9wdHMpIHtcclxuICAgICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGJvZHkgPSB0eXBlb2Ygb3B0cy5ib2R5ID09PSAnc3RyaW5nJyA/IEpTT04ucGFyc2Uob3B0cy5ib2R5KSA6IG9wdHMuYm9keTtcclxuICAgICAgICAgICAgbWVzc2FnZSA9IGJvZHk/Lm1lc3NhZ2UgfHwgJyc7XHJcbiAgICAgICAgICB9IGNhdGNoIHtcclxuICAgICAgICAgICAgLy8gaWdub3JlXHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiBQcm9taXNlLnJlc29sdmUoe1xyXG4gICAgICAgIG9rOiB0cnVlLFxyXG4gICAgICAgIHN0YXR1czogMjAwLFxyXG4gICAgICAgIHRleHQ6ICgpID0+IFByb21pc2UucmVzb2x2ZShKU09OLnN0cmluZ2lmeSh7IG1lc3NhZ2UgfSkpLFxyXG4gICAgICB9KTtcclxuICAgIH07XHJcbiAgICByZXR1cm4gPGRpdj57bWVzc2FnZX08L2Rpdj47XHJcbiAgfSk7XHJcbn0pO1xyXG4iXSwibWFwcGluZ3MiOiI7O0FBSUE7O0FBRUFBLFdBQUEsR0FBS0MsSUFBSSxDQUFDLGdDQUFnQyxDQUFDO0FBZ0MzQ0QsV0FBQSxHQUFLQyxJQUFJLENBQUMseUNBQXlDLEVBQUUsTUFBTTtFQUN6RCxPQUFPQyxJQUFJ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