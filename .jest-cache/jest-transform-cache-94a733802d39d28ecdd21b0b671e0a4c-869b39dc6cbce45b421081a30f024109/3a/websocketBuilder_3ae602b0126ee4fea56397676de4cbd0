c10bec83985a761b74b9e4f0e786be6a
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.buildWebSocketUrl = buildWebSocketUrl;
exports.getOrPersistClientId = getOrPersistClientId;
exports.resolveWebSocketBase = resolveWebSocketBase;
exports.validateWebSocketUrl = validateWebSocketUrl;
/**
 * Canonical WebSocket URL Builder
 * Single source of truth for WebSocket URL construction
 */

// Client ID persistence utility
function getOrPersistClientId(storageKey = 'ws_client_id', passedClientId) {
  let clientId = passedClientId;

  // Try to get from storage first
  const storedClientId = window.localStorage.getItem(storageKey);
  const initialFromStorage = !!storedClientId;
  if (!clientId && storedClientId) {
    clientId = storedClientId;
  }

  // Generate new one if none available
  if (!clientId) {
    clientId = `client_${Math.random().toString(36).substr(2, 9)}`;
  }

  // Always persist to storage
  window.localStorage.setItem(storageKey, clientId);

  // Dev-only diagnostic log
  const _import_meta_env = globalThis.importMeta?.env || global.importMeta?.env || (typeof window !== 'undefined' ? window.import?.meta?.env : undefined) || {};
  if (_import_meta_env.DEV) {
    // eslint-disable-next-line no-console
    console.log('[ClientIdDiag]', {
      initialFromStorage,
      passedIn: !!passedClientId,
      finalClientId: clientId
    });
  }
  return clientId;
}

// Environment resolution helper
function resolveWebSocketBase() {
  const _import_meta_env2 = globalThis.importMeta?.env || global.importMeta?.env || (typeof window !== 'undefined' ? window.import?.meta?.env : undefined) || {};
  let baseUrl = _import_meta_env2.VITE_WS_URL;

  // Check for legacy path in environment and sanitize
  if (baseUrl && baseUrl.includes('client_/ws')) {
    // eslint-disable-next-line no-console
    console.warn('[EnvDiag][LegacyInEnv] Legacy WebSocket path detected in environment, sanitizing:', baseUrl);
    baseUrl = baseUrl.replace(/\/client_\/ws.*$/, '');
  }

  // Default fallback
  if (!baseUrl) {
    const protocol = window.location.protocol === 'https:' ? 'wss:' : 'ws:';
    const host = window.location.hostname;
    const port = host === 'localhost' ? '8000' : window.location.port;
    baseUrl = `${protocol}//${host}${port ? `:${port}` : ''}`;
  }
  return baseUrl;
}

/**
 * Canonical WebSocket URL Builder
 * MUST be used for all WebSocket URL construction
 */
function buildWebSocketUrl(options = {}) {
  const {
    clientId: providedClientId,
    role = 'frontend',
    version = 1,
    baseUrl: providedBaseUrl
  } = options;

  // Resolve base URL
  const baseUrl = providedBaseUrl || resolveWebSocketBase();

  // Runtime-safe import.meta.env accessor for DEV checks inside this function
  const _import_meta_env2 = globalThis.importMeta?.env || global.importMeta?.env || (typeof window !== 'undefined' ? window.import?.meta?.env : undefined) || {};

  // Get or generate client ID
  const clientId = getOrPersistClientId('ws_client_id', providedClientId);
  try {
    // Use URL constructor for robust path building
    const url = new URL('/ws/client', baseUrl);
    url.searchParams.set('client_id', clientId);
    url.searchParams.set('version', String(version));
    url.searchParams.set('role', role);
    const result = url.toString();

    // Defensive assertion - dev only
    if (_import_meta_env2.DEV) {
      if (result.includes('client_/ws')) {
        // eslint-disable-next-line no-console
        console.error('[WSBuildDiag][LegacyDetected]', {
          url: result,
          stack: new Error().stack
        });
        throw new Error('Legacy websocket path constructed after migration');
      }

      // eslint-disable-next-line no-console
      console.log('[WSBuildDiag] Built canonical WebSocket URL:', result);
    }
    return result;
  } catch (error) {
    // Fallback with defensive assertion
    const params = new URLSearchParams();
    params.set('client_id', clientId);
    params.set('version', String(version));
    params.set('role', role);
    const fallbackUrl = `${baseUrl}/ws/client?${params.toString()}`;

    // Defensive assertion on fallback too
    if (_import_meta_env2.DEV && fallbackUrl.includes('client_/ws')) {
      // eslint-disable-next-line no-console
      console.error('[WSBuildDiag][LegacyDetected] Even fallback created legacy path!', {
        url: fallbackUrl,
        error,
        stack: new Error().stack
      });
      throw new Error('Legacy websocket path constructed in fallback after migration');
    }
    if (_import_meta_env2.DEV) {
      // eslint-disable-next-line no-console
      console.warn('[WSBuildDiag] URL constructor failed, using fallback:', fallbackUrl, error);
    }
    return fallbackUrl;
  }
}

// Validate that a URL doesn't contain legacy patterns
function validateWebSocketUrl(url) {
  return !url.includes('client_/ws');
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJnZXRPclBlcnNpc3RDbGllbnRJZCIsInN0b3JhZ2VLZXkiLCJwYXNzZWRDbGllbnRJZCIsImNsaWVudElkIiwic3RvcmVkQ2xpZW50SWQiLCJ3aW5kb3ciLCJsb2NhbFN0b3JhZ2UiLCJnZXRJdGVtIiwiaW5pdGlhbEZyb21TdG9yYWdlIiwiTWF0aCIsInJhbmRvbSIsInRvU3RyaW5nIiwic3Vic3RyIiwic2V0SXRlbSIsIl9pbXBvcnRfbWV0YV9lbnYiLCJnbG9iYWxUaGlzIiwiaW1wb3J0TWV0YSIsImVudiIsImdsb2JhbCIsImltcG9ydCIsIm1ldGEiLCJ1bmRlZmluZWQiLCJERVYiLCJjb25zb2xlIiwibG9nIiwicGFzc2VkSW4iLCJmaW5hbENsaWVudElkIiwicmVzb2x2ZVdlYlNvY2tldEJhc2UiLCJfaW1wb3J0X21ldGFfZW52MiIsImJhc2VVcmwiLCJWSVRFX1dTX1VSTCIsImluY2x1ZGVzIiwid2FybiIsInJlcGxhY2UiLCJwcm90b2NvbCIsImxvY2F0aW9uIiwiaG9zdCIsImhvc3RuYW1lIiwicG9ydCIsImJ1aWxkV2ViU29ja2V0VXJsIiwib3B0aW9ucyIsInByb3ZpZGVkQ2xpZW50SWQiLCJyb2xlIiwidmVyc2lvbiIsInByb3ZpZGVkQmFzZVVybCIsInVybCIsIlVSTCIsInNlYXJjaFBhcmFtcyIsInNldCIsIlN0cmluZyIsInJlc3VsdCIsImVycm9yIiwic3RhY2siLCJFcnJvciIsInBhcmFtcyIsIlVSTFNlYXJjaFBhcmFtcyIsImZhbGxiYWNrVXJsIiwidmFsaWRhdGVXZWJTb2NrZXRVcmwiXSwic291cmNlcyI6WyJ3ZWJzb2NrZXRCdWlsZGVyLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDYW5vbmljYWwgV2ViU29ja2V0IFVSTCBCdWlsZGVyXHJcbiAqIFNpbmdsZSBzb3VyY2Ugb2YgdHJ1dGggZm9yIFdlYlNvY2tldCBVUkwgY29uc3RydWN0aW9uXHJcbiAqL1xyXG5cclxuaW50ZXJmYWNlIFdlYlNvY2tldFVybE9wdGlvbnMge1xyXG4gIGNsaWVudElkPzogc3RyaW5nO1xyXG4gIHJvbGU/OiBzdHJpbmc7XHJcbiAgdmVyc2lvbj86IG51bWJlcjtcclxuICBiYXNlVXJsPzogc3RyaW5nO1xyXG59XHJcblxyXG4vLyBDbGllbnQgSUQgcGVyc2lzdGVuY2UgdXRpbGl0eVxyXG5leHBvcnQgZnVuY3Rpb24gZ2V0T3JQZXJzaXN0Q2xpZW50SWQoc3RvcmFnZUtleSA9ICd3c19jbGllbnRfaWQnLCBwYXNzZWRDbGllbnRJZD86IHN0cmluZyk6IHN0cmluZyB7XHJcbiAgbGV0IGNsaWVudElkID0gcGFzc2VkQ2xpZW50SWQ7XHJcbiAgXHJcbiAgLy8gVHJ5IHRvIGdldCBmcm9tIHN0b3JhZ2UgZmlyc3RcclxuICBjb25zdCBzdG9yZWRDbGllbnRJZCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbShzdG9yYWdlS2V5KTtcclxuICBjb25zdCBpbml0aWFsRnJvbVN0b3JhZ2UgPSAhIXN0b3JlZENsaWVudElkO1xyXG4gIFxyXG4gIGlmICghY2xpZW50SWQgJiYgc3RvcmVkQ2xpZW50SWQpIHtcclxuICAgIGNsaWVudElkID0gc3RvcmVkQ2xpZW50SWQ7XHJcbiAgfVxyXG4gIFxyXG4gIC8vIEdlbmVyYXRlIG5ldyBvbmUgaWYgbm9uZSBhdmFpbGFibGVcclxuICBpZiAoIWNsaWVudElkKSB7XHJcbiAgICBjbGllbnRJZCA9IGBjbGllbnRfJHtNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHIoMiwgOSl9YDtcclxuICB9XHJcbiAgXHJcbiAgLy8gQWx3YXlzIHBlcnNpc3QgdG8gc3RvcmFnZVxyXG4gIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShzdG9yYWdlS2V5LCBjbGllbnRJZCk7XHJcbiAgXHJcbiAgLy8gRGV2LW9ubHkgZGlhZ25vc3RpYyBsb2dcclxuICBjb25zdCBfaW1wb3J0X21ldGFfZW52ID0gKGdsb2JhbFRoaXMgYXMgYW55KS5pbXBvcnRNZXRhPy5lbnYgfHwgKGdsb2JhbCBhcyBhbnkpLmltcG9ydE1ldGE/LmVudiB8fCAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyAod2luZG93IGFzIGFueSkuaW1wb3J0Py5tZXRhPy5lbnYgOiB1bmRlZmluZWQpIHx8IHt9O1xyXG5cclxuICBpZiAoX2ltcG9ydF9tZXRhX2Vudi5ERVYpIHtcclxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICBjb25zb2xlLmxvZygnW0NsaWVudElkRGlhZ10nLCB7XHJcbiAgICAgIGluaXRpYWxGcm9tU3RvcmFnZSxcclxuICAgICAgcGFzc2VkSW46ICEhcGFzc2VkQ2xpZW50SWQsXHJcbiAgICAgIGZpbmFsQ2xpZW50SWQ6IGNsaWVudElkXHJcbiAgICB9KTtcclxuICB9XHJcbiAgXHJcbiAgcmV0dXJuIGNsaWVudElkO1xyXG59XHJcblxyXG4vLyBFbnZpcm9ubWVudCByZXNvbHV0aW9uIGhlbHBlclxyXG5leHBvcnQgZnVuY3Rpb24gcmVzb2x2ZVdlYlNvY2tldEJhc2UoKTogc3RyaW5nIHtcclxuICBjb25zdCBfaW1wb3J0X21ldGFfZW52MiA9IChnbG9iYWxUaGlzIGFzIGFueSkuaW1wb3J0TWV0YT8uZW52IHx8IChnbG9iYWwgYXMgYW55KS5pbXBvcnRNZXRhPy5lbnYgfHwgKHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gKHdpbmRvdyBhcyBhbnkpLmltcG9ydD8ubWV0YT8uZW52IDogdW5kZWZpbmVkKSB8fCB7fTtcclxuXHJcbiAgbGV0IGJhc2VVcmwgPSBfaW1wb3J0X21ldGFfZW52Mi5WSVRFX1dTX1VSTDtcclxuICBcclxuICAvLyBDaGVjayBmb3IgbGVnYWN5IHBhdGggaW4gZW52aXJvbm1lbnQgYW5kIHNhbml0aXplXHJcbiAgaWYgKGJhc2VVcmwgJiYgYmFzZVVybC5pbmNsdWRlcygnY2xpZW50Xy93cycpKSB7XHJcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgY29uc29sZS53YXJuKCdbRW52RGlhZ11bTGVnYWN5SW5FbnZdIExlZ2FjeSBXZWJTb2NrZXQgcGF0aCBkZXRlY3RlZCBpbiBlbnZpcm9ubWVudCwgc2FuaXRpemluZzonLCBiYXNlVXJsKTtcclxuICAgIGJhc2VVcmwgPSBiYXNlVXJsLnJlcGxhY2UoL1xcL2NsaWVudF9cXC93cy4qJC8sICcnKTtcclxuICB9XHJcbiAgXHJcbiAgLy8gRGVmYXVsdCBmYWxsYmFja1xyXG4gIGlmICghYmFzZVVybCkge1xyXG4gICAgY29uc3QgcHJvdG9jb2wgPSB3aW5kb3cubG9jYXRpb24ucHJvdG9jb2wgPT09ICdodHRwczonID8gJ3dzczonIDogJ3dzOic7XHJcbiAgICBjb25zdCBob3N0ID0gd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lO1xyXG4gICAgY29uc3QgcG9ydCA9IGhvc3QgPT09ICdsb2NhbGhvc3QnID8gJzgwMDAnIDogd2luZG93LmxvY2F0aW9uLnBvcnQ7XHJcbiAgICBiYXNlVXJsID0gYCR7cHJvdG9jb2x9Ly8ke2hvc3R9JHtwb3J0ID8gYDoke3BvcnR9YCA6ICcnfWA7XHJcbiAgfVxyXG4gIFxyXG4gIHJldHVybiBiYXNlVXJsO1xyXG59XHJcblxyXG4vKipcclxuICogQ2Fub25pY2FsIFdlYlNvY2tldCBVUkwgQnVpbGRlclxyXG4gKiBNVVNUIGJlIHVzZWQgZm9yIGFsbCBXZWJTb2NrZXQgVVJMIGNvbnN0cnVjdGlvblxyXG4gKi9cclxuZXhwb3J0IGZ1bmN0aW9uIGJ1aWxkV2ViU29ja2V0VXJsKG9wdGlvbnM6IFdlYlNvY2tldFVybE9wdGlvbnMgPSB7fSk6IHN0cmluZyB7XHJcbiAgY29uc3Qge1xyXG4gICAgY2xpZW50SWQ6IHByb3ZpZGVkQ2xpZW50SWQsXHJcbiAgICByb2xlID0gJ2Zyb250ZW5kJyxcclxuICAgIHZlcnNpb24gPSAxLFxyXG4gICAgYmFzZVVybDogcHJvdmlkZWRCYXNlVXJsXHJcbiAgfSA9IG9wdGlvbnM7XHJcbiAgXHJcbiAgLy8gUmVzb2x2ZSBiYXNlIFVSTFxyXG4gIGNvbnN0IGJhc2VVcmwgPSBwcm92aWRlZEJhc2VVcmwgfHwgcmVzb2x2ZVdlYlNvY2tldEJhc2UoKTtcclxuXHJcbiAgLy8gUnVudGltZS1zYWZlIGltcG9ydC5tZXRhLmVudiBhY2Nlc3NvciBmb3IgREVWIGNoZWNrcyBpbnNpZGUgdGhpcyBmdW5jdGlvblxyXG4gIGNvbnN0IF9pbXBvcnRfbWV0YV9lbnYyID0gKGdsb2JhbFRoaXMgYXMgYW55KS5pbXBvcnRNZXRhPy5lbnYgfHwgKGdsb2JhbCBhcyBhbnkpLmltcG9ydE1ldGE/LmVudiB8fCAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyAod2luZG93IGFzIGFueSkuaW1wb3J0Py5tZXRhPy5lbnYgOiB1bmRlZmluZWQpIHx8IHt9O1xyXG4gIFxyXG4gIC8vIEdldCBvciBnZW5lcmF0ZSBjbGllbnQgSURcclxuICBjb25zdCBjbGllbnRJZCA9IGdldE9yUGVyc2lzdENsaWVudElkKCd3c19jbGllbnRfaWQnLCBwcm92aWRlZENsaWVudElkKTtcclxuICBcclxuICB0cnkge1xyXG4gICAgLy8gVXNlIFVSTCBjb25zdHJ1Y3RvciBmb3Igcm9idXN0IHBhdGggYnVpbGRpbmdcclxuICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoJy93cy9jbGllbnQnLCBiYXNlVXJsKTtcclxuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KCdjbGllbnRfaWQnLCBjbGllbnRJZCk7XHJcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgndmVyc2lvbicsIFN0cmluZyh2ZXJzaW9uKSk7XHJcbiAgICB1cmwuc2VhcmNoUGFyYW1zLnNldCgncm9sZScsIHJvbGUpO1xyXG4gICAgXHJcbiAgICBjb25zdCByZXN1bHQgPSB1cmwudG9TdHJpbmcoKTtcclxuICAgIFxyXG4gICAgLy8gRGVmZW5zaXZlIGFzc2VydGlvbiAtIGRldiBvbmx5XHJcbiAgICBpZiAoX2ltcG9ydF9tZXRhX2VudjIuREVWKSB7XHJcbiAgICAgIGlmIChyZXN1bHQuaW5jbHVkZXMoJ2NsaWVudF8vd3MnKSkge1xyXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgICAgY29uc29sZS5lcnJvcignW1dTQnVpbGREaWFnXVtMZWdhY3lEZXRlY3RlZF0nLCB7IFxyXG4gICAgICAgICAgdXJsOiByZXN1bHQsIFxyXG4gICAgICAgICAgc3RhY2s6IG5ldyBFcnJvcigpLnN0YWNrIFxyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTGVnYWN5IHdlYnNvY2tldCBwYXRoIGNvbnN0cnVjdGVkIGFmdGVyIG1pZ3JhdGlvbicpO1xyXG4gICAgICB9XHJcbiAgICAgIFxyXG4gICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxyXG4gICAgICBjb25zb2xlLmxvZygnW1dTQnVpbGREaWFnXSBCdWlsdCBjYW5vbmljYWwgV2ViU29ja2V0IFVSTDonLCByZXN1bHQpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAvLyBGYWxsYmFjayB3aXRoIGRlZmVuc2l2ZSBhc3NlcnRpb25cclxuICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoKTtcclxuICAgIHBhcmFtcy5zZXQoJ2NsaWVudF9pZCcsIGNsaWVudElkKTtcclxuICAgIHBhcmFtcy5zZXQoJ3ZlcnNpb24nLCBTdHJpbmcodmVyc2lvbikpO1xyXG4gICAgcGFyYW1zLnNldCgncm9sZScsIHJvbGUpO1xyXG4gICAgXHJcbiAgICBjb25zdCBmYWxsYmFja1VybCA9IGAke2Jhc2VVcmx9L3dzL2NsaWVudD8ke3BhcmFtcy50b1N0cmluZygpfWA7XHJcbiAgICBcclxuICAgIC8vIERlZmVuc2l2ZSBhc3NlcnRpb24gb24gZmFsbGJhY2sgdG9vXHJcbiAgICBpZiAoX2ltcG9ydF9tZXRhX2VudjIuREVWICYmIGZhbGxiYWNrVXJsLmluY2x1ZGVzKCdjbGllbnRfL3dzJykpIHtcclxuICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcclxuICAgICAgY29uc29sZS5lcnJvcignW1dTQnVpbGREaWFnXVtMZWdhY3lEZXRlY3RlZF0gRXZlbiBmYWxsYmFjayBjcmVhdGVkIGxlZ2FjeSBwYXRoIScsIHsgXHJcbiAgICAgICAgdXJsOiBmYWxsYmFja1VybCwgXHJcbiAgICAgICAgZXJyb3IsXHJcbiAgICAgICAgc3RhY2s6IG5ldyBFcnJvcigpLnN0YWNrIFxyXG4gICAgICB9KTtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdMZWdhY3kgd2Vic29ja2V0IHBhdGggY29uc3RydWN0ZWQgaW4gZmFsbGJhY2sgYWZ0ZXIgbWlncmF0aW9uJyk7XHJcbiAgICB9XHJcbiAgICBcclxuICBpZiAoX2ltcG9ydF9tZXRhX2VudjIuREVWKSB7XHJcbiAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXHJcbiAgICAgIGNvbnNvbGUud2FybignW1dTQnVpbGREaWFnXSBVUkwgY29uc3RydWN0b3IgZmFpbGVkLCB1c2luZyBmYWxsYmFjazonLCBmYWxsYmFja1VybCwgZXJyb3IpO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gZmFsbGJhY2tVcmw7XHJcbiAgfVxyXG59XHJcblxyXG4vLyBWYWxpZGF0ZSB0aGF0IGEgVVJMIGRvZXNuJ3QgY29udGFpbiBsZWdhY3kgcGF0dGVybnNcclxuZXhwb3J0IGZ1bmN0aW9uIHZhbGlkYXRlV2ViU29ja2V0VXJsKHVybDogc3RyaW5nKTogYm9vbGVhbiB7XHJcbiAgcmV0dXJuICF1cmwuaW5jbHVkZXMoJ2NsaWVudF8vd3MnKTtcclxufSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7O0FBU0E7QUFDTyxTQUFTQSxvQkFBb0JBLENBQUNDLFVBQVUsR0FBRyxjQUFjLEVBQUVDLGNBQXVCLEVBQVU7RUFDakcsSUFBSUMsUUFBUSxHQUFHRCxjQUFjOztFQUU3QjtF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