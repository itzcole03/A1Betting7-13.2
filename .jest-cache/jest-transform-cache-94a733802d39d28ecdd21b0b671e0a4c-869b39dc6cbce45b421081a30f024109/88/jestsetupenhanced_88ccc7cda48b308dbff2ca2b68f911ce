4dcc91b17c24eb32047580a2e95ec802
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
// Enhanced Jest Setup for Phase 4 Testing Automation
require("@testing-library/jest-dom");
require("jest-localstorage-mock");
// Enhanced DOM Testing Setup
Object.defineProperty(window, 'matchMedia', {
    writable: true,
    value: jest.fn().mockImplementation(query => ({
        matches: false,
        media: query,
        onchange: null,
        addListener: jest.fn(), // deprecated
        removeListener: jest.fn(), // deprecated
        addEventListener: jest.fn(),
        removeEventListener: jest.fn(),
        dispatchEvent: jest.fn(),
    })),
});
// WebSocket Mock
global.WebSocket = jest.fn().mockImplementation(() => ({
    close: jest.fn(),
    send: jest.fn(),
    readyState: 1, // OPEN
    CONNECTING: 0,
    OPEN: 1,
    CLOSING: 2,
    CLOSED: 3,
    addEventListener: jest.fn(),
    removeEventListener: jest.fn(),
    dispatchEvent: jest.fn(),
}));
// ResizeObserver Mock
global.ResizeObserver = jest.fn().mockImplementation(() => ({
    observe: jest.fn(),
    unobserve: jest.fn(),
    disconnect: jest.fn(),
}));
// IntersectionObserver Mock
global.IntersectionObserver = jest.fn().mockImplementation(() => ({
    observe: jest.fn(),
    unobserve: jest.fn(),
    disconnect: jest.fn(),
    root: null,
    rootMargin: '',
    thresholds: [],
}));
// Fetch Mock Enhancement
global.fetch = jest.fn();
// Console Mock for Testing
const originalError = console.error;
const originalWarn = console.warn;
beforeAll(() => {
    console.error = (...args) => {
        if (typeof args[0] === 'string' &&
            (args[0].includes('Warning:') ||
                args[0].includes('React does not recognize') ||
                args[0].includes('validateDOMNesting'))) {
            return;
        }
        originalError.call(console, ...args);
    };
    console.warn = (...args) => {
        if (typeof args[0] === 'string' &&
            args[0].includes('componentWillReceiveProps')) {
            return;
        }
        originalWarn.call(console, ...args);
    };
});
afterAll(() => {
    console.error = originalError;
    console.warn = originalWarn;
});
// Performance Mock
Object.defineProperty(window, 'performance', {
    writable: true,
    value: {
        mark: jest.fn(),
        measure: jest.fn(),
        getEntriesByName: jest.fn(() => []),
        getEntriesByType: jest.fn(() => []),
        clearMarks: jest.fn(),
        clearMeasures: jest.fn(),
        now: jest.fn(() => Date.now()),
    },
});
// URL Mock
Object.defineProperty(window, 'URL', {
    writable: true,
    value: {
        createObjectURL: jest.fn(() => 'mocked-url'),
        revokeObjectURL: jest.fn(),
    },
});
// File and FileReader Mocks
global.File = jest.fn().mockImplementation((fileBits, filename, options) => ({
    name: filename,
    size: fileBits.length,
    type: options?.type || '',
    lastModified: Date.now(),
    arrayBuffer: jest.fn(() => Promise.resolve(new ArrayBuffer(0))),
    text: jest.fn(() => Promise.resolve('')),
    stream: jest.fn(),
    slice: jest.fn(),
}));
global.FileReader = jest.fn().mockImplementation(() => ({
    readAsText: jest.fn(),
    readAsDataURL: jest.fn(),
    readAsArrayBuffer: jest.fn(),
    abort: jest.fn(),
    result: null,
    error: null,
    onload: null,
    onerror: null,
    onabort: null,
    readyState: 0,
    EMPTY: 0,
    LOADING: 1,
    DONE: 2,
}));
// Enhanced Local Storage Mock
const localStorageMock = {
    getItem: jest.fn(),
    setItem: jest.fn(),
    removeItem: jest.fn(),
    clear: jest.fn(),
    key: jest.fn(),
    length: 0,
};
Object.defineProperty(window, 'localStorage', {
    value: localStorageMock,
});
Object.defineProperty(window, 'sessionStorage', {
    value: localStorageMock,
});
// Crypto Mock
Object.defineProperty(window, 'crypto', {
    value: {
        getRandomValues: jest.fn(() => new Uint32Array(1)),
        randomUUID: jest.fn(() => '123e4567-e89b-12d3-a456-426614174000'),
        subtle: {
            digest: jest.fn(() => Promise.resolve(new ArrayBuffer(0))),
            encrypt: jest.fn(() => Promise.resolve(new ArrayBuffer(0))),
            decrypt: jest.fn(() => Promise.resolve(new ArrayBuffer(0))),
        },
    },
});
// HTMLCanvasElement Mock
HTMLCanvasElement.prototype.getContext = jest.fn(() => ({
    fillRect: jest.fn(),
    clearRect: jest.fn(),
    getImageData: jest.fn(() => ({ data: new Uint8ClampedArray(4) })),
    putImageData: jest.fn(),
    createImageData: jest.fn(() => ({ data: new Uint8ClampedArray(4) })),
    setTransform: jest.fn(),
    drawImage: jest.fn(),
    save: jest.fn(),
    fillText: jest.fn(),
    restore: jest.fn(),
    beginPath: jest.fn(),
    moveTo: jest.fn(),
    lineTo: jest.fn(),
    closePath: jest.fn(),
    stroke: jest.fn(),
    translate: jest.fn(),
    scale: jest.fn(),
    rotate: jest.fn(),
    arc: jest.fn(),
    fill: jest.fn(),
    measureText: jest.fn(() => ({ width: 0 })),
    transform: jest.fn(),
    rect: jest.fn(),
    clip: jest.fn(),
}));
// Enhanced Error Handling
process.on('unhandledRejection', (reason, promise) => {
    console.log('Unhandled Rejection at:', promise, 'reason:', reason);
});
// Test Cleanup
afterEach(() => {
    jest.clearAllMocks();
    localStorage.clear();
    sessionStorage.clear();
});
// Global Test Utilities
global.testUtils = {
    waitFor: (callback, timeout = 5000) => {
        return new Promise((resolve, reject) => {
            const startTime = Date.now();
            const check = () => {
                try {
                    callback();
                    resolve(undefined);
                }
                catch (error) {
                    if (Date.now() - startTime < timeout) {
                        setTimeout(check, 100);
                    }
                    else {
                        reject(error);
                    }
                }
            };
            check();
        });
    },
    mockApiResponse: (data, status = 200) => ({
        ok: status >= 200 && status < 300,
        status,
        statusText: status === 200 ? 'OK' : 'Error',
        json: jest.fn(() => Promise.resolve(data)),
        text: jest.fn(() => Promise.resolve(JSON.stringify(data))),
        blob: jest.fn(() => Promise.resolve(new Blob())),
        headers: new Headers(),
    }),
    mockWebSocket: () => ({
        send: jest.fn(),
        close: jest.fn(),
        readyState: 1,
        addEventListener: jest.fn(),
        removeEventListener: jest.fn(),
    }),
    createMockEvent: (type, properties = {}) => ({
        type,
        preventDefault: jest.fn(),
        stopPropagation: jest.fn(),
        target: { value: '' },
        currentTarget: { value: '' },
        ...properties,
    }),
};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiQzpcXFVzZXJzXFxiY21hZFxcRG93bmxvYWRzXFxBMUJldHRpbmc3LTEzLjJcXGplc3Quc2V0dXAuZW5oYW5jZWQudHMiLCJtYXBwaW5ncyI6Ijs7QUFBQSxxREFBcUQ7QUFDckQscUNBQW1DO0FBQ25DLGtDQUFnQztBQUVoQyw2QkFBNkI7QUFDN0IsTUFBTSxDQUFDLGNBQWMsQ0FBQyxNQUFNLEVBQUUsWUFBWSxFQUFFO0lBQzFDLFFBQVEsRUFBRSxJQUFJO0lBQ2QsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsQ0FBQyxrQkFBa0IsQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDNUMsT0FBTyxFQUFFLEtBQUs7UUFDZCxLQUFLLEVBQUUsS0FBSztRQUNaLFFBQVEsRUFBRSxJQUFJO1FBQ2QsV0FBVyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUUsRUFBRSxhQUFhO1FBQ3JDLGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFLEVBQUUsYUFBYTtRQUN4QyxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO1FBQzNCLG1CQUFtQixFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7UUFDOUIsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7S0FDekIsQ0FBQyxDQUFDO0NBQ0osQ0FBQyxDQUFDO0FBRUgsaUJBQWlCO0FBQ2pCLE1BQU0sQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxDQUFDLGtCQUFrQixDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUM7SUFDckQsS0FBSyxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDaEIsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLEVBQUU7SUFDZixVQUFVLEVBQUUsQ0FBQyxFQUFFLE9BQU87SUFDdEIsVUFBVSxFQUFFLENBQUM7SUFDYixJQUFJLEVBQUUsQ0FBQztJQUNQLE9BQU8sRUFBRSxDQUFDO0lBQ1YsTUFBTSxFQUFFLENBQUM7SUFDVCxnQkFBZ0IsRUFBRSxJQUFJLENBQUMsRUFBRSxFQUFFO0lB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S0FBSyxFQUFFLEVBQUUsRUFBRTtRQUM1QixHQUFHLFVBQVU7S0FDZCxDQUFDO0NBQ0gsQ0FBQyIsIm5hbWVzIjpbXSwic291cmNlcyI6WyJDOlxcVXNlcnNcXGJjbWFkXFxEb3dubG9hZHNcXEExQmV0dGluZzctMTMuMlxcamVzdC5zZXR1cC5lbmhhbmNlZC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBFbmhhbmNlZCBKZXN0IFNldHVwIGZvciBQaGFzZSA0IFRlc3RpbmcgQXV0b21hdGlvblxyXG5pbXBvcnQgJ0B0ZXN0aW5nLWxpYnJhcnkvamVzdC1kb20nO1xyXG5pbXBvcnQgJ2plc3QtbG9jYWxzdG9yYWdlLW1vY2snO1xyXG5cclxuLy8gRW5oYW5jZWQgRE9NIFRlc3RpbmcgU2V0dXBcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ21hdGNoTWVkaWEnLCB7XHJcbiAgd3JpdGFibGU6IHRydWUsXHJcbiAgdmFsdWU6IGplc3QuZm4oKS5tb2NrSW1wbGVtZW50YXRpb24ocXVlcnkgPT4gKHtcclxuICAgIG1hdGNoZXM6IGZhbHNlLFxyXG4gICAgbWVkaWE6IHF1ZXJ5LFxyXG4gICAgb25jaGFuZ2U6IG51bGwsXHJcbiAgICBhZGRMaXN0ZW5lcjogamVzdC5mbigpLCAvLyBkZXByZWNhdGVkXHJcbiAgICByZW1vdmVMaXN0ZW5lcjogamVzdC5mbigpLCAvLyBkZXByZWNhdGVkXHJcbiAgICBhZGRFdmVudExpc3RlbmVyOiBqZXN0LmZuKCksXHJcbiAgICByZW1vdmVFdmVudExpc3RlbmVyOiBqZXN0LmZuKCksXHJcbiAgICBkaXNwYXRjaEV2ZW50OiBqZXN0LmZuKCksXHJcbiAgfSkpLFxyXG59KTtcclxuXHJcbi8vIFdlYlNvY2tldCBNb2NrXHJcbmdsb2JhbC5XZWJTb2NrZXQgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XHJcbiAgY2xvc2U6IGplc3QuZm4oKSxcclxuICBzZW5kOiBqZXN0LmZuKCksXHJcbiAgcmVhZHlTdGF0ZTogMSwgLy8gT1BFTlxyXG4gIENPTk5FQ1RJTkc6IDAsXHJcbiAgT1BFTjogMSxcclxuICBDTE9TSU5HOiAyLFxyXG4gIENMT1NFRDogMyxcclxuICBhZGRFdmVudExpc3RlbmVyOiBqZXN0LmZuKCksXHJcbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxyXG4gIGRpc3BhdGNoRXZlbnQ6IGplc3QuZm4oKSxcclxufSkpO1xyXG5cclxuLy8gUmVzaXplT2JzZXJ2ZXIgTW9ja1xyXG5nbG9iYWwuUmVzaXplT2JzZXJ2ZXIgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XHJcbiAgb2JzZXJ2ZTogamVzdC5mbigpLFxyXG4gIHVub2JzZXJ2ZTogamVzdC5mbigpLFxyXG4gIGRpc2Nvbm5lY3Q6IGplc3QuZm4oKSxcclxufSkpO1xyXG5cclxuLy8gSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgTW9ja1xyXG5nbG9iYWwuSW50ZXJzZWN0aW9uT2JzZXJ2ZXIgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKCgpID0+ICh7XHJcbiAgb2JzZXJ2ZTogamVzdC5mbigpLFxyXG4gIHVub2JzZXJ2ZTogamVzdC5mbigpLFxyXG4gIGRpc2Nvbm5lY3Q6IGplc3QuZm4oKSxcclxuICByb290OiBudWxsLFxyXG4gIHJvb3RNYXJnaW46ICcnLFxyXG4gIHRocmVzaG9sZHM6IFtdLFxyXG59KSk7XHJcblxyXG4vLyBGZXRjaCBNb2NrIEVuaGFuY2VtZW50XHJcbmdsb2JhbC5mZXRjaCA9IGplc3QuZm4oKTtcclxuXHJcbi8vIENvbnNvbGUgTW9jayBmb3IgVGVzdGluZ1xyXG5jb25zdCBvcmlnaW5hbEVycm9yID0gY29uc29sZS5lcnJvcjtcclxuY29uc3Qgb3JpZ2luYWxXYXJuID0gY29uc29sZS53YXJuO1xyXG5cclxuYmVmb3JlQWxsKCgpID0+IHtcclxuICBjb25zb2xlLmVycm9yID0gKC4uLmFyZ3MpID0+IHtcclxuICAgIGlmIChcclxuICAgICAgdHlwZW9mIGFyZ3NbMF0gPT09ICdzdHJpbmcnICYmXHJcbiAgICAgIChhcmdzWzBdLmluY2x1ZGVzKCdXYXJuaW5nOicpIHx8IFxyXG4gICAgICAgYXJnc1swXS5pbmNsdWRlcygnUmVhY3QgZG9lcyBub3QgcmVjb2duaXplJykgfHxcclxuICAgICAgIGFyZ3NbMF0uaW5jbHVkZXMoJ3ZhbGlkYXRlRE9NTmVzdGluZycpKVxyXG4gICAgKSB7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuICAgIG9yaWdpbmFsRXJyb3IuY2FsbChjb25zb2xlLCAuLi5hcmdzKTtcclxuICB9O1xyXG5cclxuICBjb25zb2xlLndhcm4gPSAoLi4uYXJncykgPT4ge1xyXG4gICAgaWYgKFxyXG4gICAgICB0eXBlb2YgYXJnc1swXSA9PT0gJ3N0cmluZycgJiZcclxuICAgICAgYXJnc1swXS5pbmNsdWRlcygnY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcycpXHJcbiAgICApIHtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG4gICAgb3JpZ2luYWxXYXJuLmNhbGwoY29uc29sZSwgLi4uYXJncyk7XHJcbiAgfTtcclxufSk7XHJcblxyXG5hZnRlckFsbCgoKSA9PiB7XHJcbiAgY29uc29sZS5lcnJvciA9IG9yaWdpbmFsRXJyb3I7XHJcbiAgY29uc29sZS53YXJuID0gb3JpZ2luYWxXYXJuO1xyXG59KTtcclxuXHJcbi8vIFBlcmZvcm1hbmNlIE1vY2tcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3BlcmZvcm1hbmNlJywge1xyXG4gIHdyaXRhYmxlOiB0cnVlLFxyXG4gIHZhbHVlOiB7XHJcbiAgICBtYXJrOiBqZXN0LmZuKCksXHJcbiAgICBtZWFzdXJlOiBqZXN0LmZuKCksXHJcbiAgICBnZXRFbnRyaWVzQnlOYW1lOiBqZXN0LmZuKCgpID0+IFtdKSxcclxuICAgIGdldEVudHJpZXNCeVR5cGU6IGplc3QuZm4oKCkgPT4gW10pLFxyXG4gICAgY2xlYXJNYXJrczogamVzdC5mbigpLFxyXG4gICAgY2xlYXJNZWFzdXJlczogamVzdC5mbigpLFxyXG4gICAgbm93OiBqZXN0LmZuKCgpID0+IERhdGUubm93KCkpLFxyXG4gIH0sXHJcbn0pO1xyXG5cclxuLy8gVVJMIE1vY2tcclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ1VSTCcsIHtcclxuICB3cml0YWJsZTogdHJ1ZSxcclxuICB2YWx1ZToge1xyXG4gICAgY3JlYXRlT2JqZWN0VVJMOiBqZXN0LmZuKCgpID0+ICdtb2NrZWQtdXJsJyksXHJcbiAgICByZXZva2VPYmplY3RVUkw6IGplc3QuZm4oKSxcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIEZpbGUgYW5kIEZpbGVSZWFkZXIgTW9ja3NcclxuZ2xvYmFsLkZpbGUgPSBqZXN0LmZuKCkubW9ja0ltcGxlbWVudGF0aW9uKChmaWxlQml0cywgZmlsZW5hbWUsIG9wdGlvbnMpID0+ICh7XHJcbiAgbmFtZTogZmlsZW5hbWUsXHJcbiAgc2l6ZTogZmlsZUJpdHMubGVuZ3RoLFxyXG4gIHR5cGU6IG9wdGlvbnM/LnR5cGUgfHwgJycsXHJcbiAgbGFzdE1vZGlmaWVkOiBEYXRlLm5vdygpLFxyXG4gIGFycmF5QnVmZmVyOiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZShuZXcgQXJyYXlCdWZmZXIoMCkpKSxcclxuICB0ZXh0OiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZSgnJykpLFxyXG4gIHN0cmVhbTogamVzdC5mbigpLFxyXG4gIHNsaWNlOiBqZXN0LmZuKCksXHJcbn0pKTtcclxuXHJcbmdsb2JhbC5GaWxlUmVhZGVyID0gamVzdC5mbigpLm1vY2tJbXBsZW1lbnRhdGlvbigoKSA9PiAoe1xyXG4gIHJlYWRBc1RleHQ6IGplc3QuZm4oKSxcclxuICByZWFkQXNEYXRhVVJMOiBqZXN0LmZuKCksXHJcbiAgcmVhZEFzQXJyYXlCdWZmZXI6IGplc3QuZm4oKSxcclxuICBhYm9ydDogamVzdC5mbigpLFxyXG4gIHJlc3VsdDogbnVsbCxcclxuICBlcnJvcjogbnVsbCxcclxuICBvbmxvYWQ6IG51bGwsXHJcbiAgb25lcnJvcjogbnVsbCxcclxuICBvbmFib3J0OiBudWxsLFxyXG4gIHJlYWR5U3RhdGU6IDAsXHJcbiAgRU1QVFk6IDAsXHJcbiAgTE9BRElORzogMSxcclxuICBET05FOiAyLFxyXG59KSk7XHJcblxyXG4vLyBFbmhhbmNlZCBMb2NhbCBTdG9yYWdlIE1vY2tcclxuY29uc3QgbG9jYWxTdG9yYWdlTW9jayA9IHtcclxuICBnZXRJdGVtOiBqZXN0LmZuKCksXHJcbiAgc2V0SXRlbTogamVzdC5mbigpLFxyXG4gIHJlbW92ZUl0ZW06IGplc3QuZm4oKSxcclxuICBjbGVhcjogamVzdC5mbigpLFxyXG4gIGtleTogamVzdC5mbigpLFxyXG4gIGxlbmd0aDogMCxcclxufTtcclxuXHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdsb2NhbFN0b3JhZ2UnLCB7XHJcbiAgdmFsdWU6IGxvY2FsU3RvcmFnZU1vY2ssXHJcbn0pO1xyXG5cclxuT2JqZWN0LmRlZmluZVByb3BlcnR5KHdpbmRvdywgJ3Nlc3Npb25TdG9yYWdlJywge1xyXG4gIHZhbHVlOiBsb2NhbFN0b3JhZ2VNb2NrLFxyXG59KTtcclxuXHJcbi8vIENyeXB0byBNb2NrXHJcbk9iamVjdC5kZWZpbmVQcm9wZXJ0eSh3aW5kb3csICdjcnlwdG8nLCB7XHJcbiAgdmFsdWU6IHtcclxuICAgIGdldFJhbmRvbVZhbHVlczogamVzdC5mbigoKSA9PiBuZXcgVWludDMyQXJyYXkoMSkpLFxyXG4gICAgcmFuZG9tVVVJRDogamVzdC5mbigoKSA9PiAnMTIzZTQ1NjctZTg5Yi0xMmQzLWE0NTYtNDI2NjE0MTc0MDAwJyksXHJcbiAgICBzdWJ0bGU6IHtcclxuICAgICAgZGlnZXN0OiBqZXN0LmZuKCgpID0+IFByb21pc2UucmVzb2x2ZShuZXcgQXJyYXlCdWZmZXIoMCkpKSxcclxuICAgICAgZW5jcnlwdDogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUobmV3IEFycmF5QnVmZmVyKDApKSksXHJcbiAgICAgIGRlY3J5cHQ6IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKG5ldyBBcnJheUJ1ZmZlcigwKSkpLFxyXG4gICAgfSxcclxuICB9LFxyXG59KTtcclxuXHJcbi8vIEhUTUxDYW52YXNFbGVtZW50IE1vY2tcclxuSFRNTENhbnZhc0VsZW1lbnQucHJvdG90eXBlLmdldENvbnRleHQgPSBqZXN0LmZuKCgpID0+ICh7XHJcbiAgZmlsbFJlY3Q6IGplc3QuZm4oKSxcclxuICBjbGVhclJlY3Q6IGplc3QuZm4oKSxcclxuICBnZXRJbWFnZURhdGE6IGplc3QuZm4oKCkgPT4gKHsgZGF0YTogbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KDQpIH0pKSxcclxuICBwdXRJbWFnZURhdGE6IGplc3QuZm4oKSxcclxuICBjcmVhdGVJbWFnZURhdGE6IGplc3QuZm4oKCkgPT4gKHsgZGF0YTogbmV3IFVpbnQ4Q2xhbXBlZEFycmF5KDQpIH0pKSxcclxuICBzZXRUcmFuc2Zvcm06IGplc3QuZm4oKSxcclxuICBkcmF3SW1hZ2U6IGplc3QuZm4oKSxcclxuICBzYXZlOiBqZXN0LmZuKCksXHJcbiAgZmlsbFRleHQ6IGplc3QuZm4oKSxcclxuICByZXN0b3JlOiBqZXN0LmZuKCksXHJcbiAgYmVnaW5QYXRoOiBqZXN0LmZuKCksXHJcbiAgbW92ZVRvOiBqZXN0LmZuKCksXHJcbiAgbGluZVRvOiBqZXN0LmZuKCksXHJcbiAgY2xvc2VQYXRoOiBqZXN0LmZuKCksXHJcbiAgc3Ryb2tlOiBqZXN0LmZuKCksXHJcbiAgdHJhbnNsYXRlOiBqZXN0LmZuKCksXHJcbiAgc2NhbGU6IGplc3QuZm4oKSxcclxuICByb3RhdGU6IGplc3QuZm4oKSxcclxuICBhcmM6IGplc3QuZm4oKSxcclxuICBmaWxsOiBqZXN0LmZuKCksXHJcbiAgbWVhc3VyZVRleHQ6IGplc3QuZm4oKCkgPT4gKHsgd2lkdGg6IDAgfSkpLFxyXG4gIHRyYW5zZm9ybTogamVzdC5mbigpLFxyXG4gIHJlY3Q6IGplc3QuZm4oKSxcclxuICBjbGlwOiBqZXN0LmZuKCksXHJcbn0pKTtcclxuXHJcbi8vIEVuaGFuY2VkIEVycm9yIEhhbmRsaW5nXHJcbnByb2Nlc3Mub24oJ3VuaGFuZGxlZFJlamVjdGlvbicsIChyZWFzb24sIHByb21pc2UpID0+IHtcclxuICBjb25zb2xlLmxvZygnVW5oYW5kbGVkIFJlamVjdGlvbiBhdDonLCBwcm9taXNlLCAncmVhc29uOicsIHJlYXNvbik7XHJcbn0pO1xyXG5cclxuLy8gVGVzdCBDbGVhbnVwXHJcbmFmdGVyRWFjaCgoKSA9PiB7XHJcbiAgamVzdC5jbGVhckFsbE1vY2tzKCk7XHJcbiAgbG9jYWxTdG9yYWdlLmNsZWFyKCk7XHJcbiAgc2Vzc2lvblN0b3JhZ2UuY2xlYXIoKTtcclxufSk7XHJcblxyXG4vLyBHbG9iYWwgVGVzdCBVdGlsaXRpZXNcclxuZ2xvYmFsLnRlc3RVdGlscyA9IHtcclxuICB3YWl0Rm9yOiAoY2FsbGJhY2s6ICgpID0+IHZvaWQsIHRpbWVvdXQgPSA1MDAwKSA9PiB7XHJcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICBjb25zdCBzdGFydFRpbWUgPSBEYXRlLm5vdygpO1xyXG4gICAgICBjb25zdCBjaGVjayA9ICgpID0+IHtcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgIHJlc29sdmUodW5kZWZpbmVkKTtcclxuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydFRpbWUgPCB0aW1lb3V0KSB7XHJcbiAgICAgICAgICAgIHNldFRpbWVvdXQoY2hlY2ssIDEwMCk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZWplY3QoZXJyb3IpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgfTtcclxuICAgICAgY2hlY2soKTtcclxuICAgIH0pO1xyXG4gIH0sXHJcbiAgXHJcbiAgbW9ja0FwaVJlc3BvbnNlOiAoZGF0YTogYW55LCBzdGF0dXMgPSAyMDApID0+ICh7XHJcbiAgICBvazogc3RhdHVzID49IDIwMCAmJiBzdGF0dXMgPCAzMDAsXHJcbiAgICBzdGF0dXMsXHJcbiAgICBzdGF0dXNUZXh0OiBzdGF0dXMgPT09IDIwMCA/ICdPSycgOiAnRXJyb3InLFxyXG4gICAganNvbjogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoZGF0YSkpLFxyXG4gICAgdGV4dDogamVzdC5mbigoKSA9PiBQcm9taXNlLnJlc29sdmUoSlNPTi5zdHJpbmdpZnkoZGF0YSkpKSxcclxuICAgIGJsb2I6IGplc3QuZm4oKCkgPT4gUHJvbWlzZS5yZXNvbHZlKG5ldyBCbG9iKCkpKSxcclxuICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKCksXHJcbiAgfSksXHJcbiAgXHJcbiAgbW9ja1dlYlNvY2tldDogKCkgPT4gKHtcclxuICAgIHNlbmQ6IGplc3QuZm4oKSxcclxuICAgIGNsb3NlOiBqZXN0LmZuKCksXHJcbiAgICByZWFkeVN0YXRlOiAxLFxyXG4gICAgYWRkRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxyXG4gICAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjogamVzdC5mbigpLFxyXG4gIH0pLFxyXG4gIFxyXG4gIGNyZWF0ZU1vY2tFdmVudDogKHR5cGU6IHN0cmluZywgcHJvcGVydGllcyA9IHt9KSA9PiAoe1xyXG4gICAgdHlwZSxcclxuICAgIHByZXZlbnREZWZhdWx0OiBqZXN0LmZuKCksXHJcbiAgICBzdG9wUHJvcGFnYXRpb246IGplc3QuZm4oKSxcclxuICAgIHRhcmdldDogeyB2YWx1ZTogJycgfSxcclxuICAgIGN1cnJlbnRUYXJnZXQ6IHsgdmFsdWU6ICcnIH0sXHJcbiAgICAuLi5wcm9wZXJ0aWVzLFxyXG4gIH0pLFxyXG59O1xyXG5cclxuLy8gVHlwZSBBdWdtZW50YXRpb24gZm9yIEdsb2JhbCBUZXN0IFV0aWxzXHJcbmRlY2xhcmUgZ2xvYmFsIHtcclxuICB2YXIgdGVzdFV0aWxzOiB7XHJcbiAgICB3YWl0Rm9yOiAoY2FsbGJhY2s6ICgpID0+IHZvaWQsIHRpbWVvdXQ/OiBudW1iZXIpID0+IFByb21pc2U8dm9pZD47XHJcbiAgICBtb2NrQXBpUmVzcG9uc2U6IChkYXRhOiBhbnksIHN0YXR1cz86IG51bWJlcikgPT4gYW55O1xyXG4gICAgbW9ja1dlYlNvY2tldDogKCkgPT4gYW55O1xyXG4gICAgY3JlYXRlTW9ja0V2ZW50OiAodHlwZTogc3RyaW5nLCBwcm9wZXJ0aWVzPzogYW55KSA9PiBhbnk7XHJcbiAgfTtcclxufVxyXG5cclxuZXhwb3J0IHt9O1xyXG4iXSwidmVyc2lvbiI6M30=