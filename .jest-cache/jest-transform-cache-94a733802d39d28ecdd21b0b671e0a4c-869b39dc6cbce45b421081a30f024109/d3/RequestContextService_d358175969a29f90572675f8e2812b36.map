{"version":3,"names":["generateRequestId","crypto","randomUUID","replace","c","r","Math","random","v","toString","getRequestContext","version","requestId","headers","timeRequest","fn","start","performance","now","then","result","duration"],"sources":["RequestContextService.ts"],"sourcesContent":["// RequestContextService.ts - Unified request tracing and correlation\r\n\r\n// Simple UUID v4 generator (crypto-based if available)\r\nexport function generateRequestId(): string {\r\n  if (typeof crypto !== 'undefined' && crypto.randomUUID) {\r\n    return crypto.randomUUID();\r\n  }\r\n  // Fallback for environments without crypto.randomUUID\r\n  return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, c => {\r\n    const r = (Math.random() * 16) | 0;\r\n    const v = c === 'x' ? r : (r & 0x3) | 0x8;\r\n    return v.toString(16);\r\n  });\r\n}\r\n\r\n// Returns headers with correlation/request ID and optional version info\r\nexport function getRequestContext(version?: string): Record<string, string> {\r\n  const requestId = generateRequestId();\r\n  const headers: Record<string, string> = {\r\n    'X-Request-ID': requestId,\r\n  };\r\n  if (version) headers['X-Api-Version'] = version;\r\n  return headers;\r\n}\r\n\r\n// Optional: Request timing metrics\r\nexport function timeRequest<T>(fn: () => Promise<T>): Promise<{ result: T; duration: number }> {\r\n  const start = performance.now();\r\n  return fn().then(result => ({ result, duration: performance.now() - start }));\r\n}\r\n"],"mappings":";;;;;;;;AAAA;;AAEA;AACO,SAASA,iBAAiBA,CAAA,EAAW;EAC1C,IAAI,OAAOC,MAAM,KAAK,WAAW,IAAIA,MAAM,CAACC,UAAU,EAAE;IACtD,OAAOD,MAAM,CAACC,UAAU,CAAC,CAAC;EAC5B;EACA;EACA,OAAO,sCAAsC,CAACC,OAAO,CAAC,OAAO,EAAEC,CAAC,IAAI;IAClE,MAAMC,CAAC,GAAIC,IAAI,CAACC,MAAM,CAAC,CAAC,GAAG,EAAE,GAAI,CAAC;IAClC,MAAMC,CAAC,GAAGJ,CAAC,KAAK,GAAG,GAAGC,CAAC,GAAIA,CAAC,GAAG,GAAG,GAAI,GAAG;IACzC,OAAOG,CAAC,CAACC,QAAQ,CAAC,EAAE,CAAC;EACvB,CAAC,CAAC;AACJ;;AAEA;AACO,SAASC,iBAAiBA,CAACC,OAAgB,EAA0B;EAC1E,MAAMC,SAAS,GAAGZ,iBAAiB,CAAC,CAAC;EACrC,MAAMa,OAA+B,GAAG;IACtC,cAAc,EAAED;EAClB,CAAC;EACD,IAAID,OAAO,EAAEE,OAAO,CAAC,eAAe,CAAC,GAAGF,OAAO;EAC/C,OAAOE,OAAO;AAChB;;AAEA;AACO,SAASC,WAAWA,CAAIC,EAAoB,EAA4C;EAC7F,MAAMC,KAAK,GAAGC,WAAW,CAACC,GAAG,CAAC,CAAC;EAC/B,OAAOH,EAAE,CAAC,CAAC,CAACI,IAAI,CAACC,MAAM,KAAK;IAAEA,MAAM;IAAEC,QAAQ,EAAEJ,WAAW,CAACC,GAAG,CAAC,CAAC,GAAGF;EAAM,CAAC,CAAC,CAAC;AAC/E","ignoreList":[]}